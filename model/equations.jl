q1p = -(s3*u2-c3*u1)/c2
q2p = s3*u1 + c3*u2
q3p = u3 + tan(q2)*(s3*u2-c3*u1)
q4p = -(s6*u5-c6*u4)/c5
q5p = s6*u4 + c6*u5
q6p = u6 + tan(q5)*(s6*u5-c6*u4)

coef11 =  -ixa - izb*s5^2 - ixb*c5^2*c6^2 - iyb*s6^2*c5^2 - mb*lbo^2*(s5^2+s6^2*c5^2)
coef12 =  izb*s4*s5*c5 + iyb*s6*c5*(c4*c6-s4*s5*s6) + lbo*mb*(lbo*s4*s5*c5+la*s6*c4*c5^2+la*s5*(s4*c6+s5*s6*c4)+lbo*s6*c5*(c4*c6-s4*s5*s6)) - ixb*c5*c6*(s6*c4+s4*s5*c6)
coef13 =  iyb*s6*c5*(s4*c6+s5*s6*c4) - izb*s5*c4*c5 - ixb*c5*c6*(s4*s6-s5*c4*c6) - lbo*mb*(lbo*s5*c4*c5+la*s5*(c4*c6-s4*s5*s6)-la*s4*s6*c5^2-lbo*s6*c5*(s4*c6+s5*s6*c4))
coef14 =  (iyb+mb*lbo^2)*s6*c5
coef15 =  -(izb+mb*lbo^2)*s5
coef21 =  izb*s4*s5*c5 + iyb*s6*c5*(c4*c6-s4*s5*s6) + lbo*mb*(lbo*s4*s5*c5+la*s6*c4*c5^2+la*s5*(s4*c6+s5*s6*c4)+lbo*s6*c5*(c4*c6-s4*s5*s6)) - ixb*c5*c6*(s6*c4+s4*s5*c6)
coef22 =  -iya - ma*lao^2 - izb*s4^2*c5^2 - ixb*(s6*c4+s4*s5*c6)^2 - iyb*(c4*c6-s4*s5*s6)^2 - mb*(la^2+lbo^2*s4^2*c5^2+lbo^2*(c4*c6-s4*s5*s6)^2+2*la*lbo*s4*c5*(s4*c6+s5*s6*c4)+2*la*lbo*c4*c5*(c4*c6-s4*s5*s6))
coef23 =  izb*s4*c4*c5^2 + mb*lbo^2*(s4*c4*c5^2-(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)) - ixb*(s6*c4+s4*s5*c6)*(s4*s6-s5*c4*c6) - iyb*(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)
coef24 =  -iyb*(c4*c6-s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6-s4*s5*s6))
coef25 =  izb*s4*c5 + lbo*mb*(lbo*s4*c5+la*(s4*c6+s5*s6*c4))
coef31 =  iyb*s6*c5*(s4*c6+s5*s6*c4) - izb*s5*c4*c5 - ixb*c5*c6*(s4*s6-s5*c4*c6) - lbo*mb*(lbo*s5*c4*c5+la*s5*(c4*c6-s4*s5*s6)-la*s4*s6*c5^2-lbo*s6*c5*(s4*c6+s5*s6*c4))
coef32 =  izb*s4*c4*c5^2 + mb*lbo^2*(s4*c4*c5^2-(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)) - ixb*(s6*c4+s4*s5*c6)*(s4*s6-s5*c4*c6) - iyb*(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)
coef33 =  -iza - ma*lao^2 - izb*c4^2*c5^2 - iyb*(s4*c6+s5*s6*c4)^2 - ixb*(s4*s6-s5*c4*c6)^2 - mb*(la^2+lbo^2*c4^2*c5^2+lbo^2*(s4*c6+s5*s6*c4)^2+2*la*lbo*s4*c5*(s4*c6+s5*s6*c4)+2*la*lbo*c4*c5*(c4*c6-s4*s5*s6))
coef34 =  -iyb*(s4*c6+s5*s6*c4) - lbo*mb*(la*s4*c5+lbo*(s4*c6+s5*s6*c4))
coef35 =  -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6-s4*s5*s6))
coef41 =  (iyb+mb*lbo^2)*s6*c5
coef42 =  -iyb*(c4*c6-s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6-s4*s5*s6))
coef43 =  -iyb*(s4*c6+s5*s6*c4) - lbo*mb*(la*s4*c5+lbo*(s4*c6+s5*s6*c4))
coef44 =  -iyb - mb*lbo^2
coef45 =  0
coef51 =  -(izb+mb*lbo^2)*s5
coef52 =  izb*s4*c5 + lbo*mb*(lbo*s4*c5+la*(s4*c6+s5*s6*c4))
coef53 =  -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6-s4*s5*s6))
coef54 =  0
coef55 =  -izb - mb*lbo^2
rhs1 =  ba*u1 + iyb*s6*c5*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) + ixb*c5*c6*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + izb*s5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + lbo*mb*(pxpp*s6*c5*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+pxpp*s5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))+pzpp*s6*c5*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+pypp*s6*c5*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la*s6*c4*c5^2*u1*u3+la*s5*(s4*c6+s5*s6*c4)*u1*u3+la*s5*(c4*c6-s4*s5*s6)*u1*u2+lbo*s5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-pypp*s5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))-pzpp*s5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-la*s4*s6*c5^2*u1*u2-lbo*s6*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))) + ixb*c5*c6*u4p - ka*(eqx-q1) - g*lbo*mb*(s6*c5*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-s5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) - (iya-iza)*u2*u3 - s6*c5*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) - c5*c6*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - s5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3)
rhs2 =  g*lao*ma*c1*c2 + g*mb*(la*c1*c2+lbo*(c4*c6-s4*s5*s6)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-lbo*s4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) + ba*u2 + (ixa-iza)*u1*u3 + lao*ma*(pypp*s1*c2-pxpp*s2-pzpp*c1*c2-lao*u1*u3) + ixb*(s6*c4+s4*s5*c6)*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + (c4*c6-s4*s5*s6)*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) + s4*c5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3) + ixb*(s6*c4+s4*s5*c6)*u4p - ka*(eqy-q2) - iyb*(c4*c6-s4*s5*s6)*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - izb*s4*c5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) - (s6*c4+s4*s5*c6)*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - mb*(la*pxpp*s2+la*pzpp*c1*c2+lbo*pxpp*(c4*c6-s4*s5*s6)*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+lbo*pxpp*s4*c5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))+lbo*pzpp*(c4*c6-s4*s5*s6)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+lbo*pypp*(c4*c6-s4*s5*s6)*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la^2*u1*u3+la*lbo*s4*s6*c5^2*(u2^2+u3^2)+la*lbo*s4*c5*(s4*c6+s5*s6*c4)*u1*u3+la*lbo*c4*c5*(c4*c6-s4*s5*s6)*u1*u3+lbo^2*s4*c5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)+la*lbo*(s4*c6+s5*s6*c4)*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*pypp*s1*c2-lbo*pypp*s4*c5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))-lbo*pzpp*s4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-la*lbo*s5*(c4*c6-s4*s5*s6)*(u2^2+u3^2)-la*lbo*(s4*s6-s5*c4*c6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)^2+(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)^2)-la*lbo*c4*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(c4*c6-s4*s5*s6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
rhs3 =  ba*u3 + ixb*(s4*s6-s5*c4*c6)*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + izb*c4*c5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + (s4*c6+s5*s6*c4)*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) + ixb*(s4*s6-s5*c4*c6)*u4p - ka*(eqz-q3) - g*lao*ma*(s1*c3+s2*s3*c1) - g*mb*(la*(s1*c3+s2*s3*c1)-lbo*(s4*c6+s5*s6*c4)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-lbo*c4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) - (ixa-iya)*u1*u2 - lao*ma*(pxpp*s3*c2-pzpp*(s1*c3+s2*s3*c1)-pypp*(c1*c3-s1*s2*s3)-lao*u1*u2) - iyb*(s4*c6+s5*s6*c4)*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - (s4*s6-s5*c4*c6)*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - c4*c5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3) - mb*(la*pxpp*s3*c2+lbo*pxpp*(s4*c6+s5*s6*c4)*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+lbo*pzpp*(s4*c6+s5*s6*c4)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+lbo*pypp*(s4*c6+s5*s6*c4)*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+lbo*pypp*c4*c5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))+lbo*pzpp*c4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))+la*lbo*(s6*c4+s4*s5*c6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)^2+(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)^2)-la*pzpp*(s1*c3+s2*s3*c1)-la*pypp*(c1*c3-s1*s2*s3)-lbo*pxpp*c4*c5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))-la^2*u1*u2-la*lbo*s6*c4*c5^2*(u2^2+u3^2)-la*lbo*s4*c5*(s4*c6+s5*s6*c4)*u1*u2-la*lbo*s5*(s4*c6+s5*s6*c4)*(u2^2+u3^2)-la*lbo*c4*c5*(c4*c6-s4*s5*s6)*u1*u2-lbo^2*c4*c5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*lbo*(c4*c6-s4*s5*s6)*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*lbo*s4*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(s4*c6+s5*s6*c4)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
rhs4 =  kb*q5 + g*lbo*mb*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1)) + bb*u5 + ixb*u4*u6 + ixb*s5*u1*u4 + ixb*c4*c5*u3*u4 + ixb*c5*c6*u1*u6 + izb*s4*c5*u2*u4 + ixb*s5*c5*c6*u1^2 + ixb*c4*c6*c5^2*u1*u3 + izb*s4*c6*c5^2*u1*u2 + ixb*(s6*c4+s4*s5*c6)*u2*u6 + ixb*(s4*s6-s5*c4*c6)*u3*u6 + ixb*s5*(s6*c4+s4*s5*c6)*u1*u2 + ixb*s5*(s4*s6-s5*c4*c6)*u1*u3 + ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3 + izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2 + ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2 + izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3 - izb*u4*u6 - izb*s5*u1*u4 - ixb*s4*c5*u2*u4 - izb*c4*c5*u3*u4 - izb*c5*c6*u1*u6 - izb*s5*c5*c6*u1^2 - ixb*s4*c6*c5^2*u1*u2 - izb*c4*c6*c5^2*u1*u3 - izb*(s6*c4+s4*s5*c6)*u2*u6 - izb*(s4*s6-s5*c4*c6)*u3*u6 - izb*s5*(s6*c4+s4*s5*c6)*u1*u2 - izb*s5*(s4*s6-s5*c4*c6)*u1*u3 - ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2 - izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3 - ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3 - izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2 - iyb*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - lbo*mb*(pxpp*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+pzpp*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+pypp*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la*c4*c5*u1*u3-la*s4*c5*u1*u2-la*s5*(u2^2+u3^2)-lbo*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
rhs5 =  kb*q6 + g*lbo*mb*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6)) + bb*u6 + iyb*u4*u5 + ixb*s6*c5*u1*u4 + iyb*c5*c6*u1*u5 + ixb*s6*c6*c5^2*u1^2 + iyb*(s4*c6+s5*s6*c4)*u3*u4 + iyb*(s6*c4+s4*s5*c6)*u2*u5 + iyb*(s4*s6-s5*c4*c6)*u3*u5 + iyb*(c4*c6-s4*s5*s6)*u2*u4 + ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2 + iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3 + ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3 + iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2 + iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3 + iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2 + iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2 + iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3 + izb*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) - ixb*u4*u5 - ixb*c5*c6*u1*u5 - iyb*s6*c5*u1*u4 - iyb*s6*c6*c5^2*u1^2 - ixb*(s4*c6+s5*s6*c4)*u3*u4 - ixb*(s6*c4+s4*s5*c6)*u2*u5 - ixb*(s4*s6-s5*c4*c6)*u3*u5 - ixb*(c4*c6-s4*s5*s6)*u2*u4 - ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3 - iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2 - ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2 - iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3 - ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3 - ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2 - ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2 - ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3 - lbo*mb*(pypp*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))+pzpp*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-pxpp*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))-la*s6*c5*(u2^2+u3^2)-la*(s4*c6+s5*s6*c4)*u1*u3-la*(c4*c6-s4*s5*s6)*u1*u2-lbo*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p))

p2x = px + la*c2*c3
p2y = py + la*(s3*c1+s1*s2*c3)
p2z = pz + la*(s1*s3-s2*c1*c3)
p3x = px + la*c2*c3 + lb*(c2*c3*c5*c6+s2*(s4*s6-s5*c4*c6)-s3*c2*(s6*c4+s4*s5*c6))
p3y = py + la*(s3*c1+s1*s2*c3) - lb*(s1*c2*(s4*s6-s5*c4*c6)-c5*c6*(s3*c1+s1*s2*c3)-(s6*c4+s4*s5*c6)*(c1*c3-s1*s2*s3))
p3z = pz + la*(s1*s3-s2*c1*c3) + lb*(c1*c2*(s4*s6-s5*c4*c6)+c5*c6*(s1*s3-s2*c1*c3)+(s1*c3+s2*s3*c1)*(s6*c4+s4*s5*c6))

ke = 0.5*ixa*u1^2 + 0.5*iya*u2^2 + 0.5*iza*u3^2 + 0.5*izb*sin(q4)*cos(q5)*u2*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3) + 0.5*ixb*u4*(u4+cos(q5)*cos(q6)*u1+(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3) + 0.5*ixb*cos(q5)*cos(q6)*u1*(u4+cos(q5)*cos(q6)*u1+(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3) + 0.5*iyb*sin(q6)*cos(q5)*u1*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2) + 0.5*ixb*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2*(u4+cos(q5)*cos(q6)*u1+(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3) + 0.5*ixb*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3*(u4+cos(q5)*cos(q6)*u1+(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3) - 0.5*izb*u6*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3) - 0.5*izb*sin(q5)*u1*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3) - 0.5*izb*cos(q4)*cos(q5)*u3*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3) - 0.5*iyb*u5*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2) - 0.5*iyb*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2) - 0.5*iyb*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2) - 0.5*ma*(2*lao*pxp*sin(q2)*u2+2*lao*pxp*sin(q3)*cos(q2)*u3+2*lao*pzp*cos(q1)*cos(q2)*u2-pxp^2-pyp^2-pzp^2-lao^2*u2^2-lao^2*u3^2-2*lao*pyp*sin(q1)*cos(q2)*u2-2*lao*pzp*(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*u3-2*lao*pyp*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3))*u3) - 0.5*mb*(2*la*pxp*sin(q2)*u2+2*la*pxp*sin(q3)*cos(q2)*u3+2*la*pzp*cos(q1)*cos(q2)*u2+2*la*lbo*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u3*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)+2*la*lbo*sin(q4)*cos(q5)*u3*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)+2*la*lbo*cos(q4)*cos(q5)*u2*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)+2*lbo*pxp*(sin(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))-sin(q6)*cos(q2)*cos(q3)*cos(q5)-sin(q3)*cos(q2)*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-pxp^2-pyp^2-pzp^2-la^2*u2^2-la^2*u3^2-2*la*pyp*sin(q1)*cos(q2)*u2-2*la*pzp*(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*u3-2*la*pyp*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3))*u3-lbo^2*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)^2-2*la*lbo*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u2*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-lbo^2*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)^2-2*lbo*pxp*(sin(q2)*cos(q4)*cos(q5)+sin(q5)*cos(q2)*cos(q3)+sin(q3)*sin(q4)*cos(q2)*cos(q5))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)-2*lbo*pyp*(sin(q1)*cos(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))+sin(q6)*cos(q5)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3))*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-2*lbo*pzp*(cos(q1)*cos(q2)*cos(q4)*cos(q5)+sin(q5)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-sin(q4)*cos(q5)*(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1)))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)-2*lbo*pyp*(sin(q5)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-sin(q1)*cos(q2)*cos(q4)*cos(q5)-sin(q4)*cos(q5)*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3)))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)-2*lbo*pzp*(sin(q6)*cos(q5)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-cos(q1)*cos(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))-(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3))
pe = -g*((ma+mb)*(lao+lbo+pz)+(la*mb+lao*ma)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))+lbo*mb*(cos(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))+cos(q5)*cos(q6)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))+(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))))

amomx = lao*ma*(pzp*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-pyp*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))) + mb*(la*pzp*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-la*pyp*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-lbo*pyp*(cos(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))+cos(q5)*cos(q6)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))+(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))-lbo*pzp*(sin(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-cos(q5)*cos(q6)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3)))) + sin(q2)*(iza+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u3 + cos(q2)*cos(q3)*(ixa*u1-la*lbo*mb*((sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3)) + (sin(q2)*cos(q4)*cos(q5)+sin(q5)*cos(q2)*cos(q3)+sin(q3)*sin(q4)*cos(q2)*cos(q5))*(izb*u6+izb*sin(q5)*u1+izb*cos(q4)*cos(q5)*u3-izb*sin(q4)*cos(q5)*u2-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)) + (sin(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))-sin(q6)*cos(q2)*cos(q3)*cos(q5)-sin(q3)*cos(q2)*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(iyb*u5+iyb*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3+iyb*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2-iyb*sin(q6)*cos(q5)*u1-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)) + (cos(q2)*cos(q3)*cos(q5)*cos(q6)+sin(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-sin(q3)*cos(q2)*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))*(ixb*u4+ixb*cos(q5)*cos(q6)*u1+ixb*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+ixb*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3+la*lbo*mb*(sin(q5)*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-sin(q6)*cos(q5)*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2))) - sin(q3)*cos(q2)*(iya+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u2
amomy = (cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3))*(iya+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u2 + (sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))*(ixa*u1-la*lbo*mb*((sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3)) + (sin(q5)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-sin(q1)*cos(q2)*cos(q4)*cos(q5)-sin(q4)*cos(q5)*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3)))*(izb*u6+izb*sin(q5)*u1+izb*cos(q4)*cos(q5)*u3-izb*sin(q4)*cos(q5)*u2-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)) - lao*ma*(pzp*cos(q2)*cos(q3)-pxp*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))) - mb*(la*pzp*cos(q2)*cos(q3)+lbo*pzp*(cos(q2)*cos(q3)*cos(q5)*cos(q6)+sin(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-sin(q3)*cos(q2)*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))-la*pxp*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-lbo*pxp*(cos(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))+cos(q5)*cos(q6)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))+(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))) - sin(q1)*cos(q2)*(iza+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u3 - (sin(q1)*cos(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))+sin(q6)*cos(q5)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3))*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(iyb*u5+iyb*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3+iyb*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2-iyb*sin(q6)*cos(q5)*u1-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)) - (sin(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-cos(q5)*cos(q6)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3)))*(ixb*u4+ixb*cos(q5)*cos(q6)*u1+ixb*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+ixb*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3+la*lbo*mb*(sin(q5)*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-sin(q6)*cos(q5)*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2)))
amomz = lao*ma*(pyp*cos(q2)*cos(q3)-pxp*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))) + cos(q1)*cos(q2)*(iza+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u3 + (sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(iya+ma*lao^2+la*mb*(la+lbo*cos(q5)*cos(q6)))*u2 + (sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))*(ixa*u1-la*lbo*mb*((sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3)) + (cos(q1)*cos(q2)*cos(q4)*cos(q5)+sin(q5)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-sin(q4)*cos(q5)*(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1)))*(izb*u6+izb*sin(q5)*u1+izb*cos(q4)*cos(q5)*u3-izb*sin(q4)*cos(q5)*u2-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)) + (cos(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))+cos(q5)*cos(q6)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))+(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))*(ixb*u4+ixb*cos(q5)*cos(q6)*u1+ixb*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*u2+ixb*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))*u3+la*lbo*mb*(sin(q5)*(sin(q4)*cos(q5)*u2-u6-sin(q5)*u1-cos(q4)*cos(q5)*u3)-sin(q6)*cos(q5)*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2))) - mb*(la*pxp*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-la*pyp*cos(q2)*cos(q3)-lbo*pyp*(cos(q2)*cos(q3)*cos(q5)*cos(q6)+sin(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-sin(q3)*cos(q2)*(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6)))-lbo*pxp*(sin(q1)*cos(q2)*(sin(q4)*sin(q6)-sin(q5)*cos(q4)*cos(q6))-cos(q5)*cos(q6)*(sin(q3)*cos(q1)+sin(q1)*sin(q2)*cos(q3))-(sin(q6)*cos(q4)+sin(q4)*sin(q5)*cos(q6))*(cos(q1)*cos(q3)-sin(q1)*sin(q2)*sin(q3)))) - (sin(q6)*cos(q5)*(sin(q1)*sin(q3)-sin(q2)*cos(q1)*cos(q3))-cos(q1)*cos(q2)*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))-(sin(q1)*cos(q3)+sin(q2)*sin(q3)*cos(q1))*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6)))*(iyb*u5+iyb*(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3+iyb*(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2-iyb*sin(q6)*cos(q5)*u1-lbo*mb*(lbo+la*cos(q5)*cos(q6))*(sin(q6)*cos(q5)*u1-u5-(sin(q4)*cos(q6)+sin(q5)*sin(q6)*cos(q4))*u3-(cos(q4)*cos(q6)-sin(q4)*sin(q5)*sin(q6))*u2))
