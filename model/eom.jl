# Initialise global arrays for eom! to update - doesn't work with @threads (shared memory)
# const coef = MMatrix{6,6,Float64}(undef)
# const rhs = MVector{6,Float64}(undef)

function eom!(du, u, p, t)
    @unpack la, lao, lbo, ixa, ixb, iya, iyb, iza, izb, g, fx, fy, fz, ka, kb, ba, bb, ma, mb, eqx, eqy, eqz = p
    @inbounds q1, q2, q3, q4, q5, q6, u1, u2, u3, u4, u5, u6 = u

    pxpp = derivative(fx, t, 2)
    pypp = derivative(fy, t, 2)
    pzpp = derivative(fz, t, 2)
    
    coef = MMatrix{6,6,Float64}(undef)
    rhs = MVector{6,Float64}(undef)

    s1 = sin(q1); s2 = sin(q2); s3 = sin(q3); s4 = sin(q4); s5 = sin(q5); s6 = sin(q6)
    c1 = cos(q1); c2 = cos(q2); c3 = cos(q3); c4 = cos(q4); c5 = cos(q5); c6 = cos(q6)

    q1p = -(s3 * u2 - c3 * u1) / c2
    q2p = s3 * u1 + c3 * u2
    q3p = u3 + tan(q2) * (s3 * u2 - c3 * u1)
    q4p = -(s6 * u5 - c6 * u4) / c5
    q5p = s6 * u4 + c6 * u5
    q6p = u6 + tan(q5) * (s6 * u5 - c6 * u4)
      
    coef[1,1] = -ixa - izb * s5^2 - ixb * c5^2 * c6^2 - iyb * s6^2 * c5^2 - mb * lbo^2 * (s5^2 + s6^2 * c5^2)
    coef[1,2] = izb * s4 * s5 * c5 + iyb * s6 * c5 * (c4 * c6 - s4 * s5 * s6) + lbo * mb * (lbo * s4 * s5 * c5 + la * s6 * c4 * c5^2 + la * s5 * (s4 * c6 + s5 * s6 * c4) + lbo * s6 * c5 * (c4 * c6 - s4 * s5 * s6)) - ixb * c5 * c6 * (s6 * c4 + s4 * s5 * c6)
    coef[1,3] = iyb * s6 * c5 * (s4 * c6 + s5 * s6 * c4) - izb * s5 * c4 * c5 - ixb * c5 * c6 * (s4 * s6 - s5 * c4 * c6) - lbo * mb * (lbo * s5 * c4 * c5 + la * s5 * (c4 * c6 - s4 * s5 * s6) - la * s4 * s6 * c5^2 - lbo * s6 * c5 * (s4 * c6 + s5 * s6 * c4))
    coef[1,4] = -ixb * c5 * c6
    coef[1,5] = (iyb + mb * lbo^2) * s6 * c5
    coef[1,6] = -(izb + mb * lbo^2) * s5
    coef[2,1] = izb * s4 * s5 * c5 + iyb * s6 * c5 * (c4 * c6 - s4 * s5 * s6) + lbo * mb * (lbo * s4 * s5 * c5 + la * s6 * c4 * c5^2 + la * s5 * (s4 * c6 + s5 * s6 * c4) + lbo * s6 * c5 * (c4 * c6 - s4 * s5 * s6)) - ixb * c5 * c6 * (s6 * c4 + s4 * s5 * c6)
    coef[2,2] = -iya - ma * lao^2 - izb * s4^2 * c5^2 - ixb * (s6 * c4 + s4 * s5 * c6)^2 - iyb * (c4 * c6 - s4 * s5 * s6)^2 - mb * (la^2 + lbo^2 * s4^2 * c5^2 + lbo^2 * (c4 * c6 - s4 * s5 * s6)^2 + 2 * la * lbo * s4 * c5 * (s4 * c6 + s5 * s6 * c4) + 2 * la * lbo * c4 * c5 * (c4 * c6 - s4 * s5 * s6))
    coef[2,3] = izb * s4 * c4 * c5^2 + mb * lbo^2 * (s4 * c4 * c5^2 - (s4 * c6 + s5 * s6 * c4) * (c4 * c6 - s4 * s5 * s6)) - ixb * (s6 * c4 + s4 * s5 * c6) * (s4 * s6 - s5 * c4 * c6) - iyb * (s4 * c6 + s5 * s6 * c4) * (c4 * c6 - s4 * s5 * s6)
    coef[2,4] = -ixb * (s6 * c4 + s4 * s5 * c6)
    coef[2,5] = -iyb * (c4 * c6 - s4 * s5 * s6) - lbo * mb * (la * c4 * c5 + lbo * (c4 * c6 - s4 * s5 * s6))
    coef[2,6] = izb * s4 * c5 + lbo * mb * (lbo * s4 * c5 + la * (s4 * c6 + s5 * s6 * c4))
    coef[3,1] = iyb * s6 * c5 * (s4 * c6 + s5 * s6 * c4) - izb * s5 * c4 * c5 - ixb * c5 * c6 * (s4 * s6 - s5 * c4 * c6) - lbo * mb * (lbo * s5 * c4 * c5 + la * s5 * (c4 * c6 - s4 * s5 * s6) - la * s4 * s6 * c5^2 - lbo * s6 * c5 * (s4 * c6 + s5 * s6 * c4))
    coef[3,2] = izb * s4 * c4 * c5^2 + mb * lbo^2 * (s4 * c4 * c5^2 - (s4 * c6 + s5 * s6 * c4) * (c4 * c6 - s4 * s5 * s6)) - ixb * (s6 * c4 + s4 * s5 * c6) * (s4 * s6 - s5 * c4 * c6) - iyb * (s4 * c6 + s5 * s6 * c4) * (c4 * c6 - s4 * s5 * s6)
    coef[3,3] = -iza - ma * lao^2 - izb * c4^2 * c5^2 - iyb * (s4 * c6 + s5 * s6 * c4)^2 - ixb * (s4 * s6 - s5 * c4 * c6)^2 - mb * (la^2 + lbo^2 * c4^2 * c5^2 + lbo^2 * (s4 * c6 + s5 * s6 * c4)^2 + 2 * la * lbo * s4 * c5 * (s4 * c6 + s5 * s6 * c4) + 2 * la * lbo * c4 * c5 * (c4 * c6 - s4 * s5 * s6))
    coef[3,4] = -ixb * (s4 * s6 - s5 * c4 * c6)
    coef[3,5] = -iyb * (s4 * c6 + s5 * s6 * c4) - lbo * mb * (la * s4 * c5 + lbo * (s4 * c6 + s5 * s6 * c4))
    coef[3,6] = -izb * c4 * c5 - lbo * mb * (lbo * c4 * c5 + la * (c4 * c6 - s4 * s5 * s6))
    coef[4,1] = -ixb * c5 * c6
    coef[4,2] = -ixb * (s6 * c4 + s4 * s5 * c6)
    coef[4,3] = -ixb * (s4 * s6 - s5 * c4 * c6)
    coef[4,4] = -ixb
    coef[4,5] = 0
    coef[4,6] = 0
    coef[5,1] = (iyb + mb * lbo^2) * s6 * c5
    coef[5,2] = -iyb * (c4 * c6 - s4 * s5 * s6) - lbo * mb * (la * c4 * c5 + lbo * (c4 * c6 - s4 * s5 * s6))
    coef[5,3] = -iyb * (s4 * c6 + s5 * s6 * c4) - lbo * mb * (la * s4 * c5 + lbo * (s4 * c6 + s5 * s6 * c4))
    coef[5,4] = 0
    coef[5,5] = -iyb - mb * lbo^2
    coef[5,6] = 0
    coef[6,1] = -(izb + mb * lbo^2) * s5
    coef[6,2] = izb * s4 * c5 + lbo * mb * (lbo * s4 * c5 + la * (s4 * c6 + s5 * s6 * c4))
    coef[6,3] = -izb * c4 * c5 - lbo * mb * (lbo * c4 * c5 + la * (c4 * c6 - s4 * s5 * s6))
    coef[6,4] = 0
    coef[6,5] = 0
    coef[6,6] = -izb - mb * lbo^2
    rhs[1] = ba * u1 + iyb * s6 * c5 * (u4 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) + u6 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3)) + ixb * c5 * c6 * (u5 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) - u6 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) + izb * s5 * (u5 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + u4 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) + lbo * mb * (pxpp * s6 * c5 * (s2 * c4 * c5 + s5 * c2 * c3 + s3 * s4 * c2 * c5) + pxpp * s5 * (s2 * (s4 * c6 + s5 * s6 * c4) - s6 * c2 * c3 * c5 - s3 * c2 * (c4 * c6 - s4 * s5 * s6)) + pzpp * s6 * c5 * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) + pypp * s6 * c5 * (s5 * (s3 * c1 + s1 * s2 * c3) - s1 * c2 * c4 * c5 - s4 * c5 * (c1 * c3 - s1 * s2 * s3)) + la * s6 * c4 * c5^2 * u1 * u3 + la * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + la * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + lbo * s5 * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p) - pypp * s5 * (s1 * c2 * (s4 * c6 + s5 * s6 * c4) + s6 * c5 * (s3 * c1 + s1 * s2 * c3) - (c1 * c3 - s1 * s2 * s3) * (c4 * c6 - s4 * s5 * s6)) - pzpp * s5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6)) - la * s4 * s6 * c5^2 * u1 * u2 - lbo * s6 * c5 * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p))) - ka * (eqX - q1) - g * lbo * mb * (s6 * c5 * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) - s5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6))) - (iya - iza) * u2 * u3 - s6 * c5 * (ixb * u4 * u6 + ixb * s5 * u1 * u4 + ixb * c4 * c5 * u3 * u4 + ixb * c5 * c6 * u1 * u6 + izb * s4 * c5 * u2 * u4 + ixb * s5 * c5 * c6 * u1^2 + ixb * c4 * c6 * c5^2 * u1 * u3 + izb * s4 * c6 * c5^2 * u1 * u2 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 + ixb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + izb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 + ixb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2 + izb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * u4 * u6 - izb * s5 * u1 * u4 - ixb * s4 * c5 * u2 * u4 - izb * c4 * c5 * u3 * u4 - izb * c5 * c6 * u1 * u6 - izb * s5 * c5 * c6 * u1^2 - ixb * s4 * c6 * c5^2 * u1 * u2 - izb * c4 * c6 * c5^2 * u1 * u3 - izb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 - izb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 - izb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - izb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - ixb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 - izb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - ixb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2) - c5 * c6 * (iyb * u5 * u6 + iyb * s5 * u1 * u5 + iyb * c4 * c5 * u3 * u5 + izb * s4 * c5 * u2 * u5 + izb * s6 * c5 * u1 * u6 + izb * s5 * s6 * c5 * u1^2 + iyb * s4 * s6 * c5^2 * u1 * u2 + izb * s6 * c4 * c5^2 * u1 * u3 + iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 + iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 + iyb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 + izb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 + iyb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * u5 * u6 - izb * s5 * u1 * u5 - iyb * s4 * c5 * u2 * u5 - iyb * s6 * c5 * u1 * u6 - izb * c4 * c5 * u3 * u5 - iyb * s5 * s6 * c5 * u1^2 - iyb * s6 * c4 * c5^2 * u1 * u3 - izb * s4 * s6 * c5^2 * u1 * u2 - izb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 - izb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 - izb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - izb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 - izb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 - iyb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3) - s5 * (ixb * u4 * u5 + ixb * c5 * c6 * u1 * u5 + iyb * s6 * c5 * u1 * u4 + iyb * s6 * c6 * c5^2 * u1^2 + ixb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 + ixb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 + ixb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 + ixb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 + ixb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3 - iyb * u4 * u5 - ixb * s6 * c5 * u1 * u4 - iyb * c5 * c6 * u1 * u5 - ixb * s6 * c6 * c5^2 * u1^2 - iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 - iyb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 - iyb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 - iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 - ixb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - ixb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - iyb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - iyb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 - iyb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 - iyb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3)
    rhs[2] = g * lao * ma * c1 * c2 + g * mb * (la * c1 * c2 + lbo * (c4 * c6 - s4 * s5 * s6) * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) - lbo * s4 * c5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6))) + ba * u2 + (ixa - iza) * u1 * u3 + lao * ma * (pypp * s1 * c2 - pxpp * s2 - pzpp * c1 * c2 - lao * u1 * u3) + ixb * (s6 * c4 + s4 * s5 * c6) * (u5 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) - u6 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) + (c4 * c6 - s4 * s5 * s6) * (ixb * u4 * u6 + ixb * s5 * u1 * u4 + ixb * c4 * c5 * u3 * u4 + ixb * c5 * c6 * u1 * u6 + izb * s4 * c5 * u2 * u4 + ixb * s5 * c5 * c6 * u1^2 + ixb * c4 * c6 * c5^2 * u1 * u3 + izb * s4 * c6 * c5^2 * u1 * u2 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 + ixb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + izb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 + ixb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2 + izb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * u4 * u6 - izb * s5 * u1 * u4 - ixb * s4 * c5 * u2 * u4 - izb * c4 * c5 * u3 * u4 - izb * c5 * c6 * u1 * u6 - izb * s5 * c5 * c6 * u1^2 - ixb * s4 * c6 * c5^2 * u1 * u2 - izb * c4 * c6 * c5^2 * u1 * u3 - izb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 - izb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 - izb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - izb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - ixb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 - izb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - ixb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2) + s4 * c5 * (ixb * u4 * u5 + ixb * c5 * c6 * u1 * u5 + iyb * s6 * c5 * u1 * u4 + iyb * s6 * c6 * c5^2 * u1^2 + ixb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 + ixb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 + ixb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 + ixb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 + ixb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3 - iyb * u4 * u5 - ixb * s6 * c5 * u1 * u4 - iyb * c5 * c6 * u1 * u5 - ixb * s6 * c6 * c5^2 * u1^2 - iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 - iyb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 - iyb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 - iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 - ixb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - ixb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - iyb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - iyb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 - iyb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 - iyb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3) - ka * (eqY - q2) - iyb * (c4 * c6 - s4 * s5 * s6) * (u4 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) + u6 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3)) - izb * s4 * c5 * (u5 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + u4 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) - (s6 * c4 + s4 * s5 * c6) * (iyb * u5 * u6 + iyb * s5 * u1 * u5 + iyb * c4 * c5 * u3 * u5 + izb * s4 * c5 * u2 * u5 + izb * s6 * c5 * u1 * u6 + izb * s5 * s6 * c5 * u1^2 + iyb * s4 * s6 * c5^2 * u1 * u2 + izb * s6 * c4 * c5^2 * u1 * u3 + iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 + iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 + iyb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 + izb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 + iyb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * u5 * u6 - izb * s5 * u1 * u5 - iyb * s4 * c5 * u2 * u5 - iyb * s6 * c5 * u1 * u6 - izb * c4 * c5 * u3 * u5 - iyb * s5 * s6 * c5 * u1^2 - iyb * s6 * c4 * c5^2 * u1 * u3 - izb * s4 * s6 * c5^2 * u1 * u2 - izb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 - izb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 - izb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - izb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 - izb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 - iyb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3) - mb * (la * pxpp * s2 + la * pzpp * c1 * c2 + lbo * pxpp * (c4 * c6 - s4 * s5 * s6) * (s2 * c4 * c5 + s5 * c2 * c3 + s3 * s4 * c2 * c5) + lbo * pxpp * s4 * c5 * (s2 * (s4 * c6 + s5 * s6 * c4) - s6 * c2 * c3 * c5 - s3 * c2 * (c4 * c6 - s4 * s5 * s6)) + lbo * pzpp * (c4 * c6 - s4 * s5 * s6) * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) + lbo * pypp * (c4 * c6 - s4 * s5 * s6) * (s5 * (s3 * c1 + s1 * s2 * c3) - s1 * c2 * c4 * c5 - s4 * c5 * (c1 * c3 - s1 * s2 * s3)) + la^2 * u1 * u3 + la * lbo * s4 * s6 * c5^2 * (u2^2 + u3^2) + la * lbo * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + la * lbo * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u1 * u3 + lbo^2 * s4 * c5 * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p) + la * lbo * (s4 * c6 + s5 * s6 * c4) * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p) - la * pypp * s1 * c2 - lbo * pypp * s4 * c5 * (s1 * c2 * (s4 * c6 + s5 * s6 * c4) + s6 * c5 * (s3 * c1 + s1 * s2 * c3) - (c1 * c3 - s1 * s2 * s3) * (c4 * c6 - s4 * s5 * s6)) - lbo * pzpp * s4 * c5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6)) - la * lbo * s5 * (c4 * c6 - s4 * s5 * s6) * (u2^2 + u3^2) - la * lbo * (s4 * s6 - s5 * c4 * c6) * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3)^2 + (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)^2) - la * lbo * c4 * c5 * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - lbo^2 * (c4 * c6 - s4 * s5 * s6) * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)))
    rhs[3] = ba * u3 + ixb * (s4 * s6 - s5 * c4 * c6) * (u5 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) - u6 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) + izb * c4 * c5 * (u5 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + u4 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) + (s4 * c6 + s5 * s6 * c4) * (ixb * u4 * u6 + ixb * s5 * u1 * u4 + ixb * c4 * c5 * u3 * u4 + ixb * c5 * c6 * u1 * u6 + izb * s4 * c5 * u2 * u4 + ixb * s5 * c5 * c6 * u1^2 + ixb * c4 * c6 * c5^2 * u1 * u3 + izb * s4 * c6 * c5^2 * u1 * u2 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 + ixb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + izb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 + ixb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2 + izb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * u4 * u6 - izb * s5 * u1 * u4 - ixb * s4 * c5 * u2 * u4 - izb * c4 * c5 * u3 * u4 - izb * c5 * c6 * u1 * u6 - izb * s5 * c5 * c6 * u1^2 - ixb * s4 * c6 * c5^2 * u1 * u2 - izb * c4 * c6 * c5^2 * u1 * u3 - izb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 - izb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 - izb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - izb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - ixb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 - izb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - ixb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2) - ka * (eqZ - q3) - g * lao * ma * (s1 * c3 + s2 * s3 * c1) - g * mb * (la * (s1 * c3 + s2 * s3 * c1) - lbo * (s4 * c6 + s5 * s6 * c4) * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) - lbo * c4 * c5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6))) - (ixa - iya) * u1 * u2 - lao * ma * (pxpp * s3 * c2 - pzpp * (s1 * c3 + s2 * s3 * c1) - pypp * (c1 * c3 - s1 * s2 * s3) - lao * u1 * u2) - iyb * (s4 * c6 + s5 * s6 * c4) * (u4 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) + u6 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3)) - (s4 * s6 - s5 * c4 * c6) * (iyb * u5 * u6 + iyb * s5 * u1 * u5 + iyb * c4 * c5 * u3 * u5 + izb * s4 * c5 * u2 * u5 + izb * s6 * c5 * u1 * u6 + izb * s5 * s6 * c5 * u1^2 + iyb * s4 * s6 * c5^2 * u1 * u2 + izb * s6 * c4 * c5^2 * u1 * u3 + iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 + iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 + iyb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 + izb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 + iyb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * u5 * u6 - izb * s5 * u1 * u5 - iyb * s4 * c5 * u2 * u5 - iyb * s6 * c5 * u1 * u6 - izb * c4 * c5 * u3 * u5 - iyb * s5 * s6 * c5 * u1^2 - iyb * s6 * c4 * c5^2 * u1 * u3 - izb * s4 * s6 * c5^2 * u1 * u2 - izb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 - izb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 - izb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - izb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 - izb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 - iyb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 - izb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3) - c4 * c5 * (ixb * u4 * u5 + ixb * c5 * c6 * u1 * u5 + iyb * s6 * c5 * u1 * u4 + iyb * s6 * c6 * c5^2 * u1^2 + ixb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 + ixb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 + ixb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + iyb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + ixb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 + ixb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 + ixb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3 - iyb * u4 * u5 - ixb * s6 * c5 * u1 * u4 - iyb * c5 * c6 * u1 * u5 - ixb * s6 * c6 * c5^2 * u1^2 - iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 - iyb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 - iyb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 - iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 - ixb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - ixb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - iyb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - iyb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 - iyb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 - iyb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3) - mb * (la * pxpp * s3 * c2 + lbo * pxpp * (s4 * c6 + s5 * s6 * c4) * (s2 * c4 * c5 + s5 * c2 * c3 + s3 * s4 * c2 * c5) + lbo * pzpp * (s4 * c6 + s5 * s6 * c4) * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) + lbo * pypp * (s4 * c6 + s5 * s6 * c4) * (s5 * (s3 * c1 + s1 * s2 * c3) - s1 * c2 * c4 * c5 - s4 * c5 * (c1 * c3 - s1 * s2 * s3)) + lbo * pypp * c4 * c5 * (s1 * c2 * (s4 * c6 + s5 * s6 * c4) + s6 * c5 * (s3 * c1 + s1 * s2 * c3) - (c1 * c3 - s1 * s2 * s3) * (c4 * c6 - s4 * s5 * s6)) + lbo * pzpp * c4 * c5 * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6)) + la * lbo * (s6 * c4 + s4 * s5 * c6) * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3)^2 + (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)^2) - la * pzpp * (s1 * c3 + s2 * s3 * c1) - la * pypp * (c1 * c3 - s1 * s2 * s3) - lbo * pxpp * c4 * c5 * (s2 * (s4 * c6 + s5 * s6 * c4) - s6 * c2 * c3 * c5 - s3 * c2 * (c4 * c6 - s4 * s5 * s6)) - la^2 * u1 * u2 - la * lbo * s6 * c4 * c5^2 * (u2^2 + u3^2) - la * lbo * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u1 * u2 - la * lbo * s5 * (s4 * c6 + s5 * s6 * c4) * (u2^2 + u3^2) - la * lbo * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - lbo^2 * c4 * c5 * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p) - la * lbo * (c4 * c6 - s4 * s5 * s6) * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p) - la * lbo * s4 * c5 * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - lbo^2 * (s4 * c6 + s5 * s6 * c4) * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)))
    rhs[4] = kb * q4 + bb * u4 + izb * u5 * u6 + izb * s5 * u1 * u5 + iyb * s4 * c5 * u2 * u5 + iyb * s6 * c5 * u1 * u6 + izb * c4 * c5 * u3 * u5 + iyb * s5 * s6 * c5 * u1^2 + iyb * s6 * c4 * c5^2 * u1 * u3 + izb * s4 * s6 * c5^2 * u1 * u2 + izb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 + izb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 + izb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + izb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 + izb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 + iyb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2 + izb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3 + ixb * (u5 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) - u6 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) - iyb * u5 * u6 - iyb * s5 * u1 * u5 - iyb * c4 * c5 * u3 * u5 - izb * s4 * c5 * u2 * u5 - izb * s6 * c5 * u1 * u6 - izb * s5 * s6 * c5 * u1^2 - iyb * s4 * s6 * c5^2 * u1 * u2 - izb * s6 * c4 * c5^2 * u1 * u3 - iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u6 - iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u6 - iyb * s5 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - iyb * s5 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * c4 * c5 * (s4 * c6 + s5 * s6 * c4) * u3^2 - izb * s4 * c5 * (s4 * c6 + s5 * s6 * c4) * u2 * u3 - iyb * c4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2 * u3 - izb * s4 * c5 * (c4 * c6 - s4 * s5 * s6) * u2^2
    rhs[5] = kb * q5 + g * lbo * mb * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) + bb * u5 + ixb * u4 * u6 + ixb * s5 * u1 * u4 + ixb * c4 * c5 * u3 * u4 + ixb * c5 * c6 * u1 * u6 + izb * s4 * c5 * u2 * u4 + ixb * s5 * c5 * c6 * u1^2 + ixb * c4 * c6 * c5^2 * u1 * u3 + izb * s4 * c6 * c5^2 * u1 * u2 + ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 + ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 + ixb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + ixb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + ixb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + izb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 + ixb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2 + izb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * u4 * u6 - izb * s5 * u1 * u4 - ixb * s4 * c5 * u2 * u4 - izb * c4 * c5 * u3 * u4 - izb * c5 * c6 * u1 * u6 - izb * s5 * c5 * c6 * u1^2 - ixb * s4 * c6 * c5^2 * u1 * u2 - izb * c4 * c6 * c5^2 * u1 * u3 - izb * (s6 * c4 + s4 * s5 * c6) * u2 * u6 - izb * (s4 * s6 - s5 * c4 * c6) * u3 * u6 - izb * s5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - izb * s5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - ixb * s4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2^2 - izb * c4 * c5 * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - ixb * s4 * c5 * (s4 * s6 - s5 * c4 * c6) * u2 * u3 - izb * c4 * c5 * (s4 * s6 - s5 * c4 * c6) * u3^2 - iyb * (u4 * (s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) + u6 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3)) - lbo * mb * (pxpp * (s2 * c4 * c5 + s5 * c2 * c3 + s3 * s4 * c2 * c5) + pzpp * (c1 * c2 * c4 * c5 + s5 * (s1 * s3 - s2 * c1 * c3) - s4 * c5 * (s1 * c3 + s2 * s3 * c1)) + pypp * (s5 * (s3 * c1 + s1 * s2 * c3) - s1 * c2 * c4 * c5 - s4 * c5 * (c1 * c3 - s1 * s2 * s3)) + la * c4 * c5 * u1 * u3 - la * s4 * c5 * u1 * u2 - la * s5 * (u2^2 + u3^2) - lbo * ((s4 * c5 * u2 - u6 - s5 * u1 - c4 * c5 * u3) * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + s5 * s6 * u1 * q5p - c5 * c6 * u1 * q6p - u2 * (s4 * c6 * q4p + s6 * c4 * q6p + s4 * s5 * c6 * q6p + s4 * s6 * c5 * q5p + s5 * s6 * c4 * q4p) - u3 * (s4 * s6 * q6p + s4 * s5 * s6 * q4p - c4 * c6 * q4p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)))
    rhs[6] = kb * q6 + g * lbo * mb * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6)) + bb * u6 + iyb * u4 * u5 + ixb * s6 * c5 * u1 * u4 + iyb * c5 * c6 * u1 * u5 + ixb * s6 * c6 * c5^2 * u1^2 + iyb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 + iyb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 + iyb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 + iyb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 + ixb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 + iyb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 + ixb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 + iyb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 + iyb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 + iyb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 + iyb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 + iyb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3 + izb * (u5 * (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) + u4 * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2)) - ixb * u4 * u5 - ixb * c5 * c6 * u1 * u5 - iyb * s6 * c5 * u1 * u4 - iyb * s6 * c6 * c5^2 * u1^2 - ixb * (s4 * c6 + s5 * s6 * c4) * u3 * u4 - ixb * (s6 * c4 + s4 * s5 * c6) * u2 * u5 - ixb * (s4 * s6 - s5 * c4 * c6) * u3 * u5 - ixb * (c4 * c6 - s4 * s5 * s6) * u2 * u4 - ixb * c5 * c6 * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - iyb * s6 * c5 * (s6 * c4 + s4 * s5 * c6) * u1 * u2 - ixb * c5 * c6 * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - iyb * s6 * c5 * (s4 * s6 - s5 * c4 * c6) * u1 * u3 - ixb * (s4 * c6 + s5 * s6 * c4) * (s6 * c4 + s4 * s5 * c6) * u2 * u3 - ixb * (s4 * c6 + s5 * s6 * c4) * (s4 * s6 - s5 * c4 * c6) * u3^2 - ixb * (s6 * c4 + s4 * s5 * c6) * (c4 * c6 - s4 * s5 * s6) * u2^2 - ixb * (s4 * s6 - s5 * c4 * c6) * (c4 * c6 - s4 * s5 * s6) * u2 * u3 - lbo * mb * (pypp * (s1 * c2 * (s4 * c6 + s5 * s6 * c4) + s6 * c5 * (s3 * c1 + s1 * s2 * c3) - (c1 * c3 - s1 * s2 * s3) * (c4 * c6 - s4 * s5 * s6)) + pzpp * (s6 * c5 * (s1 * s3 - s2 * c1 * c3) - c1 * c2 * (s4 * c6 + s5 * s6 * c4) - (s1 * c3 + s2 * s3 * c1) * (c4 * c6 - s4 * s5 * s6)) - pxpp * (s2 * (s4 * c6 + s5 * s6 * c4) - s6 * c2 * c3 * c5 - s3 * c2 * (c4 * c6 - s4 * s5 * s6)) - la * s6 * c5 * (u2^2 + u3^2) - la * (s4 * c6 + s5 * s6 * c4) * u1 * u3 - la * (c4 * c6 - s4 * s5 * s6) * u1 * u2 - lbo * (c5 * u1 * q5p + s4 * s5 * u2 * q5p - (u4 + c5 * c6 * u1 + (s6 * c4 + s4 * s5 * c6) * u2 + (s4 * s6 - s5 * c4 * c6) * u3) * (s6 * c5 * u1 - u5 - (s4 * c6 + s5 * s6 * c4) * u3 - (c4 * c6 - s4 * s5 * s6) * u2) - s4 * c5 * u3 * q4p - s5 * c4 * u3 * q5p - c4 * c5 * u2 * q4p))
    
    u1p, u2p, u3p, u4p, u5p, u6p = coef \ rhs

    du[1] = q1p
    du[2] = q2p
    du[3] = q3p
    du[4] = q4p
    du[5] = q5p
    du[6] = q6p
    du[7] = u1p
    du[8] = u2p
    du[9] = u3p
    du[10] = u4p
    du[11] = u5p
    du[12] = u6p

    return nothing
end

function eom_SA(u, p, t)
    @unpack la, lao, lbo, ixa, ixb, iya, iyb, iza, izb, g, fx, fy, fz, ka, kb, ba, bb, ma, mb, eqx, eqy, eqz = p
    @inbounds q1, q2, q3, q4, q5, q6, u1, u2, u3, u4, u5, u6 = u

    u4p = 0.0

    pxpp = derivative(fx, t, 2)
    pypp = derivative(fy, t, 2)
    pzpp = derivative(fz, t, 2)
    
    s1 = sin(q1); s2 = sin(q2); s3 = sin(q3); s4 = sin(q4); s5 = sin(q5); s6 = sin(q6)
    c1 = cos(q1); c2 = cos(q2); c3 = cos(q3); c4 = cos(q4); c5 = cos(q5); c6 = cos(q6)

    q1p = -(s3*u2-c3*u1)/c2
    q2p = s3*u1 + c3*u2
    q3p = u3 + tan(q2)*(s3*u2-c3*u1)
    q4p = -(s6*u5-c6*u4)/c5
    q5p = s6*u4 + c6*u5
    q6p = u6 + tan(q5)*(s6*u5-c6*u4)
            
        
    coef11 =  -ixa - izb*s5^2 - ixb*c5^2*c6^2 - iyb*s6^2*c5^2 - mb*lbo^2*(s5^2+s6^2*c5^2)
    coef12 =  izb*s4*s5*c5 + iyb*s6*c5*(c4*c6-s4*s5*s6) + lbo*mb*(lbo*s4*s5*c5+la*s6*c4*c5^2+la*s5*(s4*c6+s5*s6*c4)+lbo*s6*c5*(c4*c6-s4*s5*s6)) - ixb*c5*c6*(s6*c4+s4*s5*c6)
    coef13 =  iyb*s6*c5*(s4*c6+s5*s6*c4) - izb*s5*c4*c5 - ixb*c5*c6*(s4*s6-s5*c4*c6) - lbo*mb*(lbo*s5*c4*c5+la*s5*(c4*c6-s4*s5*s6)-la*s4*s6*c5^2-lbo*s6*c5*(s4*c6+s5*s6*c4))
    coef14 =  (iyb+mb*lbo^2)*s6*c5
    coef15 =  -(izb+mb*lbo^2)*s5
    coef21 =  izb*s4*s5*c5 + iyb*s6*c5*(c4*c6-s4*s5*s6) + lbo*mb*(lbo*s4*s5*c5+la*s6*c4*c5^2+la*s5*(s4*c6+s5*s6*c4)+lbo*s6*c5*(c4*c6-s4*s5*s6)) - ixb*c5*c6*(s6*c4+s4*s5*c6)
    coef22 =  -iya - ma*lao^2 - izb*s4^2*c5^2 - ixb*(s6*c4+s4*s5*c6)^2 - iyb*(c4*c6-s4*s5*s6)^2 - mb*(la^2+lbo^2*s4^2*c5^2+lbo^2*(c4*c6-s4*s5*s6)^2+2*la*lbo*s4*c5*(s4*c6+s5*s6*c4)+2*la*lbo*c4*c5*(c4*c6-s4*s5*s6))
    coef23 =  izb*s4*c4*c5^2 + mb*lbo^2*(s4*c4*c5^2-(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)) - ixb*(s6*c4+s4*s5*c6)*(s4*s6-s5*c4*c6) - iyb*(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)
    coef24 =  -iyb*(c4*c6-s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6-s4*s5*s6))
    coef25 =  izb*s4*c5 + lbo*mb*(lbo*s4*c5+la*(s4*c6+s5*s6*c4))
    coef31 =  iyb*s6*c5*(s4*c6+s5*s6*c4) - izb*s5*c4*c5 - ixb*c5*c6*(s4*s6-s5*c4*c6) - lbo*mb*(lbo*s5*c4*c5+la*s5*(c4*c6-s4*s5*s6)-la*s4*s6*c5^2-lbo*s6*c5*(s4*c6+s5*s6*c4))
    coef32 =  izb*s4*c4*c5^2 + mb*lbo^2*(s4*c4*c5^2-(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)) - ixb*(s6*c4+s4*s5*c6)*(s4*s6-s5*c4*c6) - iyb*(s4*c6+s5*s6*c4)*(c4*c6-s4*s5*s6)
    coef33 =  -iza - ma*lao^2 - izb*c4^2*c5^2 - iyb*(s4*c6+s5*s6*c4)^2 - ixb*(s4*s6-s5*c4*c6)^2 - mb*(la^2+lbo^2*c4^2*c5^2+lbo^2*(s4*c6+s5*s6*c4)^2+2*la*lbo*s4*c5*(s4*c6+s5*s6*c4)+2*la*lbo*c4*c5*(c4*c6-s4*s5*s6))
    coef34 =  -iyb*(s4*c6+s5*s6*c4) - lbo*mb*(la*s4*c5+lbo*(s4*c6+s5*s6*c4))
    coef35 =  -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6-s4*s5*s6))
    coef41 =  (iyb+mb*lbo^2)*s6*c5
    coef42 =  -iyb*(c4*c6-s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6-s4*s5*s6))
    coef43 =  -iyb*(s4*c6+s5*s6*c4) - lbo*mb*(la*s4*c5+lbo*(s4*c6+s5*s6*c4))
    coef44 =  -iyb - mb*lbo^2
    coef45 =  0
    coef51 =  -(izb+mb*lbo^2)*s5
    coef52 =  izb*s4*c5 + lbo*mb*(lbo*s4*c5+la*(s4*c6+s5*s6*c4))
    coef53 =  -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6-s4*s5*s6))
    coef54 =  0
    coef55 =  -izb - mb*lbo^2
    rhs1 =  ba*u1 + iyb*s6*c5*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) + ixb*c5*c6*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + izb*s5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + lbo*mb*(pxpp*s6*c5*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+pxpp*s5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))+pzpp*s6*c5*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+pypp*s6*c5*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la*s6*c4*c5^2*u1*u3+la*s5*(s4*c6+s5*s6*c4)*u1*u3+la*s5*(c4*c6-s4*s5*s6)*u1*u2+lbo*s5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-pypp*s5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))-pzpp*s5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-la*s4*s6*c5^2*u1*u2-lbo*s6*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))) + ixb*c5*c6*u4p - ka*(eqx-q1) - g*lbo*mb*(s6*c5*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-s5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) - (iya-iza)*u2*u3 - s6*c5*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) - c5*c6*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - s5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3)
    rhs2 =  g*lao*ma*c1*c2 + g*mb*(la*c1*c2+lbo*(c4*c6-s4*s5*s6)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-lbo*s4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) + ba*u2 + (ixa-iza)*u1*u3 + lao*ma*(pypp*s1*c2-pxpp*s2-pzpp*c1*c2-lao*u1*u3) + ixb*(s6*c4+s4*s5*c6)*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + (c4*c6-s4*s5*s6)*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) + s4*c5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3) + ixb*(s6*c4+s4*s5*c6)*u4p - ka*(eqy-q2) - iyb*(c4*c6-s4*s5*s6)*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - izb*s4*c5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) - (s6*c4+s4*s5*c6)*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - mb*(la*pxpp*s2+la*pzpp*c1*c2+lbo*pxpp*(c4*c6-s4*s5*s6)*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+lbo*pxpp*s4*c5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))+lbo*pzpp*(c4*c6-s4*s5*s6)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+lbo*pypp*(c4*c6-s4*s5*s6)*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la^2*u1*u3+la*lbo*s4*s6*c5^2*(u2^2+u3^2)+la*lbo*s4*c5*(s4*c6+s5*s6*c4)*u1*u3+la*lbo*c4*c5*(c4*c6-s4*s5*s6)*u1*u3+lbo^2*s4*c5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)+la*lbo*(s4*c6+s5*s6*c4)*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*pypp*s1*c2-lbo*pypp*s4*c5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))-lbo*pzpp*s4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-la*lbo*s5*(c4*c6-s4*s5*s6)*(u2^2+u3^2)-la*lbo*(s4*s6-s5*c4*c6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)^2+(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)^2)-la*lbo*c4*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(c4*c6-s4*s5*s6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
    rhs3 =  ba*u3 + ixb*(s4*s6-s5*c4*c6)*(u5*(s4*c5*u2-u6-s5*u1-c4*c5*u3)-u6*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + izb*c4*c5*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) + (s4*c6+s5*s6*c4)*(ixb*u4*u6+ixb*s5*u1*u4+ixb*c4*c5*u3*u4+ixb*c5*c6*u1*u6+izb*s4*c5*u2*u4+ixb*s5*c5*c6*u1^2+ixb*c4*c6*c5^2*u1*u3+izb*s4*c6*c5^2*u1*u2+ixb*(s6*c4+s4*s5*c6)*u2*u6+ixb*(s4*s6-s5*c4*c6)*u3*u6+ixb*s5*(s6*c4+s4*s5*c6)*u1*u2+ixb*s5*(s4*s6-s5*c4*c6)*u1*u3+ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3+izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2+ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2+izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*u4*u6-izb*s5*u1*u4-ixb*s4*c5*u2*u4-izb*c4*c5*u3*u4-izb*c5*c6*u1*u6-izb*s5*c5*c6*u1^2-ixb*s4*c6*c5^2*u1*u2-izb*c4*c6*c5^2*u1*u3-izb*(s6*c4+s4*s5*c6)*u2*u6-izb*(s4*s6-s5*c4*c6)*u3*u6-izb*s5*(s6*c4+s4*s5*c6)*u1*u2-izb*s5*(s4*s6-s5*c4*c6)*u1*u3-ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2-izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3-ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3-izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2) + ixb*(s4*s6-s5*c4*c6)*u4p - ka*(eqz-q3) - g*lao*ma*(s1*c3+s2*s3*c1) - g*mb*(la*(s1*c3+s2*s3*c1)-lbo*(s4*c6+s5*s6*c4)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))-lbo*c4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))) - (ixa-iya)*u1*u2 - lao*ma*(pxpp*s3*c2-pzpp*(s1*c3+s2*s3*c1)-pypp*(c1*c3-s1*s2*s3)-lao*u1*u2) - iyb*(s4*c6+s5*s6*c4)*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - (s4*s6-s5*c4*c6)*(iyb*u5*u6+iyb*s5*u1*u5+iyb*c4*c5*u3*u5+izb*s4*c5*u2*u5+izb*s6*c5*u1*u6+izb*s5*s6*c5*u1^2+iyb*s4*s6*c5^2*u1*u2+izb*s6*c4*c5^2*u1*u3+iyb*(s4*c6+s5*s6*c4)*u3*u6+iyb*(c4*c6-s4*s5*s6)*u2*u6+iyb*s5*(s4*c6+s5*s6*c4)*u1*u3+iyb*s5*(c4*c6-s4*s5*s6)*u1*u2+iyb*c4*c5*(s4*c6+s5*s6*c4)*u3^2+izb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3+iyb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3+izb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*u5*u6-izb*s5*u1*u5-iyb*s4*c5*u2*u5-iyb*s6*c5*u1*u6-izb*c4*c5*u3*u5-iyb*s5*s6*c5*u1^2-iyb*s6*c4*c5^2*u1*u3-izb*s4*s6*c5^2*u1*u2-izb*(s4*c6+s5*s6*c4)*u3*u6-izb*(c4*c6-s4*s5*s6)*u2*u6-izb*s5*(s4*c6+s5*s6*c4)*u1*u3-izb*s5*(c4*c6-s4*s5*s6)*u1*u2-iyb*s4*c5*(s4*c6+s5*s6*c4)*u2*u3-izb*c4*c5*(s4*c6+s5*s6*c4)*u3^2-iyb*s4*c5*(c4*c6-s4*s5*s6)*u2^2-izb*c4*c5*(c4*c6-s4*s5*s6)*u2*u3) - c4*c5*(ixb*u4*u5+ixb*c5*c6*u1*u5+iyb*s6*c5*u1*u4+iyb*s6*c6*c5^2*u1^2+ixb*(s4*c6+s5*s6*c4)*u3*u4+ixb*(s6*c4+s4*s5*c6)*u2*u5+ixb*(s4*s6-s5*c4*c6)*u3*u5+ixb*(c4*c6-s4*s5*s6)*u2*u4+ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3+iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2+ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2+iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3+ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3+ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2+ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2+ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3-iyb*u4*u5-ixb*s6*c5*u1*u4-iyb*c5*c6*u1*u5-ixb*s6*c6*c5^2*u1^2-iyb*(s4*c6+s5*s6*c4)*u3*u4-iyb*(s6*c4+s4*s5*c6)*u2*u5-iyb*(s4*s6-s5*c4*c6)*u3*u5-iyb*(c4*c6-s4*s5*s6)*u2*u4-ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2-iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3-ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3-iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2-iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3-iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2-iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2-iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3) - mb*(la*pxpp*s3*c2+lbo*pxpp*(s4*c6+s5*s6*c4)*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+lbo*pzpp*(s4*c6+s5*s6*c4)*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+lbo*pypp*(s4*c6+s5*s6*c4)*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+lbo*pypp*c4*c5*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))+lbo*pzpp*c4*c5*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))+la*lbo*(s6*c4+s4*s5*c6)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)^2+(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)^2)-la*pzpp*(s1*c3+s2*s3*c1)-la*pypp*(c1*c3-s1*s2*s3)-lbo*pxpp*c4*c5*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))-la^2*u1*u2-la*lbo*s6*c4*c5^2*(u2^2+u3^2)-la*lbo*s4*c5*(s4*c6+s5*s6*c4)*u1*u2-la*lbo*s5*(s4*c6+s5*s6*c4)*(u2^2+u3^2)-la*lbo*c4*c5*(c4*c6-s4*s5*s6)*u1*u2-lbo^2*c4*c5*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*lbo*(c4*c6-s4*s5*s6)*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p)-la*lbo*s4*c5*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(s4*c6+s5*s6*c4)*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
    rhs4 =  kb*q5 + g*lbo*mb*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1)) + bb*u5 + ixb*u4*u6 + ixb*s5*u1*u4 + ixb*c4*c5*u3*u4 + ixb*c5*c6*u1*u6 + izb*s4*c5*u2*u4 + ixb*s5*c5*c6*u1^2 + ixb*c4*c6*c5^2*u1*u3 + izb*s4*c6*c5^2*u1*u2 + ixb*(s6*c4+s4*s5*c6)*u2*u6 + ixb*(s4*s6-s5*c4*c6)*u3*u6 + ixb*s5*(s6*c4+s4*s5*c6)*u1*u2 + ixb*s5*(s4*s6-s5*c4*c6)*u1*u3 + ixb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3 + izb*s4*c5*(s6*c4+s4*s5*c6)*u2^2 + ixb*c4*c5*(s4*s6-s5*c4*c6)*u3^2 + izb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3 - izb*u4*u6 - izb*s5*u1*u4 - ixb*s4*c5*u2*u4 - izb*c4*c5*u3*u4 - izb*c5*c6*u1*u6 - izb*s5*c5*c6*u1^2 - ixb*s4*c6*c5^2*u1*u2 - izb*c4*c6*c5^2*u1*u3 - izb*(s6*c4+s4*s5*c6)*u2*u6 - izb*(s4*s6-s5*c4*c6)*u3*u6 - izb*s5*(s6*c4+s4*s5*c6)*u1*u2 - izb*s5*(s4*s6-s5*c4*c6)*u1*u3 - ixb*s4*c5*(s6*c4+s4*s5*c6)*u2^2 - izb*c4*c5*(s6*c4+s4*s5*c6)*u2*u3 - ixb*s4*c5*(s4*s6-s5*c4*c6)*u2*u3 - izb*c4*c5*(s4*s6-s5*c4*c6)*u3^2 - iyb*(u4*(s4*c5*u2-u6-s5*u1-c4*c5*u3)+u6*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)) - lbo*mb*(pxpp*(s2*c4*c5+s5*c2*c3+s3*s4*c2*c5)+pzpp*(c1*c2*c4*c5+s5*(s1*s3-s2*c1*c3)-s4*c5*(s1*c3+s2*s3*c1))+pypp*(s5*(s3*c1+s1*s2*c3)-s1*c2*c4*c5-s4*c5*(c1*c3-s1*s2*s3))+la*c4*c5*u1*u3-la*s4*c5*u1*u2-la*s5*(u2^2+u3^2)-lbo*((s4*c5*u2-u6-s5*u1-c4*c5*u3)*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+s5*s6*u1*q5p-c5*c6*u1*q6p-u2*(s4*c6*q4p+s6*c4*q6p+s4*s5*c6*q6p+s4*s6*c5*q5p+s5*s6*c4*q4p)-u3*(s4*s6*q6p+s4*s5*s6*q4p-c4*c6*q4p-s5*c4*c6*q6p-s6*c4*c5*q5p)))
    rhs5 =  kb*q6 + g*lbo*mb*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6)) + bb*u6 + iyb*u4*u5 + ixb*s6*c5*u1*u4 + iyb*c5*c6*u1*u5 + ixb*s6*c6*c5^2*u1^2 + iyb*(s4*c6+s5*s6*c4)*u3*u4 + iyb*(s6*c4+s4*s5*c6)*u2*u5 + iyb*(s4*s6-s5*c4*c6)*u3*u5 + iyb*(c4*c6-s4*s5*s6)*u2*u4 + ixb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2 + iyb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3 + ixb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3 + iyb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2 + iyb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3 + iyb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2 + iyb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2 + iyb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3 + izb*(u5*(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)+u4*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)) - ixb*u4*u5 - ixb*c5*c6*u1*u5 - iyb*s6*c5*u1*u4 - iyb*s6*c6*c5^2*u1^2 - ixb*(s4*c6+s5*s6*c4)*u3*u4 - ixb*(s6*c4+s4*s5*c6)*u2*u5 - ixb*(s4*s6-s5*c4*c6)*u3*u5 - ixb*(c4*c6-s4*s5*s6)*u2*u4 - ixb*c5*c6*(s4*c6+s5*s6*c4)*u1*u3 - iyb*s6*c5*(s6*c4+s4*s5*c6)*u1*u2 - ixb*c5*c6*(c4*c6-s4*s5*s6)*u1*u2 - iyb*s6*c5*(s4*s6-s5*c4*c6)*u1*u3 - ixb*(s4*c6+s5*s6*c4)*(s6*c4+s4*s5*c6)*u2*u3 - ixb*(s4*c6+s5*s6*c4)*(s4*s6-s5*c4*c6)*u3^2 - ixb*(s6*c4+s4*s5*c6)*(c4*c6-s4*s5*s6)*u2^2 - ixb*(s4*s6-s5*c4*c6)*(c4*c6-s4*s5*s6)*u2*u3 - lbo*mb*(pypp*(s1*c2*(s4*c6+s5*s6*c4)+s6*c5*(s3*c1+s1*s2*c3)-(c1*c3-s1*s2*s3)*(c4*c6-s4*s5*s6))+pzpp*(s6*c5*(s1*s3-s2*c1*c3)-c1*c2*(s4*c6+s5*s6*c4)-(s1*c3+s2*s3*c1)*(c4*c6-s4*s5*s6))-pxpp*(s2*(s4*c6+s5*s6*c4)-s6*c2*c3*c5-s3*c2*(c4*c6-s4*s5*s6))-la*s6*c5*(u2^2+u3^2)-la*(s4*c6+s5*s6*c4)*u1*u3-la*(c4*c6-s4*s5*s6)*u1*u2-lbo*(c5*u1*q5p+s4*s5*u2*q5p-(u4+c5*c6*u1+(s6*c4+s4*s5*c6)*u2+(s4*s6-s5*c4*c6)*u3)*(s6*c5*u1-u5-(s4*c6+s5*s6*c4)*u3-(c4*c6-s4*s5*s6)*u2)-s4*c5*u3*q4p-s5*c4*u3*q5p-c4*c5*u2*q4p))
                   
    coef = @SMatrix [coef11 coef12 coef13 coef14 coef15
                     coef21 coef22 coef23 coef24 coef25
                     coef31 coef32 coef33 coef34 coef35
                     coef41 coef42 coef43 coef44 coef45
                     coef51 coef52 coef53 coef54 coef55]
    rhs = @SVector [rhs1, rhs2, rhs3, rhs4, rhs5]

    @inbounds u1p, u2p, u3p, u5p, u6p = coef \ rhs

    @SVector [q1p,q2p,q3p,q4p,q5p,q6p,u1p,u2p,u3p,u4p,u5p,u6p]
end