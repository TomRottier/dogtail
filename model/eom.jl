function eom!(du, u, p, t)
    ma, ixa, iya, iza, lao, la, mb, ixb, iyb, izb, lbo, lb, g, ka, kb, ba, bb = p
    q1, q2, q3, q4, q5, q6, u1, u2, u3, u4, u5, u6 = u

    pxpp, pypp, pzpp = p.pfpp(t)
    
    coef = matrix{float64}(undef, 6, 6)
    rhs = vector{float64}(undef, 6)

    s1 = s1; s2 = s2; s3 = s3; s4 = s4; s5 = s5; s6 = s6
    c1 = c1; c2 = c2; c3 = c3; c4 = c4; c5 = c5; c6 = c6

    q1p = u1 + tan(q2) * (s1 * u2 + c1 * u3)
    q2p = c1 * u2 - s1 * u3
    q3p = (s1 * u2 + c1 * u3) / c2
    q4p = u4 + tan(q5) * (s4 * u5 + c4 * u6)
    q5p = c4 * u5 - s4 * u6
    q6p = (s4 * u5 + c4 * u6) / c5

    coef[1,1] = -ixa - ixb * c5^2 * c6^2 - izb * (s4 * s6 + s5 * c4 * c6)^2 - iyb * (s6 * c4 - s4 * s5 * c6)^2 - mb * lbo^2 * ((s4 * s6 + s5 * c4 * c6)^2 + (s6 * c4 - s4 * s5 * c6)^2)
    coef[1,2] = iyb * (c4 * c6 + s4 * s5 * s6) * (s6 * c4 - s4 * s5 * c6) + izb * (s4 * s6 + s5 * c4 * c6) * (s4 * c6 - s5 * s6 * c4) + lbo * mb * (la * s4 * c5 * (s4 * s6 + s5 * c4 * c6) + la * c4 * c5 * (s6 * c4 - s4 * s5 * c6) + lbo * (s4 * s6 + s5 * c4 * c6) * (s4 * c6 - s5 * s6 * c4) + lbo * (c4 * c6 + s4 * s5 * s6) * (s6 * c4 - s4 * s5 * c6)) - ixb * s6 * c6 * c5^2
    coef[1,3] = ixb * s5 * c5 * c6 + iyb * s4 * c5 * (s6 * c4 - s4 * s5 * c6) - izb * c4 * c5 * (s4 * s6 + s5 * c4 * c6) - lbo * mb * (lbo * c4 * c5 * (s4 * s6 + s5 * c4 * c6) + la * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) - lbo * s4 * c5 * (s6 * c4 - s4 * s5 * c6) - la * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6))
    coef[1,4] = -ixb * c5 * c6
    coef[1,5] = (iyb + mb * lbo^2) * (s6 * c4 - s4 * s5 * c6)
    coef[1,6] = -(izb + mb * lbo^2) * (s4 * s6 + s5 * c4 * c6)
    coef[2,1] = iyb * (c4 * c6 + s4 * s5 * s6) * (s6 * c4 - s4 * s5 * c6) + izb * (s4 * s6 + s5 * c4 * c6) * (s4 * c6 - s5 * s6 * c4) + lbo * mb * (la * s4 * c5 * (s4 * s6 + s5 * c4 * c6) + la * c4 * c5 * (s6 * c4 - s4 * s5 * c6) + lbo * (s4 * s6 + s5 * c4 * c6) * (s4 * c6 - s5 * s6 * c4) + lbo * (c4 * c6 + s4 * s5 * s6) * (s6 * c4 - s4 * s5 * c6)) - ixb * s6 * c6 * c5^2
    coef[2,2] = -iya - ma * lao^2 - ixb * s6^2 * c5^2 - iyb * (c4 * c6 + s4 * s5 * s6)^2 - izb * (s4 * c6 - s5 * s6 * c4)^2 - mb * (la^2 + lbo^2 * (c4 * c6 + s4 * s5 * s6)^2 + lbo^2 * (s4 * c6 - s5 * s6 * c4)^2 + 2 * la * lbo * c4 * c5 * (c4 * c6 + s4 * s5 * s6) + 2 * la * lbo * s4 * c5 * (s4 * c6 - s5 * s6 * c4))
    coef[2,3] = c5 * (ixb * s5 * s6 + izb * c4 * (s4 * c6 - s5 * s6 * c4) - iyb * s4 * (c4 * c6 + s4 * s5 * s6) - mb * lbo^2 * (s4 * (c4 * c6 + s4 * s5 * s6) - c4 * (s4 * c6 - s5 * s6 * c4)))
    coef[2,4] = -ixb * s6 * c5
    coef[2,5] = -iyb * (c4 * c6 + s4 * s5 * s6) - lbo * mb * (la * c4 * c5 + lbo * (c4 * c6 + s4 * s5 * s6))
    coef[2,6] = izb * (s4 * c6 - s5 * s6 * c4) + lbo * mb * (la * s4 * c5 + lbo * (s4 * c6 - s5 * s6 * c4))
    coef[3,1] = ixb * s5 * c5 * c6 + iyb * s4 * c5 * (s6 * c4 - s4 * s5 * c6) - izb * c4 * c5 * (s4 * s6 + s5 * c4 * c6) - lbo * mb * (lbo * c4 * c5 * (s4 * s6 + s5 * c4 * c6) + la * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) - lbo * s4 * c5 * (s6 * c4 - s4 * s5 * c6) - la * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6))
    coef[3,2] = c5 * (ixb * s5 * s6 + izb * c4 * (s4 * c6 - s5 * s6 * c4) - iyb * s4 * (c4 * c6 + s4 * s5 * s6) - mb * lbo^2 * (s4 * (c4 * c6 + s4 * s5 * s6) - c4 * (s4 * c6 - s5 * s6 * c4)))
    coef[3,3] = -iza - ma * lao^2 - ixb * s5^2 - iyb * s4^2 * c5^2 - izb * c4^2 * c5^2 - mb * (la^2 + lbo^2 * c5^2 + 2 * la * lbo * c4 * c5 * (c4 * c6 + s4 * s5 * s6) + 2 * la * lbo * s4 * c5 * (s4 * c6 - s5 * s6 * c4))
    coef[3,4] = ixb * s5
    coef[3,5] = -iyb * s4 * c5 - lbo * mb * (lbo * s4 * c5 + la * (s4 * c6 - s5 * s6 * c4))
    coef[3,6] = -izb * c4 * c5 - lbo * mb * (lbo * c4 * c5 + la * (c4 * c6 + s4 * s5 * s6))
    coef[4,1] = -ixb * c5 * c6
    coef[4,2] = -ixb * s6 * c5
    coef[4,3] = ixb * s5
    coef[4,4] = -ixb
    coef[4,5] = 0
    coef[4,6] = 0
    coef[5,1] = (iyb + mb * lbo^2) * (s6 * c4 - s4 * s5 * c6)
    coef[5,2] = -iyb * (c4 * c6 + s4 * s5 * s6) - lbo * mb * (la * c4 * c5 + lbo * (c4 * c6 + s4 * s5 * s6))
    coef[5,3] = -iyb * s4 * c5 - lbo * mb * (lbo * s4 * c5 + la * (s4 * c6 - s5 * s6 * c4))
    coef[5,4] = 0
    coef[5,5] = -iyb - mb * lbo^2
    coef[5,6] = 0
    coef[6,1] = -(izb + mb * lbo^2) * (s4 * s6 + s5 * c4 * c6)
    coef[6,2] = izb * (s4 * c6 - s5 * s6 * c4) + lbo * mb * (la * s4 * c5 + lbo * (s4 * c6 - s5 * s6 * c4))
    coef[6,3] = -izb * c4 * c5 - lbo * mb * (lbo * c4 * c5 + la * (c4 * c6 + s4 * s5 * s6))
    coef[6,4] = 0
    coef[6,5] = 0
    coef[6,6] = -izb - mb * lbo^2

    rhs[1] = ka * q1 + ba * u1 + (s4 * s6 + s5 * c4 * c6) * (iyb * u4 * u5 + ixb * s5 * u3 * u5 + iyb * s4 * c5 * u3 * u4 + iyb * s6 * c5 * u2 * u5 + iyb * c5 * c6 * u1 * u5 + ixb * s4 * s5 * c5 * u3^2 + iyb * s4 * s6 * c5^2 * u2 * u3 + iyb * s4 * c6 * c5^2 * u1 * u3 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 + ixb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 + ixb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + iyb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 + iyb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + ixb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2 - ixb * u4 * u5 - iyb * s5 * u3 * u5 - ixb * s4 * c5 * u3 * u4 - ixb * s6 * c5 * u2 * u5 - ixb * c5 * c6 * u1 * u5 - iyb * s4 * s5 * c5 * u3^2 - ixb * s4 * s6 * c5^2 * u2 * u3 - ixb * s4 * c6 * c5^2 * u1 * u3 - ixb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 - iyb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - ixb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - ixb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 - ixb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2) + (s6 * c4 - s4 * s5 * c6) * (izb * u4 * u6 + ixb * s5 * u3 * u6 + izb * s6 * c5 * u2 * u6 + izb * c4 * c5 * u3 * u4 + izb * c5 * c6 * u1 * u6 + ixb * s5 * c4 * c5 * u3^2 + izb * s6 * c4 * c5^2 * u2 * u3 + izb * c4 * c6 * c5^2 * u1 * u3 + izb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 + ixb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 + ixb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + izb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 + izb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 + ixb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 + ixb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - ixb * u4 * u6 - izb * s5 * u3 * u6 - ixb * s6 * c5 * u2 * u6 - ixb * c4 * c5 * u3 * u4 - ixb * c5 * c6 * u1 * u6 - izb * s5 * c4 * c5 * u3^2 - ixb * s6 * c4 * c5^2 * u2 * u3 - ixb * c4 * c6 * c5^2 * u1 * u3 - ixb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 - izb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 - izb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - ixb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - ixb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 - ixb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 - izb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2) + lbo * mb * (pzpp * (s4 * s6 + s5 * c4 * c6) * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) + pzpp * (s6 * c4 - s4 * s5 * c6) * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4)) + pxpp * (s6 * c4 - s4 * s5 * c6) * (c2 * c3 * (s4 * s6 + s5 * c4 * c6) + c4 * c5 * (s1 * s3 + s2 * c1 * c3) + (s3 * c1 - s1 * s2 * c3) * (s4 * c6 - s5 * s6 * c4)) + pxpp * (s4 * s6 + s5 * c4 * c6) * (s4 * c5 * (s1 * s3 + s2 * c1 * c3) - c2 * c3 * (s6 * c4 - s4 * s5 * c6) - (c4 * c6 + s4 * s5 * s6) * (s3 * c1 - s1 * s2 * c3)) + pypp * (s6 * c4 - s4 * s5 * c6) * (s3 * c2 * (s4 * s6 + s5 * c4 * c6) - c4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (s4 * c6 - s5 * s6 * c4)) + la * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + la * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + la * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - pypp * (s4 * s6 + s5 * c4 * c6) * (s3 * c2 * (s6 * c4 - s4 * s5 * c6) + s4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (c4 * c6 + s4 * s5 * s6)) - la * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - lbo * (s4 * s6 + s5 * c4 * c6) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - lbo * (s6 * c4 - s4 * s5 * c6) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p))) - g * lbo * mb * ((s4 * s6 + s5 * c4 * c6) * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) + (s6 * c4 - s4 * s5 * c6) * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4))) - (iya - iza) * u2 * u3 - izb * (s4 * s6 + s5 * c4 * c6) * (u5 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) - iyb * (s6 * c4 - s4 * s5 * c6) * (u6 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)) - ixb * c5 * c6 * (u5 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) - u6 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) - c5 * c6 * (iyb * u5 * u6 + iyb * s4 * c5 * u3 * u6 + iyb * c4 * c5 * u3 * u5 + iyb * s4 * c4 * c5^2 * u3^2 + iyb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 + izb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 + izb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 + iyb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + iyb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + izb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 + izb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 + iyb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - izb * u5 * u6 - izb * s4 * c5 * u3 * u6 - izb * c4 * c5 * u3 * u5 - izb * s4 * c4 * c5^2 * u3^2 - izb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 - izb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 - iyb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 - izb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - izb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - iyb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - iyb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - izb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 - iyb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2)
    rhs[2] = ka * q2 + g * lao * ma * c1 * c2 + g * mb * (la * c1 * c2 + lbo * (s4 * c6 - s5 * s6 * c4) * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) + lbo * (c4 * c6 + s4 * s5 * s6) * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4))) + ba * u2 + (ixa - iza) * u1 * u3 + lao * ma * (pypp * (s1 * c3 - s2 * s3 * c1) - pzpp * c1 * c2 - pxpp * (s1 * s3 + s2 * c1 * c3) - lao * u1 * u3) + iyb * (c4 * c6 + s4 * s5 * s6) * (u6 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)) + izb * (s4 * c6 - s5 * s6 * c4) * (u5 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) - ixb * s6 * c5 * (u5 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) - u6 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) - (c4 * c6 + s4 * s5 * s6) * (izb * u4 * u6 + ixb * s5 * u3 * u6 + izb * s6 * c5 * u2 * u6 + izb * c4 * c5 * u3 * u4 + izb * c5 * c6 * u1 * u6 + ixb * s5 * c4 * c5 * u3^2 + izb * s6 * c4 * c5^2 * u2 * u3 + izb * c4 * c6 * c5^2 * u1 * u3 + izb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 + ixb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 + ixb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + izb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 + izb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 + ixb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 + ixb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - ixb * u4 * u6 - izb * s5 * u3 * u6 - ixb * s6 * c5 * u2 * u6 - ixb * c4 * c5 * u3 * u4 - ixb * c5 * c6 * u1 * u6 - izb * s5 * c4 * c5 * u3^2 - ixb * s6 * c4 * c5^2 * u2 * u3 - ixb * c4 * c6 * c5^2 * u1 * u3 - ixb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 - izb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 - izb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - ixb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - ixb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 - ixb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 - izb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2) - (s4 * c6 - s5 * s6 * c4) * (iyb * u4 * u5 + ixb * s5 * u3 * u5 + iyb * s4 * c5 * u3 * u4 + iyb * s6 * c5 * u2 * u5 + iyb * c5 * c6 * u1 * u5 + ixb * s4 * s5 * c5 * u3^2 + iyb * s4 * s6 * c5^2 * u2 * u3 + iyb * s4 * c6 * c5^2 * u1 * u3 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 + ixb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 + ixb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + iyb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 + iyb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + ixb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2 - ixb * u4 * u5 - iyb * s5 * u3 * u5 - ixb * s4 * c5 * u3 * u4 - ixb * s6 * c5 * u2 * u5 - ixb * c5 * c6 * u1 * u5 - iyb * s4 * s5 * c5 * u3^2 - ixb * s4 * s6 * c5^2 * u2 * u3 - ixb * s4 * c6 * c5^2 * u1 * u3 - ixb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 - iyb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - ixb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - ixb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 - ixb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2) - s6 * c5 * (iyb * u5 * u6 + iyb * s4 * c5 * u3 * u6 + iyb * c4 * c5 * u3 * u5 + iyb * s4 * c4 * c5^2 * u3^2 + iyb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 + izb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 + izb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 + iyb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + iyb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + izb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 + izb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 + iyb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - izb * u5 * u6 - izb * s4 * c5 * u3 * u6 - izb * c4 * c5 * u3 * u5 - izb * s4 * c4 * c5^2 * u3^2 - izb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 - izb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 - iyb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 - izb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - izb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - iyb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - iyb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - izb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 - iyb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2) - mb * (la * pzpp * c1 * c2 + la * pxpp * (s1 * s3 + s2 * c1 * c3) + lbo * pzpp * (s4 * c6 - s5 * s6 * c4) * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) + lbo * pzpp * (c4 * c6 + s4 * s5 * s6) * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4)) + lbo * pxpp * (c4 * c6 + s4 * s5 * s6) * (c2 * c3 * (s4 * s6 + s5 * c4 * c6) + c4 * c5 * (s1 * s3 + s2 * c1 * c3) + (s3 * c1 - s1 * s2 * c3) * (s4 * c6 - s5 * s6 * c4)) + lbo * pypp * (c4 * c6 + s4 * s5 * s6) * (s3 * c2 * (s4 * s6 + s5 * c4 * c6) - c4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (s4 * c6 - s5 * s6 * c4)) + lbo * pxpp * (s4 * c6 - s5 * s6 * c4) * (s4 * c5 * (s1 * s3 + s2 * c1 * c3) - c2 * c3 * (s6 * c4 - s4 * s5 * c6) - (c4 * c6 + s4 * s5 * s6) * (s3 * c1 - s1 * s2 * c3)) + la^2 * u1 * u3 + la * lbo * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u1 * u3 + la * lbo * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u1 * u3 + la * lbo * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * (u2^2 + u3^2) + la * lbo * s5 * ((u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)^2 + (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)^2) - la * pypp * (s1 * c3 - s2 * s3 * c1) - lbo * pypp * (s4 * c6 - s5 * s6 * c4) * (s3 * c2 * (s6 * c4 - s4 * s5 * c6) + s4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (c4 * c6 + s4 * s5 * s6)) - la * lbo * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * (u2^2 + u3^2) - la * lbo * s4 * c5 * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - la * lbo * c4 * c5 * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p)) - lbo^2 * (s4 * c6 - s5 * s6 * c4) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - lbo^2 * (c4 * c6 + s4 * s5 * s6) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p)))
    rhs[3] = ka * q3 + ba * u3 + iyb * s4 * c5 * (u6 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)) + ixb * s5 * (u5 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) - u6 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) + c4 * c5 * (iyb * u4 * u5 + ixb * s5 * u3 * u5 + iyb * s4 * c5 * u3 * u4 + iyb * s6 * c5 * u2 * u5 + iyb * c5 * c6 * u1 * u5 + ixb * s4 * s5 * c5 * u3^2 + iyb * s4 * s6 * c5^2 * u2 * u3 + iyb * s4 * c6 * c5^2 * u1 * u3 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 + ixb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 + ixb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + iyb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 + iyb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + ixb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2 - ixb * u4 * u5 - iyb * s5 * u3 * u5 - ixb * s4 * c5 * u3 * u4 - ixb * s6 * c5 * u2 * u5 - ixb * c5 * c6 * u1 * u5 - iyb * s4 * s5 * c5 * u3^2 - ixb * s4 * s6 * c5^2 * u2 * u3 - ixb * s4 * c6 * c5^2 * u1 * u3 - ixb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 - iyb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - ixb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - ixb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 - ixb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2) + s5 * (iyb * u5 * u6 + iyb * s4 * c5 * u3 * u6 + iyb * c4 * c5 * u3 * u5 + iyb * s4 * c4 * c5^2 * u3^2 + iyb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 + izb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 + izb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 + iyb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + iyb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + izb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + izb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 + izb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 + iyb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - izb * u5 * u6 - izb * s4 * c5 * u3 * u6 - izb * c4 * c5 * u3 * u5 - izb * s4 * c4 * c5^2 * u3^2 - izb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 - izb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 - iyb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 - izb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - izb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - iyb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - iyb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - izb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 - iyb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2) - g * lao * ma * s1 * c2 - g * mb * (la * s1 * c2 + lbo * c4 * c5 * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) - lbo * s4 * c5 * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4))) - (ixa - iya) * u1 * u2 - lao * ma * (pxpp * (s3 * c1 - s1 * s2 * c3) - pzpp * s1 * c2 - pypp * (c1 * c3 + s1 * s2 * s3) - lao * u1 * u2) - izb * c4 * c5 * (u5 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)) - s4 * c5 * (izb * u4 * u6 + ixb * s5 * u3 * u6 + izb * s6 * c5 * u2 * u6 + izb * c4 * c5 * u3 * u4 + izb * c5 * c6 * u1 * u6 + ixb * s5 * c4 * c5 * u3^2 + izb * s6 * c4 * c5^2 * u2 * u3 + izb * c4 * c6 * c5^2 * u1 * u3 + izb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 + ixb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 + ixb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + izb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + izb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 + izb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 + ixb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 + ixb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - ixb * u4 * u6 - izb * s5 * u3 * u6 - ixb * s6 * c5 * u2 * u6 - ixb * c4 * c5 * u3 * u4 - ixb * c5 * c6 * u1 * u6 - izb * s5 * c4 * c5 * u3^2 - ixb * s6 * c4 * c5^2 * u2 * u3 - ixb * c4 * c6 * c5^2 * u1 * u3 - ixb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 - izb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 - izb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - ixb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - ixb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 - ixb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 - izb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 - izb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2) - mb * (la * pxpp * (s3 * c1 - s1 * s2 * c3) + lbo * pzpp * s4 * c5 * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4)) + lbo * pxpp * s4 * c5 * (c2 * c3 * (s4 * s6 + s5 * c4 * c6) + c4 * c5 * (s1 * s3 + s2 * c1 * c3) + (s3 * c1 - s1 * s2 * c3) * (s4 * c6 - s5 * s6 * c4)) + lbo * pypp * c4 * c5 * (s3 * c2 * (s6 * c4 - s4 * s5 * c6) + s4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (c4 * c6 + s4 * s5 * s6)) + lbo * pypp * s4 * c5 * (s3 * c2 * (s4 * s6 + s5 * c4 * c6) - c4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (s4 * c6 - s5 * s6 * c4)) + la * lbo * s6 * c5 * ((u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1)^2 + (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)^2) + lbo^2 * c4 * c5 * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) + la * lbo * (c4 * c6 + s4 * s5 * s6) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p)) - la * pzpp * s1 * c2 - la * pypp * (c1 * c3 + s1 * s2 * s3) - lbo * pzpp * c4 * c5 * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) - lbo * pxpp * c4 * c5 * (s4 * c5 * (s1 * s3 + s2 * c1 * c3) - c2 * c3 * (s6 * c4 - s4 * s5 * c6) - (c4 * c6 + s4 * s5 * s6) * (s3 * c1 - s1 * s2 * c3)) - la^2 * u1 * u2 - la * lbo * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - la * lbo * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - la * lbo * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * (u2^2 + u3^2) - la * lbo * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * (u2^2 + u3^2) - lbo^2 * s4 * c5 * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p)) - la * lbo * (s4 * c6 - s5 * s6 * c4) * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p)))
    rhs[4] = kb * q4 + bb * u4 + izb * u5 * u6 + izb * s4 * c5 * u3 * u6 + izb * c4 * c5 * u3 * u5 + izb * s4 * c4 * c5^2 * u3^2 + izb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 + izb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 + iyb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 + iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 + izb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + izb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + iyb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + iyb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + izb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + iyb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 + iyb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 + izb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - iyb * u5 * u6 - iyb * s4 * c5 * u3 * u6 - iyb * c4 * c5 * u3 * u5 - iyb * s4 * c4 * c5^2 * u3^2 - iyb * (s4 * s6 + s5 * c4 * c6) * u1 * u5 - iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u6 - izb * (s4 * c6 - s5 * s6 * c4) * u2 * u5 - izb * (s6 * c4 - s4 * s5 * c6) * u1 * u6 - iyb * s4 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - iyb * c4 * c5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - izb * s4 * c5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - izb * c4 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - iyb * (s4 * s6 + s5 * c4 * c6) * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - izb * (s4 * s6 + s5 * c4 * c6) * (s6 * c4 - s4 * s5 * c6) * u1^2 - izb * (c4 * c6 + s4 * s5 * s6) * (s4 * c6 - s5 * s6 * c4) * u2^2 - iyb * (s4 * c6 - s5 * s6 * c4) * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - ixb * (u5 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) - u6 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1))
    rhs[5] = kb * q5 + g * lbo * mb * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4)) + bb * u5 + ixb * u4 * u6 + izb * s5 * u3 * u6 + ixb * s6 * c5 * u2 * u6 + ixb * c4 * c5 * u3 * u4 + ixb * c5 * c6 * u1 * u6 + izb * s5 * c4 * c5 * u3^2 + ixb * s6 * c4 * c5^2 * u2 * u3 + ixb * c4 * c6 * c5^2 * u1 * u3 + ixb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 + izb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 + izb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 + ixb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 + ixb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 + ixb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 + izb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 + izb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 + iyb * (u6 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2)) - izb * u4 * u6 - ixb * s5 * u3 * u6 - izb * s6 * c5 * u2 * u6 - izb * c4 * c5 * u3 * u4 - izb * c5 * c6 * u1 * u6 - ixb * s5 * c4 * c5 * u3^2 - izb * s6 * c4 * c5^2 * u2 * u3 - izb * c4 * c6 * c5^2 * u1 * u3 - izb * (s4 * s6 + s5 * c4 * c6) * u1 * u4 - ixb * (s4 * c6 - s5 * s6 * c4) * u2 * u4 - ixb * s5 * (s4 * s6 + s5 * c4 * c6) * u1 * u3 - izb * s5 * (s4 * c6 - s5 * s6 * c4) * u2 * u3 - izb * s6 * c5 * (s4 * s6 + s5 * c4 * c6) * u1 * u2 - izb * c5 * c6 * (s4 * s6 + s5 * c4 * c6) * u1^2 - ixb * s6 * c5 * (s4 * c6 - s5 * s6 * c4) * u2^2 - ixb * c5 * c6 * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - lbo * mb * (pzpp * (c1 * c2 * c4 * c5 - s2 * (s4 * s6 + s5 * c4 * c6) - s1 * c2 * (s4 * c6 - s5 * s6 * c4)) + pxpp * (c2 * c3 * (s4 * s6 + s5 * c4 * c6) + c4 * c5 * (s1 * s3 + s2 * c1 * c3) + (s3 * c1 - s1 * s2 * c3) * (s4 * c6 - s5 * s6 * c4)) + pypp * (s3 * c2 * (s4 * s6 + s5 * c4 * c6) - c4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (s4 * c6 - s5 * s6 * c4)) + la * c4 * c5 * u1 * u3 - la * (s4 * c6 - s5 * s6 * c4) * u1 * u2 - la * (s4 * s6 + s5 * c4 * c6) * (u2^2 + u3^2) - lbo * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u6 + c4 * c5 * u3 + (s4 * s6 + s5 * c4 * c6) * u1 - (s4 * c6 - s5 * s6 * c4) * u2) + c4 * c5 * u3 * q4p - s4 * s5 * u3 * q5p - u1 * (c4 * c6 * q6p + s4 * s5 * s6 * q6p - s4 * s6 * q4p - s4 * c5 * c6 * q5p - s5 * c4 * c6 * q4p) - u2 * (s4 * c6 * q4p + s6 * c4 * q6p - s4 * s5 * c6 * q6p - s4 * s6 * c5 * q5p - s5 * s6 * c4 * q4p)))
    rhs[6] = kb * q6 + bb * u6 + iyb * u4 * u5 + ixb * s5 * u3 * u5 + iyb * s4 * c5 * u3 * u4 + iyb * s6 * c5 * u2 * u5 + iyb * c5 * c6 * u1 * u5 + ixb * s4 * s5 * c5 * u3^2 + iyb * s4 * s6 * c5^2 * u2 * u3 + iyb * s4 * c6 * c5^2 * u1 * u3 + iyb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 + ixb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 + ixb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 + iyb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 + iyb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 + iyb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + ixb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 + ixb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2 + lbo * mb * (pzpp * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) + pxpp * (s4 * c5 * (s1 * s3 + s2 * c1 * c3) - c2 * c3 * (s6 * c4 - s4 * s5 * c6) - (c4 * c6 + s4 * s5 * s6) * (s3 * c1 - s1 * s2 * c3)) + la * s4 * c5 * u1 * u3 + la * (c4 * c6 + s4 * s5 * s6) * u1 * u2 + la * (s6 * c4 - s4 * s5 * c6) * (u2^2 + u3^2) - pypp * (s3 * c2 * (s6 * c4 - s4 * s5 * c6) + s4 * c5 * (s1 * c3 - s2 * s3 * c1) - (c1 * c3 + s1 * s2 * s3) * (c4 * c6 + s4 * s5 * s6)) - lbo * ((s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1) + s4 * c5 * u3 * q4p + s5 * c4 * u3 * q5p + u1 * (s4 * s5 * c6 * q4p + s5 * s6 * c4 * q6p - s4 * c6 * q6p - s6 * c4 * q4p - c4 * c5 * c6 * q5p) + u2 * (c4 * c6 * q4p + s4 * s5 * s6 * q4p - s4 * s6 * q6p - s5 * c4 * c6 * q6p - s6 * c4 * c5 * q5p))) - g * lbo * mb * (s4 * c1 * c2 * c5 + s2 * (s6 * c4 - s4 * s5 * c6) + s1 * c2 * (c4 * c6 + s4 * s5 * s6)) - ixb * u4 * u5 - iyb * s5 * u3 * u5 - ixb * s4 * c5 * u3 * u4 - ixb * s6 * c5 * u2 * u5 - ixb * c5 * c6 * u1 * u5 - iyb * s4 * s5 * c5 * u3^2 - ixb * s4 * s6 * c5^2 * u2 * u3 - ixb * s4 * c6 * c5^2 * u1 * u3 - ixb * (c4 * c6 + s4 * s5 * s6) * u2 * u4 - iyb * (s6 * c4 - s4 * s5 * c6) * u1 * u4 - iyb * s5 * (c4 * c6 + s4 * s5 * s6) * u2 * u3 - ixb * s5 * (s6 * c4 - s4 * s5 * c6) * u1 * u3 - ixb * s6 * c5 * (c4 * c6 + s4 * s5 * s6) * u2^2 - ixb * c5 * c6 * (c4 * c6 + s4 * s5 * s6) * u1 * u2 - iyb * s6 * c5 * (s6 * c4 - s4 * s5 * c6) * u1 * u2 - iyb * c5 * c6 * (s6 * c4 - s4 * s5 * c6) * u1^2 - izb * (u5 * (s5 * u3 - u4 - s6 * c5 * u2 - c5 * c6 * u1) + u4 * (u5 + s4 * c5 * u3 + (c4 * c6 + s4 * s5 * s6) * u2 - (s6 * c4 - s4 * s5 * c6) * u1))
        
    u1p, u2p, u3p, u4p, u5p, u6p = coef \ rhs

    du[1] = q1p
    du[2] = q2p
    du[3] = q3p
    du[4] = q4p
    du[5] = q5p
    du[6] = q6p
    du[7] = u1p
    du[8] = u2p
    du[9] = u3p
    du[10] = u4p
    du[11] = u5p
    du[12] = u6p


    return du
end


# ## no torques
# coef[1,1] = -ixa - ixb*c5^2*c6^2 - izb*(s4*s6+s5*c4*c6)^2 - iyb*(s6*c4-s4*s5*c6)^2 - mb*lbo^2*((s4*s6+s5*c4*c6)^2+(s6*c4-s4*s5*c6)^2)
# coef[1,2] = iyb*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6) + izb*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5*(s4*s6+s5*c4*c6)+la*c4*c5*(s6*c4-s4*s5*c6)+lbo*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4)+lbo*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6)) - ixb*s6*c6*c5^2
# coef[1,3] = ixb*s5*c5*c6 + iyb*s4*c5*(s6*c4-s4*s5*c6) - izb*c4*c5*(s4*s6+s5*c4*c6) - lbo*mb*(lbo*c4*c5*(s4*s6+s5*c4*c6)+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)-lbo*s4*c5*(s6*c4-s4*s5*c6)-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6))
# coef[1,4] = -ixb*c5*c6
# coef[1,5] = (iyb+mb*lbo^2)*(s6*c4-s4*s5*c6)
# coef[1,6] = -(izb+mb*lbo^2)*(s4*s6+s5*c4*c6)
# coef[2,1] = iyb*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6) + izb*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5*(s4*s6+s5*c4*c6)+la*c4*c5*(s6*c4-s4*s5*c6)+lbo*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4)+lbo*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6)) - ixb*s6*c6*c5^2
# coef[2,2] = -iya - ma*lao^2 - ixb*s6^2*c5^2 - iyb*(c4*c6+s4*s5*s6)^2 - izb*(s4*c6-s5*s6*c4)^2 - mb*(la^2+lbo^2*(c4*c6+s4*s5*s6)^2+lbo^2*(s4*c6-s5*s6*c4)^2+2*la*lbo*c4*c5*(c4*c6+s4*s5*s6)+2*la*lbo*s4*c5*(s4*c6-s5*s6*c4))
# coef[2,3] = c5*(ixb*s5*s6+izb*c4*(s4*c6-s5*s6*c4)-iyb*s4*(c4*c6+s4*s5*s6)-mb*lbo^2*(s4*(c4*c6+s4*s5*s6)-c4*(s4*c6-s5*s6*c4)))
# coef[2,4] = -ixb*s6*c5
# coef[2,5] = -iyb*(c4*c6+s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6+s4*s5*s6))
# coef[2,6] = izb*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5+lbo*(s4*c6-s5*s6*c4))
# coef[3,1] = ixb*s5*c5*c6 + iyb*s4*c5*(s6*c4-s4*s5*c6) - izb*c4*c5*(s4*s6+s5*c4*c6) - lbo*mb*(lbo*c4*c5*(s4*s6+s5*c4*c6)+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)-lbo*s4*c5*(s6*c4-s4*s5*c6)-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6))
# coef[3,2] = c5*(ixb*s5*s6+izb*c4*(s4*c6-s5*s6*c4)-iyb*s4*(c4*c6+s4*s5*s6)-mb*lbo^2*(s4*(c4*c6+s4*s5*s6)-c4*(s4*c6-s5*s6*c4)))
# coef[3,3] = -iza - ma*lao^2 - ixb*s5^2 - iyb*s4^2*c5^2 - izb*c4^2*c5^2 - mb*(la^2+lbo^2*c5^2+2*la*lbo*c4*c5*(c4*c6+s4*s5*s6)+2*la*lbo*s4*c5*(s4*c6-s5*s6*c4))
# coef[3,4] = ixb*s5
# coef[3,5] = -iyb*s4*c5 - lbo*mb*(lbo*s4*c5+la*(s4*c6-s5*s6*c4))
# coef[3,6] = -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6+s4*s5*s6))
# coef[4,1] = -ixb*c5*c6
# coef[4,2] = -ixb*s6*c5
# coef[4,3] = ixb*s5
# coef[4,4] = -ixb
# coef[4,5] = 0
# coef[4,6] = 0
# coef[5,1] = (iyb+mb*lbo^2)*(s6*c4-s4*s5*c6)
# coef[5,2] = -iyb*(c4*c6+s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6+s4*s5*s6))
# coef[5,3] = -iyb*s4*c5 - lbo*mb*(lbo*s4*c5+la*(s4*c6-s5*s6*c4))
# coef[5,4] = 0
# coef[5,5] = -iyb - mb*lbo^2
# coef[5,6] = 0
# coef[6,1] = -(izb+mb*lbo^2)*(s4*s6+s5*c4*c6)
# coef[6,2] = izb*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5+lbo*(s4*c6-s5*s6*c4))
# coef[6,3] = -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6+s4*s5*s6))
# coef[6,4] = 0
# coef[6,5] = 0
# coef[6,6] = -izb - mb*lbo^2
# rhs[1] = (s4*s6+s5*c4*c6)*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) + (s6*c4-s4*s5*c6)*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) + lbo*mb*(pzpp*(s4*s6+s5*c4*c6)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+pzpp*(s6*c4-s4*s5*c6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+pxpp*(s6*c4-s4*s5*c6)*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+pxpp*(s4*s6+s5*c4*c6)*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+pypp*(s6*c4-s4*s5*c6)*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+la*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-pypp*(s4*s6+s5*c4*c6)*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-lbo*(s4*s6+s5*c4*c6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo*(s6*c4-s4*s5*c6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))) - g*lbo*mb*((s4*s6+s5*c4*c6)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+(s6*c4-s4*s5*c6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) - (iya-iza)*u2*u3 - izb*(s4*s6+s5*c4*c6)*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - iyb*(s6*c4-s4*s5*c6)*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) - ixb*c5*c6*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - c5*c6*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2)
# rhs[2] = g*lao*ma*c1*c2 + g*mb*(la*c1*c2+lbo*(s4*c6-s5*s6*c4)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+lbo*(c4*c6+s4*s5*s6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) + (ixa-iza)*u1*u3 + lao*ma*(pypp*(s1*c3-s2*s3*c1)-pzpp*c1*c2-pxpp*(s1*s3+s2*c1*c3)-lao*u1*u3) + iyb*(c4*c6+s4*s5*s6)*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) + izb*(s4*c6-s5*s6*c4)*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - ixb*s6*c5*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - (c4*c6+s4*s5*s6)*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) - (s4*c6-s5*s6*c4)*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) - s6*c5*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2) - mb*(la*pzpp*c1*c2+la*pxpp*(s1*s3+s2*c1*c3)+lbo*pzpp*(s4*c6-s5*s6*c4)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+lbo*pzpp*(c4*c6+s4*s5*s6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+lbo*pxpp*(c4*c6+s4*s5*s6)*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+lbo*pypp*(c4*c6+s4*s5*s6)*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+lbo*pxpp*(s4*c6-s5*s6*c4)*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+la^2*u1*u3+la*lbo*c4*c5*(c4*c6+s4*s5*s6)*u1*u3+la*lbo*s4*c5*(s4*c6-s5*s6*c4)*u1*u3+la*lbo*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*(u2^2+u3^2)+la*lbo*s5*((u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)^2+(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)^2)-la*pypp*(s1*c3-s2*s3*c1)-lbo*pypp*(s4*c6-s5*s6*c4)*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-la*lbo*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*(u2^2+u3^2)-la*lbo*s4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-la*lbo*c4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))-lbo^2*(s4*c6-s5*s6*c4)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(c4*c6+s4*s5*s6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[3] = iyb*s4*c5*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) + ixb*s5*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) + c4*c5*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) + s5*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2) - g*lao*ma*s1*c2 - g*mb*(la*s1*c2+lbo*c4*c5*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))-lbo*s4*c5*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) - (ixa-iya)*u1*u2 - lao*ma*(pxpp*(s3*c1-s1*s2*c3)-pzpp*s1*c2-pypp*(c1*c3+s1*s2*s3)-lao*u1*u2) - izb*c4*c5*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - s4*c5*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) - mb*(la*pxpp*(s3*c1-s1*s2*c3)+lbo*pzpp*s4*c5*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+lbo*pxpp*s4*c5*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+lbo*pypp*c4*c5*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))+lbo*pypp*s4*c5*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*lbo*s6*c5*((u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)^2+(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)^2)+lbo^2*c4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))+la*lbo*(c4*c6+s4*s5*s6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-la*pzpp*s1*c2-la*pypp*(c1*c3+s1*s2*s3)-lbo*pzpp*c4*c5*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))-lbo*pxpp*c4*c5*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))-la^2*u1*u2-la*lbo*c4*c5*(c4*c6+s4*s5*s6)*u1*u2-la*lbo*s4*c5*(s4*c6-s5*s6*c4)*u1*u2-la*lbo*s4*c5*(s4*s6+s5*c4*c6)*(u2^2+u3^2)-la*lbo*c4*c5*(s6*c4-s4*s5*c6)*(u2^2+u3^2)-lbo^2*s4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))-la*lbo*(s4*c6-s5*s6*c4)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[4] = izb*u5*u6 + izb*s4*c5*u3*u6 + izb*c4*c5*u3*u5 + izb*s4*c4*c5^2*u3^2 + izb*(s4*s6+s5*c4*c6)*u1*u5 + izb*(c4*c6+s4*s5*s6)*u2*u6 + iyb*(s4*c6-s5*s6*c4)*u2*u5 + iyb*(s6*c4-s4*s5*c6)*u1*u6 + izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3 + izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3 + iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3 + iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3 + izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2 + iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2 + iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2 + izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2 - iyb*u5*u6 - iyb*s4*c5*u3*u6 - iyb*c4*c5*u3*u5 - iyb*s4*c4*c5^2*u3^2 - iyb*(s4*s6+s5*c4*c6)*u1*u5 - iyb*(c4*c6+s4*s5*s6)*u2*u6 - izb*(s4*c6-s5*s6*c4)*u2*u5 - izb*(s6*c4-s4*s5*c6)*u1*u6 - iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3 - iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3 - izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3 - izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3 - iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2 - izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2 - izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2 - iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2 - ixb*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1))
# rhs[5] = g*lbo*mb*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4)) + ixb*u4*u6 + izb*s5*u3*u6 + ixb*s6*c5*u2*u6 + ixb*c4*c5*u3*u4 + ixb*c5*c6*u1*u6 + izb*s5*c4*c5*u3^2 + ixb*s6*c4*c5^2*u2*u3 + ixb*c4*c6*c5^2*u1*u3 + ixb*(s4*s6+s5*c4*c6)*u1*u4 + izb*(s4*c6-s5*s6*c4)*u2*u4 + izb*s5*(s4*s6+s5*c4*c6)*u1*u3 + ixb*s5*(s4*c6-s5*s6*c4)*u2*u3 + ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2 + ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2 + izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2 + izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2 + iyb*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) - izb*u4*u6 - ixb*s5*u3*u6 - izb*s6*c5*u2*u6 - izb*c4*c5*u3*u4 - izb*c5*c6*u1*u6 - ixb*s5*c4*c5*u3^2 - izb*s6*c4*c5^2*u2*u3 - izb*c4*c6*c5^2*u1*u3 - izb*(s4*s6+s5*c4*c6)*u1*u4 - ixb*(s4*c6-s5*s6*c4)*u2*u4 - ixb*s5*(s4*s6+s5*c4*c6)*u1*u3 - izb*s5*(s4*c6-s5*s6*c4)*u2*u3 - izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2 - izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2 - ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2 - ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2 - lbo*mb*(pzpp*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+pxpp*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+pypp*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*c4*c5*u1*u3-la*(s4*c6-s5*s6*c4)*u1*u2-la*(s4*s6+s5*c4*c6)*(u2^2+u3^2)-lbo*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[6] = iyb*u4*u5 + ixb*s5*u3*u5 + iyb*s4*c5*u3*u4 + iyb*s6*c5*u2*u5 + iyb*c5*c6*u1*u5 + ixb*s4*s5*c5*u3^2 + iyb*s4*s6*c5^2*u2*u3 + iyb*s4*c6*c5^2*u1*u3 + iyb*(c4*c6+s4*s5*s6)*u2*u4 + ixb*(s6*c4-s4*s5*c6)*u1*u4 + ixb*s5*(c4*c6+s4*s5*s6)*u2*u3 + iyb*s5*(s6*c4-s4*s5*c6)*u1*u3 + iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2 + iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2 + ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2 + ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2 + lbo*mb*(pzpp*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+pxpp*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+la*s4*c5*u1*u3+la*(c4*c6+s4*s5*s6)*u1*u2+la*(s6*c4-s4*s5*c6)*(u2^2+u3^2)-pypp*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-lbo*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))) - g*lbo*mb*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6)) - ixb*u4*u5 - iyb*s5*u3*u5 - ixb*s4*c5*u3*u4 - ixb*s6*c5*u2*u5 - ixb*c5*c6*u1*u5 - iyb*s4*s5*c5*u3^2 - ixb*s4*s6*c5^2*u2*u3 - ixb*s4*c6*c5^2*u1*u3 - ixb*(c4*c6+s4*s5*s6)*u2*u4 - iyb*(s6*c4-s4*s5*c6)*u1*u4 - iyb*s5*(c4*c6+s4*s5*s6)*u2*u3 - ixb*s5*(s6*c4-s4*s5*c6)*u1*u3 - ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2 - ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2 - iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2 - iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2 - izb*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1))



# ## torques
# coef[1,1] = -ixa - ixb*c5^2*c6^2 - izb*(s4*s6+s5*c4*c6)^2 - iyb*(s6*c4-s4*s5*c6)^2 - mb*lbo^2*((s4*s6+s5*c4*c6)^2+(s6*c4-s4*s5*c6)^2)
# coef[1,2] = iyb*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6) + izb*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5*(s4*s6+s5*c4*c6)+la*c4*c5*(s6*c4-s4*s5*c6)+lbo*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4)+lbo*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6)) - ixb*s6*c6*c5^2
# coef[1,3] = ixb*s5*c5*c6 + iyb*s4*c5*(s6*c4-s4*s5*c6) - izb*c4*c5*(s4*s6+s5*c4*c6) - lbo*mb*(lbo*c4*c5*(s4*s6+s5*c4*c6)+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)-lbo*s4*c5*(s6*c4-s4*s5*c6)-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6))
# coef[1,4] = -ixb*c5*c6
# coef[1,5] = (iyb+mb*lbo^2)*(s6*c4-s4*s5*c6)
# coef[1,6] = -(izb+mb*lbo^2)*(s4*s6+s5*c4*c6)
# coef[2,1] = iyb*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6) + izb*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5*(s4*s6+s5*c4*c6)+la*c4*c5*(s6*c4-s4*s5*c6)+lbo*(s4*s6+s5*c4*c6)*(s4*c6-s5*s6*c4)+lbo*(c4*c6+s4*s5*s6)*(s6*c4-s4*s5*c6)) - ixb*s6*c6*c5^2
# coef[2,2] = -iya - ma*lao^2 - ixb*s6^2*c5^2 - iyb*(c4*c6+s4*s5*s6)^2 - izb*(s4*c6-s5*s6*c4)^2 - mb*(la^2+lbo^2*(c4*c6+s4*s5*s6)^2+lbo^2*(s4*c6-s5*s6*c4)^2+2*la*lbo*c4*c5*(c4*c6+s4*s5*s6)+2*la*lbo*s4*c5*(s4*c6-s5*s6*c4))
# coef[2,3] = c5*(ixb*s5*s6+izb*c4*(s4*c6-s5*s6*c4)-iyb*s4*(c4*c6+s4*s5*s6)-mb*lbo^2*(s4*(c4*c6+s4*s5*s6)-c4*(s4*c6-s5*s6*c4)))
# coef[2,4] = -ixb*s6*c5
# coef[2,5] = -iyb*(c4*c6+s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6+s4*s5*s6))
# coef[2,6] = izb*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5+lbo*(s4*c6-s5*s6*c4))
# coef[3,1] = ixb*s5*c5*c6 + iyb*s4*c5*(s6*c4-s4*s5*c6) - izb*c4*c5*(s4*s6+s5*c4*c6) - lbo*mb*(lbo*c4*c5*(s4*s6+s5*c4*c6)+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)-lbo*s4*c5*(s6*c4-s4*s5*c6)-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6))
# coef[3,2] = c5*(ixb*s5*s6+izb*c4*(s4*c6-s5*s6*c4)-iyb*s4*(c4*c6+s4*s5*s6)-mb*lbo^2*(s4*(c4*c6+s4*s5*s6)-c4*(s4*c6-s5*s6*c4)))
# coef[3,3] = -iza - ma*lao^2 - ixb*s5^2 - iyb*s4^2*c5^2 - izb*c4^2*c5^2 - mb*(la^2+lbo^2*c5^2+2*la*lbo*c4*c5*(c4*c6+s4*s5*s6)+2*la*lbo*s4*c5*(s4*c6-s5*s6*c4))
# coef[3,4] = ixb*s5
# coef[3,5] = -iyb*s4*c5 - lbo*mb*(lbo*s4*c5+la*(s4*c6-s5*s6*c4))
# coef[3,6] = -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6+s4*s5*s6))
# coef[4,1] = -ixb*c5*c6
# coef[4,2] = -ixb*s6*c5
# coef[4,3] = ixb*s5
# coef[4,4] = -ixb
# coef[4,5] = 0
# coef[4,6] = 0
# coef[5,1] = (iyb+mb*lbo^2)*(s6*c4-s4*s5*c6)
# coef[5,2] = -iyb*(c4*c6+s4*s5*s6) - lbo*mb*(la*c4*c5+lbo*(c4*c6+s4*s5*s6))
# coef[5,3] = -iyb*s4*c5 - lbo*mb*(lbo*s4*c5+la*(s4*c6-s5*s6*c4))
# coef[5,4] = 0
# coef[5,5] = -iyb - mb*lbo^2
# coef[5,6] = 0
# coef[6,1] = -(izb+mb*lbo^2)*(s4*s6+s5*c4*c6)
# coef[6,2] = izb*(s4*c6-s5*s6*c4) + lbo*mb*(la*s4*c5+lbo*(s4*c6-s5*s6*c4))
# coef[6,3] = -izb*c4*c5 - lbo*mb*(lbo*c4*c5+la*(c4*c6+s4*s5*s6))
# coef[6,4] = 0
# coef[6,5] = 0
# coef[6,6] = -izb - mb*lbo^2
# rhs[1] = ka*q1 + ba*u1 + (s4*s6+s5*c4*c6)*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) + (s6*c4-s4*s5*c6)*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) + lbo*mb*(pzpp*(s4*s6+s5*c4*c6)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+pzpp*(s6*c4-s4*s5*c6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+pxpp*(s6*c4-s4*s5*c6)*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+pxpp*(s4*s6+s5*c4*c6)*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+pypp*(s6*c4-s4*s5*c6)*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+la*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+la*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-pypp*(s4*s6+s5*c4*c6)*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-la*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-lbo*(s4*s6+s5*c4*c6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo*(s6*c4-s4*s5*c6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))) - g*lbo*mb*((s4*s6+s5*c4*c6)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+(s6*c4-s4*s5*c6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) - (iya-iza)*u2*u3 - izb*(s4*s6+s5*c4*c6)*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - iyb*(s6*c4-s4*s5*c6)*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) - ixb*c5*c6*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - c5*c6*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2)
# rhs[2] = ka*q2 + g*lao*ma*c1*c2 + g*mb*(la*c1*c2+lbo*(s4*c6-s5*s6*c4)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+lbo*(c4*c6+s4*s5*s6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) + ba*u2 + (ixa-iza)*u1*u3 + lao*ma*(pypp*(s1*c3-s2*s3*c1)-pzpp*c1*c2-pxpp*(s1*s3+s2*c1*c3)-lao*u1*u3) + iyb*(c4*c6+s4*s5*s6)*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) + izb*(s4*c6-s5*s6*c4)*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - ixb*s6*c5*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - (c4*c6+s4*s5*s6)*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) - (s4*c6-s5*s6*c4)*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) - s6*c5*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2) - mb*(la*pzpp*c1*c2+la*pxpp*(s1*s3+s2*c1*c3)+lbo*pzpp*(s4*c6-s5*s6*c4)*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+lbo*pzpp*(c4*c6+s4*s5*s6)*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+lbo*pxpp*(c4*c6+s4*s5*s6)*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+lbo*pypp*(c4*c6+s4*s5*s6)*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+lbo*pxpp*(s4*c6-s5*s6*c4)*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+la^2*u1*u3+la*lbo*c4*c5*(c4*c6+s4*s5*s6)*u1*u3+la*lbo*s4*c5*(s4*c6-s5*s6*c4)*u1*u3+la*lbo*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*(u2^2+u3^2)+la*lbo*s5*((u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)^2+(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)^2)-la*pypp*(s1*c3-s2*s3*c1)-lbo*pypp*(s4*c6-s5*s6*c4)*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-la*lbo*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*(u2^2+u3^2)-la*lbo*s4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-la*lbo*c4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))-lbo^2*(s4*c6-s5*s6*c4)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-lbo^2*(c4*c6+s4*s5*s6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[3] = ka*q3 + ba*u3 + iyb*s4*c5*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) + ixb*s5*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) + c4*c5*(iyb*u4*u5+ixb*s5*u3*u5+iyb*s4*c5*u3*u4+iyb*s6*c5*u2*u5+iyb*c5*c6*u1*u5+ixb*s4*s5*c5*u3^2+iyb*s4*s6*c5^2*u2*u3+iyb*s4*c6*c5^2*u1*u3+iyb*(c4*c6+s4*s5*s6)*u2*u4+ixb*(s6*c4-s4*s5*c6)*u1*u4+ixb*s5*(c4*c6+s4*s5*s6)*u2*u3+iyb*s5*(s6*c4-s4*s5*c6)*u1*u3+iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2+iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2+ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2+ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2-ixb*u4*u5-iyb*s5*u3*u5-ixb*s4*c5*u3*u4-ixb*s6*c5*u2*u5-ixb*c5*c6*u1*u5-iyb*s4*s5*c5*u3^2-ixb*s4*s6*c5^2*u2*u3-ixb*s4*c6*c5^2*u1*u3-ixb*(c4*c6+s4*s5*s6)*u2*u4-iyb*(s6*c4-s4*s5*c6)*u1*u4-iyb*s5*(c4*c6+s4*s5*s6)*u2*u3-ixb*s5*(s6*c4-s4*s5*c6)*u1*u3-ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2-ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2-iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2-iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2) + s5*(iyb*u5*u6+iyb*s4*c5*u3*u6+iyb*c4*c5*u3*u5+iyb*s4*c4*c5^2*u3^2+iyb*(s4*s6+s5*c4*c6)*u1*u5+iyb*(c4*c6+s4*s5*s6)*u2*u6+izb*(s4*c6-s5*s6*c4)*u2*u5+izb*(s6*c4-s4*s5*c6)*u1*u6+iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3+iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3+izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3+izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3+iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2+izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2+izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2+iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2-izb*u5*u6-izb*s4*c5*u3*u6-izb*c4*c5*u3*u5-izb*s4*c4*c5^2*u3^2-izb*(s4*s6+s5*c4*c6)*u1*u5-izb*(c4*c6+s4*s5*s6)*u2*u6-iyb*(s4*c6-s5*s6*c4)*u2*u5-iyb*(s6*c4-s4*s5*c6)*u1*u6-izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3-izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3-iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3-iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3-izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2-iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2-iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2-izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2) - g*lao*ma*s1*c2 - g*mb*(la*s1*c2+lbo*c4*c5*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))-lbo*s4*c5*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))) - (ixa-iya)*u1*u2 - lao*ma*(pxpp*(s3*c1-s1*s2*c3)-pzpp*s1*c2-pypp*(c1*c3+s1*s2*s3)-lao*u1*u2) - izb*c4*c5*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)) - s4*c5*(izb*u4*u6+ixb*s5*u3*u6+izb*s6*c5*u2*u6+izb*c4*c5*u3*u4+izb*c5*c6*u1*u6+ixb*s5*c4*c5*u3^2+izb*s6*c4*c5^2*u2*u3+izb*c4*c6*c5^2*u1*u3+izb*(s4*s6+s5*c4*c6)*u1*u4+ixb*(s4*c6-s5*s6*c4)*u2*u4+ixb*s5*(s4*s6+s5*c4*c6)*u1*u3+izb*s5*(s4*c6-s5*s6*c4)*u2*u3+izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2+izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2+ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2+ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2-ixb*u4*u6-izb*s5*u3*u6-ixb*s6*c5*u2*u6-ixb*c4*c5*u3*u4-ixb*c5*c6*u1*u6-izb*s5*c4*c5*u3^2-ixb*s6*c4*c5^2*u2*u3-ixb*c4*c6*c5^2*u1*u3-ixb*(s4*s6+s5*c4*c6)*u1*u4-izb*(s4*c6-s5*s6*c4)*u2*u4-izb*s5*(s4*s6+s5*c4*c6)*u1*u3-ixb*s5*(s4*c6-s5*s6*c4)*u2*u3-ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2-ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2-izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2-izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2) - mb*(la*pxpp*(s3*c1-s1*s2*c3)+lbo*pzpp*s4*c5*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+lbo*pxpp*s4*c5*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+lbo*pypp*c4*c5*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))+lbo*pypp*s4*c5*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*lbo*s6*c5*((u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)^2+(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)^2)+lbo^2*c4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))+la*lbo*(c4*c6+s4*s5*s6)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))-la*pzpp*s1*c2-la*pypp*(c1*c3+s1*s2*s3)-lbo*pzpp*c4*c5*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))-lbo*pxpp*c4*c5*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))-la^2*u1*u2-la*lbo*c4*c5*(c4*c6+s4*s5*s6)*u1*u2-la*lbo*s4*c5*(s4*c6-s5*s6*c4)*u1*u2-la*lbo*s4*c5*(s4*s6+s5*c4*c6)*(u2^2+u3^2)-la*lbo*c4*c5*(s6*c4-s4*s5*c6)*(u2^2+u3^2)-lbo^2*s4*c5*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p))-la*lbo*(s4*c6-s5*s6*c4)*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[4] = kb*q4 + bb*u4 + izb*u5*u6 + izb*s4*c5*u3*u6 + izb*c4*c5*u3*u5 + izb*s4*c4*c5^2*u3^2 + izb*(s4*s6+s5*c4*c6)*u1*u5 + izb*(c4*c6+s4*s5*s6)*u2*u6 + iyb*(s4*c6-s5*s6*c4)*u2*u5 + iyb*(s6*c4-s4*s5*c6)*u1*u6 + izb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3 + izb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3 + iyb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3 + iyb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3 + izb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2 + iyb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2 + iyb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2 + izb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2 - iyb*u5*u6 - iyb*s4*c5*u3*u6 - iyb*c4*c5*u3*u5 - iyb*s4*c4*c5^2*u3^2 - iyb*(s4*s6+s5*c4*c6)*u1*u5 - iyb*(c4*c6+s4*s5*s6)*u2*u6 - izb*(s4*c6-s5*s6*c4)*u2*u5 - izb*(s6*c4-s4*s5*c6)*u1*u6 - iyb*s4*c5*(s4*s6+s5*c4*c6)*u1*u3 - iyb*c4*c5*(c4*c6+s4*s5*s6)*u2*u3 - izb*s4*c5*(s4*c6-s5*s6*c4)*u2*u3 - izb*c4*c5*(s6*c4-s4*s5*c6)*u1*u3 - iyb*(s4*s6+s5*c4*c6)*(c4*c6+s4*s5*s6)*u1*u2 - izb*(s4*s6+s5*c4*c6)*(s6*c4-s4*s5*c6)*u1^2 - izb*(c4*c6+s4*s5*s6)*(s4*c6-s5*s6*c4)*u2^2 - iyb*(s4*c6-s5*s6*c4)*(s6*c4-s4*s5*c6)*u1*u2 - ixb*(u5*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)-u6*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1))
# rhs[5] = kb*q5 + g*lbo*mb*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4)) + bb*u5 + ixb*u4*u6 + izb*s5*u3*u6 + ixb*s6*c5*u2*u6 + ixb*c4*c5*u3*u4 + ixb*c5*c6*u1*u6 + izb*s5*c4*c5*u3^2 + ixb*s6*c4*c5^2*u2*u3 + ixb*c4*c6*c5^2*u1*u3 + ixb*(s4*s6+s5*c4*c6)*u1*u4 + izb*(s4*c6-s5*s6*c4)*u2*u4 + izb*s5*(s4*s6+s5*c4*c6)*u1*u3 + ixb*s5*(s4*c6-s5*s6*c4)*u2*u3 + ixb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2 + ixb*c5*c6*(s4*s6+s5*c4*c6)*u1^2 + izb*s6*c5*(s4*c6-s5*s6*c4)*u2^2 + izb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2 + iyb*(u6*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)) - izb*u4*u6 - ixb*s5*u3*u6 - izb*s6*c5*u2*u6 - izb*c4*c5*u3*u4 - izb*c5*c6*u1*u6 - ixb*s5*c4*c5*u3^2 - izb*s6*c4*c5^2*u2*u3 - izb*c4*c6*c5^2*u1*u3 - izb*(s4*s6+s5*c4*c6)*u1*u4 - ixb*(s4*c6-s5*s6*c4)*u2*u4 - ixb*s5*(s4*s6+s5*c4*c6)*u1*u3 - izb*s5*(s4*c6-s5*s6*c4)*u2*u3 - izb*s6*c5*(s4*s6+s5*c4*c6)*u1*u2 - izb*c5*c6*(s4*s6+s5*c4*c6)*u1^2 - ixb*s6*c5*(s4*c6-s5*s6*c4)*u2^2 - ixb*c5*c6*(s4*c6-s5*s6*c4)*u1*u2 - lbo*mb*(pzpp*(c1*c2*c4*c5-s2*(s4*s6+s5*c4*c6)-s1*c2*(s4*c6-s5*s6*c4))+pxpp*(c2*c3*(s4*s6+s5*c4*c6)+c4*c5*(s1*s3+s2*c1*c3)+(s3*c1-s1*s2*c3)*(s4*c6-s5*s6*c4))+pypp*(s3*c2*(s4*s6+s5*c4*c6)-c4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(s4*c6-s5*s6*c4))+la*c4*c5*u1*u3-la*(s4*c6-s5*s6*c4)*u1*u2-la*(s4*s6+s5*c4*c6)*(u2^2+u3^2)-lbo*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u6+c4*c5*u3+(s4*s6+s5*c4*c6)*u1-(s4*c6-s5*s6*c4)*u2)+c4*c5*u3*q4p-s4*s5*u3*q5p-u1*(c4*c6*q6p+s4*s5*s6*q6p-s4*s6*q4p-s4*c5*c6*q5p-s5*c4*c6*q4p)-u2*(s4*c6*q4p+s6*c4*q6p-s4*s5*c6*q6p-s4*s6*c5*q5p-s5*s6*c4*q4p)))
# rhs[6] = kb*q6 + bb*u6 + iyb*u4*u5 + ixb*s5*u3*u5 + iyb*s4*c5*u3*u4 + iyb*s6*c5*u2*u5 + iyb*c5*c6*u1*u5 + ixb*s4*s5*c5*u3^2 + iyb*s4*s6*c5^2*u2*u3 + iyb*s4*c6*c5^2*u1*u3 + iyb*(c4*c6+s4*s5*s6)*u2*u4 + ixb*(s6*c4-s4*s5*c6)*u1*u4 + ixb*s5*(c4*c6+s4*s5*s6)*u2*u3 + iyb*s5*(s6*c4-s4*s5*c6)*u1*u3 + iyb*s6*c5*(c4*c6+s4*s5*s6)*u2^2 + iyb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2 + ixb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2 + ixb*c5*c6*(s6*c4-s4*s5*c6)*u1^2 + lbo*mb*(pzpp*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6))+pxpp*(s4*c5*(s1*s3+s2*c1*c3)-c2*c3*(s6*c4-s4*s5*c6)-(c4*c6+s4*s5*s6)*(s3*c1-s1*s2*c3))+la*s4*c5*u1*u3+la*(c4*c6+s4*s5*s6)*u1*u2+la*(s6*c4-s4*s5*c6)*(u2^2+u3^2)-pypp*(s3*c2*(s6*c4-s4*s5*c6)+s4*c5*(s1*c3-s2*s3*c1)-(c1*c3+s1*s2*s3)*(c4*c6+s4*s5*s6))-lbo*((s5*u3-u4-s6*c5*u2-c5*c6*u1)*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1)+s4*c5*u3*q4p+s5*c4*u3*q5p+u1*(s4*s5*c6*q4p+s5*s6*c4*q6p-s4*c6*q6p-s6*c4*q4p-c4*c5*c6*q5p)+u2*(c4*c6*q4p+s4*s5*s6*q4p-s4*s6*q6p-s5*c4*c6*q6p-s6*c4*c5*q5p))) - g*lbo*mb*(s4*c1*c2*c5+s2*(s6*c4-s4*s5*c6)+s1*c2*(c4*c6+s4*s5*s6)) - ixb*u4*u5 - iyb*s5*u3*u5 - ixb*s4*c5*u3*u4 - ixb*s6*c5*u2*u5 - ixb*c5*c6*u1*u5 - iyb*s4*s5*c5*u3^2 - ixb*s4*s6*c5^2*u2*u3 - ixb*s4*c6*c5^2*u1*u3 - ixb*(c4*c6+s4*s5*s6)*u2*u4 - iyb*(s6*c4-s4*s5*c6)*u1*u4 - iyb*s5*(c4*c6+s4*s5*s6)*u2*u3 - ixb*s5*(s6*c4-s4*s5*c6)*u1*u3 - ixb*s6*c5*(c4*c6+s4*s5*s6)*u2^2 - ixb*c5*c6*(c4*c6+s4*s5*s6)*u1*u2 - iyb*s6*c5*(s6*c4-s4*s5*c6)*u1*u2 - iyb*c5*c6*(s6*c4-s4*s5*c6)*u1^2 - izb*(u5*(s5*u3-u4-s6*c5*u2-c5*c6*u1)+u4*(u5+s4*c5*u3+(c4*c6+s4*s5*s6)*u2-(s6*c4-s4*s5*c6)*u1))

