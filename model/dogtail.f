C**   The name of this program is dogtail.f
C**   Created by AUTOLEV 3.2 on Sat Jul 10 17:40:40 2021

      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          ILOOP, IPRINT, PRINTINT
      CHARACTER        MESSAGE(99)
      EXTERNAL         EQNS1
      DIMENSION        VAR(12)
      COMMON/CONSTNTS/ BA,BB,EQX,EQY,EQZ,G,IXA,IXB,IYA,IYB,IZA,IZB,KA,KB
     &,LA,LAO,LB,LBO,MA,MB
      COMMON/SPECFIED/ PX,PY,PZ,PXp,PYp,PZp,PXpp,PYpp,PZpp
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,U1,U2,U3,U4,U5,U6
      COMMON/ALGBRAIC/ Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,U1p,U2p,U3p,U4p,U5p,U6p,A
     &MOMX,AMOMY,AMOMZ,KE,P1X,P1Y,P1Z,P2X,P2Y,P2Z,P3X,P3Y,P3Z,PE,TE
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(6,6),RHS(6)

C**   Open input and output files
      OPEN(UNIT=20, FILE='dogtail.in', STATUS='OLD')
      OPEN(UNIT=21, FILE='dogtail.1',  STATUS='UNKNOWN')
      OPEN(UNIT=22, FILE='dogtail.2',  STATUS='UNKNOWN')

C**   Read message from input file
      READ(20,7000,END=7100,ERR=7101) (MESSAGE(ILOOP),ILOOP = 1,99)

C**   Read values of constants from input file
      READ(20,7010,END=7100,ERR=7101) BA,BB,EQX,EQY,EQZ,G,IXA,IXB,IYA,IY
     &B,IZA,IZB,KA,KB,LA,LAO,LB,LBO,MA,MB

C**   Read the initial value of each variable from input file
      READ(20,7010,END=7100,ERR=7101) Q1,Q2,Q3,Q4,Q5,Q6,U1,U2,U3,U4,U5,U
     &6

C**   Read integration parameters from input file
      READ(20,7011,END=7100,ERR=7101) TINITIAL,TFINAL,INTEGSTP,PRINTINT,
     &ABSERR,RELERR

C**   Write heading(s) to output file(s)
      WRITE(*, 6021) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(21,6021) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(22,6022) (MESSAGE(ILOOP), ILOOP = 1,99) 

C**   Degree to radian conversion
      PI       = 4*ATAN(1.0D0)
      DEGtoRAD = PI/180.0D0
      RADtoDEG = 180.0D0/PI

C**   Evaluate constants
C**   Initialize time, print counter, variables array for integrator
      T      = TINITIAL
      IPRINT = 0
      VAR(1) = Q1
      VAR(2) = Q2
      VAR(3) = Q3
      VAR(4) = Q4
      VAR(5) = Q5
      VAR(6) = Q6
      VAR(7) = U1
      VAR(8) = U2
      VAR(9) = U3
      VAR(10) = U4
      VAR(11) = U5
      VAR(12) = U6

C**   Initalize numerical integrator with call to EQNS1 at T=TINITIAL
      CALL KUTTA(EQNS1, 12, VAR, T, INTEGSTP, ABSERR, RELERR, 0, *5920)

C**   Numerically integrate; print results
5900  IF( TFINAL.GE.TINITIAL .AND. T+.01D0*INTEGSTP.GE.TFINAL) IPRINT=-7
      IF( TFINAL.LE.TINITIAL .AND. T+.01D0*INTEGSTP.LE.TFINAL) IPRINT=-7
      IF( IPRINT .LE. 0 ) THEN
        CALL IO(T)
        IF( IPRINT .EQ. -7 ) GOTO 5930
        IPRINT = PRINTINT
      ENDIF
      CALL KUTTA(EQNS1, 12, VAR, T, INTEGSTP, ABSERR, RELERR, 1, *5920)
      IPRINT = IPRINT - 1
      GOTO 5900

C**   Print message if numerical integration fails to converge
5920  CALL IO(T)
      WRITE(*, 6997)
      WRITE(21,6997)
      WRITE(22,6997)

C**   Inform user of input and output filename(s)
5930  WRITE(*,6999)

6021  FORMAT(1X,'FILE: dogtail.1 ',//1X,'*** ',99A1,///,8X,'T',13X,'P1X'
     &,12X,'P1Y',12X,'P1Z',12X,'P2X',12X,'P2Y',12X,'P2Z',12X,'P3X',12X,'
     &P3Y',12X,'P3Z',/,5X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS
     &)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)
     &',8X,'(UNITS)',/)
6022  FORMAT(1X,'FILE: dogtail.2 ',//1X,'*** ',99A1,///,8X,'T',13X,'KE',
     &13X,'PE',13X,'TE',12X,'AMOMX',10X,'AMOMY',10X,'AMOMZ',/,5X,'(UNITS
     &)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)
     &',8X,'(UNITS)',/)
6997  FORMAT(/7X,'Error: Numerical integration failed to converge',/)
6999  FORMAT(//1X,'Input is in the file dogtail.in',//1X,'Output is in t
     &he file(s) dogtail.i  (i=1,2)',//1X,'The output quantities and ass
     &ociated files are listed in file dogtail.dir',/)
7000  FORMAT(//,99A1,///)
7010  FORMAT( 1000(59X,E30.0,/) )
7011  FORMAT( 3(59X,E30.0,/), 1(59X,I30,/), 2(59X,E30.0,/) )
      STOP
7100  WRITE(*,*) 'Premature end of file while reading dogtail.in '
7101  WRITE(*,*) 'Error while reading file dogtail.in'
      STOP
      END


C**********************************************************************
      SUBROUTINE       EQNS1(T, VAR, VARp, BOUNDARY)
      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          BOUNDARY
      DIMENSION        VAR(*), VARp(*)
      COMMON/CONSTNTS/ BA,BB,EQX,EQY,EQZ,G,IXA,IXB,IYA,IYB,IZA,IZB,KA,KB
     &,LA,LAO,LB,LBO,MA,MB
      COMMON/SPECFIED/ PX,PY,PZ,PXp,PYp,PZp,PXpp,PYpp,PZpp
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,U1,U2,U3,U4,U5,U6
      COMMON/ALGBRAIC/ Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,U1p,U2p,U3p,U4p,U5p,U6p,A
     &MOMX,AMOMY,AMOMZ,KE,P1X,P1Y,P1Z,P2X,P2Y,P2Z,P3X,P3Y,P3Z,PE,TE
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(6,6),RHS(6)

C**   Update variables after integration step
      Q1 = VAR(1)
      Q2 = VAR(2)
      Q3 = VAR(3)
      Q4 = VAR(4)
      Q5 = VAR(5)
      Q6 = VAR(6)
      U1 = VAR(7)
      U2 = VAR(8)
      U3 = VAR(9)
      U4 = VAR(10)
      U5 = VAR(11)
      U6 = VAR(12)

      Q1p = -(SIN(Q3)*U2-COS(Q3)*U1)/COS(Q2)
      Q2p = SIN(Q3)*U1 + COS(Q3)*U2
      Q3p = U3 + TAN(Q2)*(SIN(Q3)*U2-COS(Q3)*U1)
      Q4p = -(SIN(Q6)*U5-COS(Q6)*U4)/COS(Q5)
      Q5p = SIN(Q6)*U4 + COS(Q6)*U5
      Q6p = U6 + TAN(Q5)*(SIN(Q6)*U5-COS(Q6)*U4)

C**   Quantities to be specified
      PX = 0
      PY = 0
      PZ = 0
      PXp = 0
      PYp = 0
      PZp = 0
      PXpp = 0
      PYpp = 0
      PZpp = 0

      COEF(1,1) = -IXA - IZB*SIN(Q5)**2 - IXB*COS(Q5)**2*COS(Q6)**2 - IY
     &B*SIN(Q6)**2*COS(Q5)**2 - MB*LBO**2*(SIN(Q5)**2+SIN(Q6)**2*COS(Q5)
     &**2)
      COEF(1,2) = IZB*SIN(Q4)*SIN(Q5)*COS(Q5) + IYB*SIN(Q6)*COS(Q5)*(COS
     &(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)) + LBO*MB*(LBO*SIN(Q4)*SIN(Q5
     &)*COS(Q5)+LA*SIN(Q6)*COS(Q4)*COS(Q5)**2+LA*SIN(Q5)*(SIN(Q4)*COS(Q6
     &)+SIN(Q5)*SIN(Q6)*COS(Q4))+LBO*SIN(Q6)*COS(Q5)*(COS(Q4)*COS(Q6)-SI
     &N(Q4)*SIN(Q5)*SIN(Q6))) - IXB*COS(Q5)*COS(Q6)*(SIN(Q6)*COS(Q4)+SIN
     &(Q4)*SIN(Q5)*COS(Q6))
      COEF(1,3) = IYB*SIN(Q6)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*C
     &OS(Q4)) - IZB*SIN(Q5)*COS(Q4)*COS(Q5) - IXB*COS(Q5)*COS(Q6)*(SIN(Q
     &4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)) - LBO*MB*(LBO*SIN(Q5)*COS(Q4)*
     &COS(Q5)+LA*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))-LA*SI
     &N(Q4)*SIN(Q6)*COS(Q5)**2-LBO*SIN(Q6)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4)))
      COEF(1,4) = -IXB*COS(Q5)*COS(Q6)
      COEF(1,5) = (IYB+MB*LBO**2)*SIN(Q6)*COS(Q5)
      COEF(1,6) = -(IZB+MB*LBO**2)*SIN(Q5)
      COEF(2,1) = IZB*SIN(Q4)*SIN(Q5)*COS(Q5) + IYB*SIN(Q6)*COS(Q5)*(COS
     &(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)) + LBO*MB*(LBO*SIN(Q4)*SIN(Q5
     &)*COS(Q5)+LA*SIN(Q6)*COS(Q4)*COS(Q5)**2+LA*SIN(Q5)*(SIN(Q4)*COS(Q6
     &)+SIN(Q5)*SIN(Q6)*COS(Q4))+LBO*SIN(Q6)*COS(Q5)*(COS(Q4)*COS(Q6)-SI
     &N(Q4)*SIN(Q5)*SIN(Q6))) - IXB*COS(Q5)*COS(Q6)*(SIN(Q6)*COS(Q4)+SIN
     &(Q4)*SIN(Q5)*COS(Q6))
      COEF(2,2) = -IYA - MA*LAO**2 - IZB*SIN(Q4)**2*COS(Q5)**2 - IXB*(SI
     &N(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))**2 - IYB*(COS(Q4)*COS(Q6)-S
     &IN(Q4)*SIN(Q5)*SIN(Q6))**2 - MB*(LA**2+LBO**2*SIN(Q4)**2*COS(Q5)**
     &2+LBO**2*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))**2+2*LA*LBO*SIN
     &(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))+2*LA*LBO*CO
     &S(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))
      COEF(2,3) = IZB*SIN(Q4)*COS(Q4)*COS(Q5)**2 + MB*LBO**2*(SIN(Q4)*CO
     &S(Q4)*COS(Q5)**2-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(COS(Q4
     &)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))) - IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)
     &*SIN(Q5)*COS(Q6))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)) - IYB*
     &(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(COS(Q4)*COS(Q6)-SIN(Q4)
     &*SIN(Q5)*SIN(Q6))
      COEF(2,4) = -IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))
      COEF(2,5) = -IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)) - LBO*M
     &B*(LA*COS(Q4)*COS(Q5)+LBO*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)
     &))
      COEF(2,6) = IZB*SIN(Q4)*COS(Q5) + LBO*MB*(LBO*SIN(Q4)*COS(Q5)+LA*(
     &SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)))
      COEF(3,1) = IYB*SIN(Q6)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*C
     &OS(Q4)) - IZB*SIN(Q5)*COS(Q4)*COS(Q5) - IXB*COS(Q5)*COS(Q6)*(SIN(Q
     &4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)) - LBO*MB*(LBO*SIN(Q5)*COS(Q4)*
     &COS(Q5)+LA*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))-LA*SI
     &N(Q4)*SIN(Q6)*COS(Q5)**2-LBO*SIN(Q6)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4)))
      COEF(3,2) = IZB*SIN(Q4)*COS(Q4)*COS(Q5)**2 + MB*LBO**2*(SIN(Q4)*CO
     &S(Q4)*COS(Q5)**2-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(COS(Q4
     &)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))) - IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)
     &*SIN(Q5)*COS(Q6))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)) - IYB*
     &(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(COS(Q4)*COS(Q6)-SIN(Q4)
     &*SIN(Q5)*SIN(Q6))
      COEF(3,3) = -IZA - MA*LAO**2 - IZB*COS(Q4)**2*COS(Q5)**2 - IYB*(SI
     &N(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))**2 - IXB*(SIN(Q4)*SIN(Q6)-S
     &IN(Q5)*COS(Q4)*COS(Q6))**2 - MB*(LA**2+LBO**2*COS(Q4)**2*COS(Q5)**
     &2+LBO**2*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))**2+2*LA*LBO*SIN
     &(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))+2*LA*LBO*CO
     &S(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))
      COEF(3,4) = -IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))
      COEF(3,5) = -IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)) - LBO*M
     &B*(LA*SIN(Q4)*COS(Q5)+LBO*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)
     &))
      COEF(3,6) = -IZB*COS(Q4)*COS(Q5) - LBO*MB*(LBO*COS(Q4)*COS(Q5)+LA*
     &(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))
      COEF(4,1) = -IXB*COS(Q5)*COS(Q6)
      COEF(4,2) = -IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))
      COEF(4,3) = -IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))
      COEF(4,4) = -IXB
      COEF(4,5) = 0
      COEF(4,6) = 0
      COEF(5,1) = (IYB+MB*LBO**2)*SIN(Q6)*COS(Q5)
      COEF(5,2) = -IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)) - LBO*M
     &B*(LA*COS(Q4)*COS(Q5)+LBO*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)
     &))
      COEF(5,3) = -IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)) - LBO*M
     &B*(LA*SIN(Q4)*COS(Q5)+LBO*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)
     &))
      COEF(5,4) = 0
      COEF(5,5) = -IYB - MB*LBO**2
      COEF(5,6) = 0
      COEF(6,1) = -(IZB+MB*LBO**2)*SIN(Q5)
      COEF(6,2) = IZB*SIN(Q4)*COS(Q5) + LBO*MB*(LBO*SIN(Q4)*COS(Q5)+LA*(
     &SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4)))
      COEF(6,3) = -IZB*COS(Q4)*COS(Q5) - LBO*MB*(LBO*COS(Q4)*COS(Q5)+LA*
     &(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))
      COEF(6,4) = 0
      COEF(6,5) = 0
      COEF(6,6) = -IZB - MB*LBO**2
      RHS(1) = BA*U1 + IYB*SIN(Q6)*COS(Q5)*(U4*(SIN(Q4)*COS(Q5)*U2-U6-SI
     &N(Q5)*U1-COS(Q4)*COS(Q5)*U3)+U6*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*CO
     &S(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)
     &*COS(Q6))*U3)) + IXB*COS(Q5)*COS(Q6)*(U5*(SIN(Q4)*COS(Q5)*U2-U6-SI
     &N(Q5)*U1-COS(Q4)*COS(Q5)*U3)-U6*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*CO
     &S(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)
     &*SIN(Q6))*U2)) + IZB*SIN(Q5)*(U5*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*C
     &OS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4
     &)*COS(Q6))*U3)+U4*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2))
     & + LBO*MB*(PXpp*SIN(Q6)*COS(Q5)*(SIN(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*C
     &OS(Q2)*COS(Q3)+SIN(Q3)*SIN(Q4)*COS(Q2)*COS(Q5))+PXpp*SIN(Q5)*(SIN(
     &Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-SIN(Q6)*COS(Q2)*COS(
     &Q3)*COS(Q5)-SIN(Q3)*COS(Q2)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q
     &6)))+PZpp*SIN(Q6)*COS(Q5)*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)
     &*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1
     &)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)))+PYpp*SIN(Q6)*COS(Q5)*(SIN(Q5)*
     &(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-SIN(Q1)*COS(Q2)*COS(Q4)*
     &COS(Q5)-SIN(Q4)*COS(Q5)*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))
     &+LA*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3+LA*SIN(Q5)*(SIN(Q4)*COS(Q6)+S
     &IN(Q5)*SIN(Q6)*COS(Q4))*U1*U3+LA*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*
     &SIN(Q5)*SIN(Q6))*U1*U2+LBO*SIN(Q5)*(COS(Q5)*U1*Q5p+SIN(Q4)*SIN(Q5)
     &*U2*Q5p-(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*CO
     &S(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)*(SIN(Q6)*C
     &OS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)
     &*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)-SIN(Q4)*COS(Q5)*U3*Q4p-SIN(Q
     &5)*COS(Q4)*U3*Q5p-COS(Q4)*COS(Q5)*U2*Q4p)-PYpp*SIN(Q5)*(SIN(Q1)*CO
     &S(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))+SIN(Q6)*COS(Q5)*(S
     &IN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-(COS(Q1)*COS(Q3)-SIN(Q1)*S
     &IN(Q2)*SIN(Q3))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-PZpp*SI
     &N(Q5)*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-C
     &OS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)*
     &COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*
     &SIN(Q6)))-LA*SIN(Q4)*SIN(Q6)*COS(Q5)**2*U1*U2-LBO*SIN(Q6)*COS(Q5)*
     &((SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)*(U4+COS(Q5)
     &*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*
     &SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)+SIN(Q5)*SIN(Q6)*U1*Q5p-COS(Q5
     &)*COS(Q6)*U1*Q6p-U2*(SIN(Q4)*COS(Q6)*Q4p+SIN(Q6)*COS(Q4)*Q6p+SIN(Q
     &4)*SIN(Q5)*COS(Q6)*Q6p+SIN(Q4)*SIN(Q6)*COS(Q5)*Q5p+SIN(Q5)*SIN(Q6)
     &*COS(Q4)*Q4p)-U3*(SIN(Q4)*SIN(Q6)*Q6p+SIN(Q4)*SIN(Q5)*SIN(Q6)*Q4p-
     &COS(Q4)*COS(Q6)*Q4p-SIN(Q5)*COS(Q4)*COS(Q6)*Q6p-SIN(Q6)*COS(Q4)*CO
     &S(Q5)*Q5p))) - KA*(EQX-Q1) - G*LBO*MB*(SIN(Q6)*COS(Q5)*(COS(Q1)*CO
     &S(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS
     &(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)))-S
     &IN(Q5)*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-
     &COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)
     &*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)
     &*SIN(Q6)))) - (IYA-IZA)*U2*U3 - SIN(Q6)*COS(Q5)*(IXB*U4*U6+IXB*SIN
     &(Q5)*U1*U4+IXB*COS(Q4)*COS(Q5)*U3*U4+IXB*COS(Q5)*COS(Q6)*U1*U6+IZB
     &*SIN(Q4)*COS(Q5)*U2*U4+IXB*SIN(Q5)*COS(Q5)*COS(Q6)*U1**2+IXB*COS(Q
     &4)*COS(Q6)*COS(Q5)**2*U1*U3+IZB*SIN(Q4)*COS(Q6)*COS(Q5)**2*U1*U2+I
     &XB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6+IXB*(SIN(Q4)*SI
     &N(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U6+IXB*SIN(Q5)*(SIN(Q6)*COS(Q4)+
     &SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2+IXB*SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5
     &)*COS(Q4)*COS(Q6))*U1*U3+IXB*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(
     &Q4)*SIN(Q5)*COS(Q6))*U2*U3+IZB*SIN(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SI
     &N(Q4)*SIN(Q5)*COS(Q6))*U2**2+IXB*COS(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-
     &SIN(Q5)*COS(Q4)*COS(Q6))*U3**2+IZB*SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6
     &)-SIN(Q5)*COS(Q4)*COS(Q6))*U2*U3-IZB*U4*U6-IZB*SIN(Q5)*U1*U4-IXB*S
     &IN(Q4)*COS(Q5)*U2*U4-IZB*COS(Q4)*COS(Q5)*U3*U4-IZB*COS(Q5)*COS(Q6)
     &*U1*U6-IZB*SIN(Q5)*COS(Q5)*COS(Q6)*U1**2-IXB*SIN(Q4)*COS(Q6)*COS(Q
     &5)**2*U1*U2-IZB*COS(Q4)*COS(Q6)*COS(Q5)**2*U1*U3-IZB*(SIN(Q6)*COS(
     &Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6-IZB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*CO
     &S(Q4)*COS(Q6))*U3*U6-IZB*SIN(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*
     &COS(Q6))*U1*U2-IZB*SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6
     &))*U1*U3-IXB*SIN(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(
     &Q6))*U2**2-IZB*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*CO
     &S(Q6))*U2*U3-IXB*SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*
     &COS(Q6))*U2*U3-IZB*COS(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4
     &)*COS(Q6))*U3**2) - COS(Q5)*COS(Q6)*(IYB*U5*U6+IYB*SIN(Q5)*U1*U5+I
     &YB*COS(Q4)*COS(Q5)*U3*U5+IZB*SIN(Q4)*COS(Q5)*U2*U5+IZB*SIN(Q6)*COS
     &(Q5)*U1*U6+IZB*SIN(Q5)*SIN(Q6)*COS(Q5)*U1**2+IYB*SIN(Q4)*SIN(Q6)*C
     &OS(Q5)**2*U1*U2+IZB*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3+IYB*(SIN(Q4)*
     &COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6+IYB*(COS(Q4)*COS(Q6)-SIN(Q4
     &)*SIN(Q5)*SIN(Q6))*U2*U6+IYB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(
     &Q6)*COS(Q4))*U1*U3+IYB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SI
     &N(Q6))*U1*U2+IYB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*
     &COS(Q4))*U3**2+IZB*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6
     &)*COS(Q4))*U2*U3+IYB*COS(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(
     &Q5)*SIN(Q6))*U2*U3+IZB*SIN(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SI
     &N(Q5)*SIN(Q6))*U2**2-IZB*U5*U6-IZB*SIN(Q5)*U1*U5-IYB*SIN(Q4)*COS(Q
     &5)*U2*U5-IYB*SIN(Q6)*COS(Q5)*U1*U6-IZB*COS(Q4)*COS(Q5)*U3*U5-IYB*S
     &IN(Q5)*SIN(Q6)*COS(Q5)*U1**2-IYB*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3-
     &IZB*SIN(Q4)*SIN(Q6)*COS(Q5)**2*U1*U2-IZB*(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*U3*U6-IZB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6
     &))*U2*U6-IZB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*
     &U3-IZB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-IYB
     &*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U2*U3-I
     &ZB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3**2
     &-IYB*SIN(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*
     &*2-IZB*COS(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U
     &2*U3) - SIN(Q5)*(IXB*U4*U5+IXB*COS(Q5)*COS(Q6)*U1*U5+IYB*SIN(Q6)*C
     &OS(Q5)*U1*U4+IYB*SIN(Q6)*COS(Q6)*COS(Q5)**2*U1**2+IXB*(SIN(Q4)*COS
     &(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*S
     &IN(Q5)*COS(Q6))*U2*U5+IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)
     &)*U3*U5+IXB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U4+IXB*CO
     &S(Q5)*COS(Q6)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3+IYB*
     &SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2+IX
     &B*COS(Q5)*COS(Q6)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2+
     &IYB*SIN(Q6)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U
     &3+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q6)*COS(Q4)+S
     &IN(Q4)*SIN(Q5)*COS(Q6))*U2*U3+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)
     &*COS(Q4))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2+IXB*(SIN
     &(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN
     &(Q5)*SIN(Q6))*U2**2+IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*
     &(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3-IYB*U4*U5-IXB*SIN(
     &Q6)*COS(Q5)*U1*U4-IYB*COS(Q5)*COS(Q6)*U1*U5-IXB*SIN(Q6)*COS(Q6)*CO
     &S(Q5)**2*U1**2-IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4
     &-IYB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U5-IYB*(SIN(Q4)*
     &SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U5-IYB*(COS(Q4)*COS(Q6)-SIN(Q4
     &)*SIN(Q5)*SIN(Q6))*U2*U4-IXB*SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(
     &Q4)*SIN(Q5)*COS(Q6))*U1*U2-IYB*COS(Q5)*COS(Q6)*(SIN(Q4)*COS(Q6)+SI
     &N(Q5)*SIN(Q6)*COS(Q4))*U1*U3-IXB*SIN(Q6)*COS(Q5)*(SIN(Q4)*SIN(Q6)-
     &SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3-IYB*COS(Q5)*COS(Q6)*(COS(Q4)*COS(Q6
     &)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(
     &Q6)*COS(Q4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3-IYB*(
     &SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*
     &COS(Q4)*COS(Q6))*U3**2-IYB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6
     &))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2-IYB*(SIN(Q4)*SI
     &N(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SI
     &N(Q6))*U2*U3)
      RHS(2) = G*LAO*MA*COS(Q1)*COS(Q2) + G*MB*(LA*COS(Q1)*COS(Q2)+LBO*(
     &COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(COS(Q1)*COS(Q2)*COS(Q4)*
     &COS(Q5)+SIN(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*
     &COS(Q5)*(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)))-LBO*SIN(Q4)*COS
     &(Q5)*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-CO
     &S(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)*C
     &OS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*S
     &IN(Q6)))) + BA*U2 + (IXA-IZA)*U1*U3 + LAO*MA*(PYpp*SIN(Q1)*COS(Q2)
     &-PXpp*SIN(Q2)-PZpp*COS(Q1)*COS(Q2)-LAO*U1*U3) + IXB*(SIN(Q6)*COS(Q
     &4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(U5*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-
     &COS(Q4)*COS(Q5)*U3)-U6*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN
     &(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))
     &*U2)) + (COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(IXB*U4*U6+IXB*S
     &IN(Q5)*U1*U4+IXB*COS(Q4)*COS(Q5)*U3*U4+IXB*COS(Q5)*COS(Q6)*U1*U6+I
     &ZB*SIN(Q4)*COS(Q5)*U2*U4+IXB*SIN(Q5)*COS(Q5)*COS(Q6)*U1**2+IXB*COS
     &(Q4)*COS(Q6)*COS(Q5)**2*U1*U3+IZB*SIN(Q4)*COS(Q6)*COS(Q5)**2*U1*U2
     &+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6+IXB*(SIN(Q4)*
     &SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U6+IXB*SIN(Q5)*(SIN(Q6)*COS(Q4
     &)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2+IXB*SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(
     &Q5)*COS(Q4)*COS(Q6))*U1*U3+IXB*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SI
     &N(Q4)*SIN(Q5)*COS(Q6))*U2*U3+IZB*SIN(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+
     &SIN(Q4)*SIN(Q5)*COS(Q6))*U2**2+IXB*COS(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6
     &)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2+IZB*SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(
     &Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U2*U3-IZB*U4*U6-IZB*SIN(Q5)*U1*U4-IXB
     &*SIN(Q4)*COS(Q5)*U2*U4-IZB*COS(Q4)*COS(Q5)*U3*U4-IZB*COS(Q5)*COS(Q
     &6)*U1*U6-IZB*SIN(Q5)*COS(Q5)*COS(Q6)*U1**2-IXB*SIN(Q4)*COS(Q6)*COS
     &(Q5)**2*U1*U2-IZB*COS(Q4)*COS(Q6)*COS(Q5)**2*U1*U3-IZB*(SIN(Q6)*CO
     &S(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6-IZB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*
     &COS(Q4)*COS(Q6))*U3*U6-IZB*SIN(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5
     &)*COS(Q6))*U1*U2-IZB*SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(
     &Q6))*U1*U3-IXB*SIN(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*CO
     &S(Q6))*U2**2-IZB*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*
     &COS(Q6))*U2*U3-IXB*SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4
     &)*COS(Q6))*U2*U3-IZB*COS(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(
     &Q4)*COS(Q6))*U3**2) + SIN(Q4)*COS(Q5)*(IXB*U4*U5+IXB*COS(Q5)*COS(Q
     &6)*U1*U5+IYB*SIN(Q6)*COS(Q5)*U1*U4+IYB*SIN(Q6)*COS(Q6)*COS(Q5)**2*
     &U1**2+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4+IXB*(SIN
     &(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U5+IXB*(SIN(Q4)*SIN(Q6)-S
     &IN(Q5)*COS(Q4)*COS(Q6))*U3*U5+IXB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)
     &*SIN(Q6))*U2*U4+IXB*COS(Q5)*COS(Q6)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q
     &6)*COS(Q4))*U1*U3+IYB*SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN
     &(Q5)*COS(Q6))*U1*U2+IXB*COS(Q5)*COS(Q6)*(COS(Q4)*COS(Q6)-SIN(Q4)*S
     &IN(Q5)*SIN(Q6))*U1*U2+IYB*SIN(Q6)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)
     &*COS(Q4)*COS(Q6))*U1*U3+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q
     &4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3+IXB*(SIN(Q4)*C
     &OS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*C
     &OS(Q6))*U3**2+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(COS(Q
     &4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2+IXB*(SIN(Q4)*SIN(Q6)-SIN
     &(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2
     &*U3-IYB*U4*U5-IXB*SIN(Q6)*COS(Q5)*U1*U4-IYB*COS(Q5)*COS(Q6)*U1*U5-
     &IXB*SIN(Q6)*COS(Q6)*COS(Q5)**2*U1**2-IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*U3*U4-IYB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6
     &))*U2*U5-IYB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U5-IYB*(
     &COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U4-IXB*SIN(Q6)*COS(Q5)
     &*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2-IYB*COS(Q5)*COS(Q
     &6)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3-IXB*SIN(Q6)*COS
     &(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3-IYB*COS(Q5)*C
     &OS(Q6)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-IYB*(SIN(Q4
     &)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5
     &)*COS(Q6))*U2*U3-IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SI
     &N(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2-IYB*(SIN(Q6)*COS(Q4)+
     &SIN(Q4)*SIN(Q5)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))
     &*U2**2-IYB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3) - KA*(EQY-Q2) - IYB*(COS(Q4)*C
     &OS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(U4*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)
     &*U1-COS(Q4)*COS(Q5)*U3)+U6*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)
     &+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(
     &Q6))*U3)) - IZB*SIN(Q4)*COS(Q5)*(U5*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6
     &)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS
     &(Q4)*COS(Q6))*U3)+U4*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q
     &5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U
     &2)) - (SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(IYB*U5*U6+IYB*SIN
     &(Q5)*U1*U5+IYB*COS(Q4)*COS(Q5)*U3*U5+IZB*SIN(Q4)*COS(Q5)*U2*U5+IZB
     &*SIN(Q6)*COS(Q5)*U1*U6+IZB*SIN(Q5)*SIN(Q6)*COS(Q5)*U1**2+IYB*SIN(Q
     &4)*SIN(Q6)*COS(Q5)**2*U1*U2+IZB*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3+I
     &YB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6+IYB*(COS(Q4)*CO
     &S(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U6+IYB*SIN(Q5)*(SIN(Q4)*COS(Q6)+
     &SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3+IYB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4
     &)*SIN(Q5)*SIN(Q6))*U1*U2+IYB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U3**2+IZB*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SI
     &N(Q5)*SIN(Q6)*COS(Q4))*U2*U3+IYB*COS(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-
     &SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3+IZB*SIN(Q4)*COS(Q5)*(COS(Q4)*COS(Q6
     &)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2-IZB*U5*U6-IZB*SIN(Q5)*U1*U5-IYB*S
     &IN(Q4)*COS(Q5)*U2*U5-IYB*SIN(Q6)*COS(Q5)*U1*U6-IZB*COS(Q4)*COS(Q5)
     &*U3*U5-IYB*SIN(Q5)*SIN(Q6)*COS(Q5)*U1**2-IYB*SIN(Q6)*COS(Q4)*COS(Q
     &5)**2*U1*U3-IZB*SIN(Q4)*SIN(Q6)*COS(Q5)**2*U1*U2-IZB*(SIN(Q4)*COS(
     &Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6-IZB*(COS(Q4)*COS(Q6)-SIN(Q4)*SI
     &N(Q5)*SIN(Q6))*U2*U6-IZB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*
     &COS(Q4))*U1*U3-IZB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6
     &))*U1*U2-IYB*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(
     &Q4))*U2*U3-IZB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*CO
     &S(Q4))*U3**2-IYB*SIN(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*
     &SIN(Q6))*U2**2-IZB*COS(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5
     &)*SIN(Q6))*U2*U3) - MB*(LA*PXpp*SIN(Q2)+LA*PZpp*COS(Q1)*COS(Q2)+LB
     &O*PXpp*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(SIN(Q2)*COS(Q4)*
     &COS(Q5)+SIN(Q5)*COS(Q2)*COS(Q3)+SIN(Q3)*SIN(Q4)*COS(Q2)*COS(Q5))+L
     &BO*PXpp*SIN(Q4)*COS(Q5)*(SIN(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*
     &COS(Q4))-SIN(Q6)*COS(Q2)*COS(Q3)*COS(Q5)-SIN(Q3)*COS(Q2)*(COS(Q4)*
     &COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))+LBO*PZpp*(COS(Q4)*COS(Q6)-SIN(Q4
     &)*SIN(Q5)*SIN(Q6))*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*(SIN(Q
     &1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q
     &3)+SIN(Q2)*SIN(Q3)*COS(Q1)))+LBO*PYpp*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN
     &(Q5)*SIN(Q6))*(SIN(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-S
     &IN(Q1)*COS(Q2)*COS(Q4)*COS(Q5)-SIN(Q4)*COS(Q5)*(COS(Q1)*COS(Q3)-SI
     &N(Q1)*SIN(Q2)*SIN(Q3)))+LA**2*U1*U3+LA*LBO*SIN(Q4)*SIN(Q6)*COS(Q5)
     &**2*(U2**2+U3**2)+LA*LBO*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*U1*U3+LA*LBO*COS(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN
     &(Q4)*SIN(Q5)*SIN(Q6))*U1*U3+LBO**2*SIN(Q4)*COS(Q5)*(COS(Q5)*U1*Q5p
     &+SIN(Q4)*SIN(Q5)*U2*Q5p-(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SI
     &N(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)
     &)*U3)*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(
     &Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)-SIN(Q4)*COS(
     &Q5)*U3*Q4p-SIN(Q5)*COS(Q4)*U3*Q5p-COS(Q4)*COS(Q5)*U2*Q4p)+LA*LBO*(
     &SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(COS(Q5)*U1*Q5p+SIN(Q4)*S
     &IN(Q5)*U2*Q5p-(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(
     &Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)*(SIN
     &(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(C
     &OS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)-SIN(Q4)*COS(Q5)*U3*Q4p
     &-SIN(Q5)*COS(Q4)*U3*Q5p-COS(Q4)*COS(Q5)*U2*Q4p)-LA*PYpp*SIN(Q1)*CO
     &S(Q2)-LBO*PYpp*SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+S
     &IN(Q5)*SIN(Q6)*COS(Q4))+SIN(Q6)*COS(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*S
     &IN(Q2)*COS(Q3))-(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*(COS(Q4)
     &*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-LBO*PZpp*SIN(Q4)*COS(Q5)*(SIN(Q
     &6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q
     &2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(
     &Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-LA
     &*LBO*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(U2**2+U3**
     &2)-LA*LBO*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*((SIN(Q4)*COS(
     &Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)**2+(SIN(Q6)*COS(Q5)*U1-U5
     &-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN
     &(Q4)*SIN(Q5)*SIN(Q6))*U2)**2)-LA*LBO*COS(Q4)*COS(Q5)*((SIN(Q4)*COS
     &(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)*(U4+COS(Q5)*COS(Q6)*U1+(
     &SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q
     &5)*COS(Q4)*COS(Q6))*U3)+SIN(Q5)*SIN(Q6)*U1*Q5p-COS(Q5)*COS(Q6)*U1*
     &Q6p-U2*(SIN(Q4)*COS(Q6)*Q4p+SIN(Q6)*COS(Q4)*Q6p+SIN(Q4)*SIN(Q5)*CO
     &S(Q6)*Q6p+SIN(Q4)*SIN(Q6)*COS(Q5)*Q5p+SIN(Q5)*SIN(Q6)*COS(Q4)*Q4p)
     &-U3*(SIN(Q4)*SIN(Q6)*Q6p+SIN(Q4)*SIN(Q5)*SIN(Q6)*Q4p-COS(Q4)*COS(Q
     &6)*Q4p-SIN(Q5)*COS(Q4)*COS(Q6)*Q6p-SIN(Q6)*COS(Q4)*COS(Q5)*Q5p))-L
     &BO**2*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*((SIN(Q4)*COS(Q5)*
     &U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q
     &6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*CO
     &S(Q4)*COS(Q6))*U3)+SIN(Q5)*SIN(Q6)*U1*Q5p-COS(Q5)*COS(Q6)*U1*Q6p-U
     &2*(SIN(Q4)*COS(Q6)*Q4p+SIN(Q6)*COS(Q4)*Q6p+SIN(Q4)*SIN(Q5)*COS(Q6)
     &*Q6p+SIN(Q4)*SIN(Q6)*COS(Q5)*Q5p+SIN(Q5)*SIN(Q6)*COS(Q4)*Q4p)-U3*(
     &SIN(Q4)*SIN(Q6)*Q6p+SIN(Q4)*SIN(Q5)*SIN(Q6)*Q4p-COS(Q4)*COS(Q6)*Q4
     &p-SIN(Q5)*COS(Q4)*COS(Q6)*Q6p-SIN(Q6)*COS(Q4)*COS(Q5)*Q5p)))
      RHS(3) = BA*U3 + IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*(U5
     &*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-U6*(SIN(Q6)
     &*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q
     &4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)) + IZB*COS(Q4)*COS(Q5)*(U5
     &*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*
     &U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)+U4*(SIN(Q6)*COS(Q
     &5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS
     &(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)) + (SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(
     &Q6)*COS(Q4))*(IXB*U4*U6+IXB*SIN(Q5)*U1*U4+IXB*COS(Q4)*COS(Q5)*U3*U
     &4+IXB*COS(Q5)*COS(Q6)*U1*U6+IZB*SIN(Q4)*COS(Q5)*U2*U4+IXB*SIN(Q5)*
     &COS(Q5)*COS(Q6)*U1**2+IXB*COS(Q4)*COS(Q6)*COS(Q5)**2*U1*U3+IZB*SIN
     &(Q4)*COS(Q6)*COS(Q5)**2*U1*U2+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)
     &*COS(Q6))*U2*U6+IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U
     &6+IXB*SIN(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2+IXB*
     &SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3+IXB*COS(Q4
     &)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3+IZB*SIN(
     &Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2**2+IXB*CO
     &S(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2+IZB*
     &SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U2*U3-IZ
     &B*U4*U6-IZB*SIN(Q5)*U1*U4-IXB*SIN(Q4)*COS(Q5)*U2*U4-IZB*COS(Q4)*CO
     &S(Q5)*U3*U4-IZB*COS(Q5)*COS(Q6)*U1*U6-IZB*SIN(Q5)*COS(Q5)*COS(Q6)*
     &U1**2-IXB*SIN(Q4)*COS(Q6)*COS(Q5)**2*U1*U2-IZB*COS(Q4)*COS(Q6)*COS
     &(Q5)**2*U1*U3-IZB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6-
     &IZB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U6-IZB*SIN(Q5)*(S
     &IN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2-IZB*SIN(Q5)*(SIN(Q4)
     &*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3-IXB*SIN(Q4)*COS(Q5)*(SIN(Q
     &6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2**2-IZB*COS(Q4)*COS(Q5)*(SIN
     &(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3-IXB*SIN(Q4)*COS(Q5)*(S
     &IN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U2*U3-IZB*COS(Q4)*COS(Q5)*
     &(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2) - KA*(EQZ-Q3) - G
     &*LAO*MA*(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)) - G*MB*(LA*(SIN(
     &Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))-LBO*(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*(SIN(Q1)
     &*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q3)
     &+SIN(Q2)*SIN(Q3)*COS(Q1)))-LBO*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q5)*(S
     &IN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q2)*(SIN(Q4)*C
     &OS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*C
     &OS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))) - (IXA-IYA)*U1
     &*U2 - LAO*MA*(PXpp*SIN(Q3)*COS(Q2)-PZpp*(SIN(Q1)*COS(Q3)+SIN(Q2)*S
     &IN(Q3)*COS(Q1))-PYpp*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))-LAO
     &*U1*U2) - IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(U4*(SIN(Q
     &4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)+U6*(U4+COS(Q5)*COS
     &(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(
     &Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)) - (SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q
     &4)*COS(Q6))*(IYB*U5*U6+IYB*SIN(Q5)*U1*U5+IYB*COS(Q4)*COS(Q5)*U3*U5
     &+IZB*SIN(Q4)*COS(Q5)*U2*U5+IZB*SIN(Q6)*COS(Q5)*U1*U6+IZB*SIN(Q5)*S
     &IN(Q6)*COS(Q5)*U1**2+IYB*SIN(Q4)*SIN(Q6)*COS(Q5)**2*U1*U2+IZB*SIN(
     &Q6)*COS(Q4)*COS(Q5)**2*U1*U3+IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*
     &COS(Q4))*U3*U6+IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U6
     &+IYB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3+IYB*S
     &IN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2+IYB*COS(Q4)
     &*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3**2+IZB*SIN(Q
     &4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U2*U3+IYB*COS
     &(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3+IZB*S
     &IN(Q4)*COS(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2-IZB
     &*U5*U6-IZB*SIN(Q5)*U1*U5-IYB*SIN(Q4)*COS(Q5)*U2*U5-IYB*SIN(Q6)*COS
     &(Q5)*U1*U6-IZB*COS(Q4)*COS(Q5)*U3*U5-IYB*SIN(Q5)*SIN(Q6)*COS(Q5)*U
     &1**2-IYB*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3-IZB*SIN(Q4)*SIN(Q6)*COS(
     &Q5)**2*U1*U2-IZB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6-I
     &ZB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U6-IZB*SIN(Q5)*(SI
     &N(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3-IZB*SIN(Q5)*(COS(Q4)*
     &COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-IYB*SIN(Q4)*COS(Q5)*(SIN(Q4
     &)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U2*U3-IZB*COS(Q4)*COS(Q5)*(SIN(
     &Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3**2-IYB*SIN(Q4)*COS(Q5)*(CO
     &S(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2-IZB*COS(Q4)*COS(Q5)*(
     &COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3) - COS(Q4)*COS(Q5)*
     &(IXB*U4*U5+IXB*COS(Q5)*COS(Q6)*U1*U5+IYB*SIN(Q6)*COS(Q5)*U1*U4+IYB
     &*SIN(Q6)*COS(Q6)*COS(Q5)**2*U1**2+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN
     &(Q6)*COS(Q4))*U3*U4+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*
     &U2*U5+IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U5+IXB*(COS
     &(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U4+IXB*COS(Q5)*COS(Q6)*(S
     &IN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3+IYB*SIN(Q6)*COS(Q5)*
     &(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2+IXB*COS(Q5)*COS(Q6
     &)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2+IYB*SIN(Q6)*COS(
     &Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3+IXB*(SIN(Q4)*C
     &OS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*C
     &OS(Q6))*U2*U3+IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q
     &4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2+IXB*(SIN(Q6)*COS(Q4)+SIN
     &(Q4)*SIN(Q5)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2
     &**2+IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(Q6)
     &-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3-IYB*U4*U5-IXB*SIN(Q6)*COS(Q5)*U1*U
     &4-IYB*COS(Q5)*COS(Q6)*U1*U5-IXB*SIN(Q6)*COS(Q6)*COS(Q5)**2*U1**2-I
     &YB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4-IYB*(SIN(Q6)*CO
     &S(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U5-IYB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*
     &COS(Q4)*COS(Q6))*U3*U5-IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6
     &))*U2*U4-IXB*SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(
     &Q6))*U1*U2-IYB*COS(Q5)*COS(Q6)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*CO
     &S(Q4))*U1*U3-IXB*SIN(Q6)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*
     &COS(Q6))*U1*U3-IYB*COS(Q5)*COS(Q6)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5
     &)*SIN(Q6))*U1*U2-IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SI
     &N(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3-IYB*(SIN(Q4)*COS(Q6)+
     &SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))
     &*U3**2-IYB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2-IYB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*CO
     &S(Q4)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3) - 
     &MB*(LA*PXpp*SIN(Q3)*COS(Q2)+LBO*PXpp*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(
     &Q6)*COS(Q4))*(SIN(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*COS(Q2)*COS(Q3)+SIN(
     &Q3)*SIN(Q4)*COS(Q2)*COS(Q5))+LBO*PZpp*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN
     &(Q6)*COS(Q4))*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*(SIN(Q1)*SI
     &N(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q3)+SI
     &N(Q2)*SIN(Q3)*COS(Q1)))+LBO*PYpp*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*
     &COS(Q4))*(SIN(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-SIN(Q1
     &)*COS(Q2)*COS(Q4)*COS(Q5)-SIN(Q4)*COS(Q5)*(COS(Q1)*COS(Q3)-SIN(Q1)
     &*SIN(Q2)*SIN(Q3)))+LBO*PYpp*COS(Q4)*COS(Q5)*(SIN(Q1)*COS(Q2)*(SIN(
     &Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))+SIN(Q6)*COS(Q5)*(SIN(Q3)*COS(
     &Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(
     &Q3))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))+LBO*PZpp*COS(Q4)*C
     &OS(Q5)*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-
     &COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-(SIN(Q1)
     &*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)
     &*SIN(Q6)))+LA*LBO*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*((SIN(
     &Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)**2+(SIN(Q6)*COS(Q
     &5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS
     &(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)**2)-LA*PZpp*(SIN(Q1)*COS(Q3)+SIN
     &(Q2)*SIN(Q3)*COS(Q1))-LA*PYpp*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN
     &(Q3))-LBO*PXpp*COS(Q4)*COS(Q5)*(SIN(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*S
     &IN(Q6)*COS(Q4))-SIN(Q6)*COS(Q2)*COS(Q3)*COS(Q5)-SIN(Q3)*COS(Q2)*(C
     &OS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-LA**2*U1*U2-LA*LBO*SIN(Q6
     &)*COS(Q4)*COS(Q5)**2*(U2**2+U3**2)-LA*LBO*SIN(Q4)*COS(Q5)*(SIN(Q4)
     &*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U2-LA*LBO*SIN(Q5)*(SIN(Q4)*CO
     &S(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(U2**2+U3**2)-LA*LBO*COS(Q4)*COS(Q5
     &)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-LBO**2*COS(Q4)*C
     &OS(Q5)*(COS(Q5)*U1*Q5p+SIN(Q4)*SIN(Q5)*U2*Q5p-(U4+COS(Q5)*COS(Q6)*
     &U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-S
     &IN(Q5)*COS(Q4)*COS(Q6))*U3)*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6
     &)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN
     &(Q6))*U2)-SIN(Q4)*COS(Q5)*U3*Q4p-SIN(Q5)*COS(Q4)*U3*Q5p-COS(Q4)*CO
     &S(Q5)*U2*Q4p)-LA*LBO*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*(CO
     &S(Q5)*U1*Q5p+SIN(Q4)*SIN(Q5)*U2*Q5p-(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6
     &)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS
     &(Q4)*COS(Q6))*U3)*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*
     &SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)-
     &SIN(Q4)*COS(Q5)*U3*Q4p-SIN(Q5)*COS(Q4)*U3*Q5p-COS(Q4)*COS(Q5)*U2*Q
     &4p)-LA*LBO*SIN(Q4)*COS(Q5)*((SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(
     &Q4)*COS(Q5)*U3)*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SI
     &N(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)+SI
     &N(Q5)*SIN(Q6)*U1*Q5p-COS(Q5)*COS(Q6)*U1*Q6p-U2*(SIN(Q4)*COS(Q6)*Q4
     &p+SIN(Q6)*COS(Q4)*Q6p+SIN(Q4)*SIN(Q5)*COS(Q6)*Q6p+SIN(Q4)*SIN(Q6)*
     &COS(Q5)*Q5p+SIN(Q5)*SIN(Q6)*COS(Q4)*Q4p)-U3*(SIN(Q4)*SIN(Q6)*Q6p+S
     &IN(Q4)*SIN(Q5)*SIN(Q6)*Q4p-COS(Q4)*COS(Q6)*Q4p-SIN(Q5)*COS(Q4)*COS
     &(Q6)*Q6p-SIN(Q6)*COS(Q4)*COS(Q5)*Q5p))-LBO**2*(SIN(Q4)*COS(Q6)+SIN
     &(Q5)*SIN(Q6)*COS(Q4))*((SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*C
     &OS(Q5)*U3)*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)
     &*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)+SIN(Q5)
     &*SIN(Q6)*U1*Q5p-COS(Q5)*COS(Q6)*U1*Q6p-U2*(SIN(Q4)*COS(Q6)*Q4p+SIN
     &(Q6)*COS(Q4)*Q6p+SIN(Q4)*SIN(Q5)*COS(Q6)*Q6p+SIN(Q4)*SIN(Q6)*COS(Q
     &5)*Q5p+SIN(Q5)*SIN(Q6)*COS(Q4)*Q4p)-U3*(SIN(Q4)*SIN(Q6)*Q6p+SIN(Q4
     &)*SIN(Q5)*SIN(Q6)*Q4p-COS(Q4)*COS(Q6)*Q4p-SIN(Q5)*COS(Q4)*COS(Q6)*
     &Q6p-SIN(Q6)*COS(Q4)*COS(Q5)*Q5p)))
      RHS(4) = KB*Q4 + BB*U4 + IZB*U5*U6 + IZB*SIN(Q5)*U1*U5 + IYB*SIN(Q
     &4)*COS(Q5)*U2*U5 + IYB*SIN(Q6)*COS(Q5)*U1*U6 + IZB*COS(Q4)*COS(Q5)
     &*U3*U5 + IYB*SIN(Q5)*SIN(Q6)*COS(Q5)*U1**2 + IYB*SIN(Q6)*COS(Q4)*C
     &OS(Q5)**2*U1*U3 + IZB*SIN(Q4)*SIN(Q6)*COS(Q5)**2*U1*U2 + IZB*(SIN(
     &Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6 + IZB*(COS(Q4)*COS(Q6)-
     &SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U6 + IZB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U1*U3 + IZB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*
     &SIN(Q5)*SIN(Q6))*U1*U2 + IYB*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U2*U3 + IZB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+
     &SIN(Q5)*SIN(Q6)*COS(Q4))*U3**2 + IYB*SIN(Q4)*COS(Q5)*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2 + IZB*COS(Q4)*COS(Q5)*(COS(Q4)*
     &COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3 + IXB*(U5*(SIN(Q4)*COS(Q5)*
     &U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-U6*(SIN(Q6)*COS(Q5)*U1-U5-(SI
     &N(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)
     &*SIN(Q5)*SIN(Q6))*U2)) - IYB*U5*U6 - IYB*SIN(Q5)*U1*U5 - IYB*COS(Q
     &4)*COS(Q5)*U3*U5 - IZB*SIN(Q4)*COS(Q5)*U2*U5 - IZB*SIN(Q6)*COS(Q5)
     &*U1*U6 - IZB*SIN(Q5)*SIN(Q6)*COS(Q5)*U1**2 - IYB*SIN(Q4)*SIN(Q6)*C
     &OS(Q5)**2*U1*U2 - IZB*SIN(Q6)*COS(Q4)*COS(Q5)**2*U1*U3 - IYB*(SIN(
     &Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U6 - IYB*(COS(Q4)*COS(Q6)-
     &SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U6 - IYB*SIN(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U1*U3 - IYB*SIN(Q5)*(COS(Q4)*COS(Q6)-SIN(Q4)*
     &SIN(Q5)*SIN(Q6))*U1*U2 - IYB*COS(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U3**2 - IZB*SIN(Q4)*COS(Q5)*(SIN(Q4)*COS(Q6)+
     &SIN(Q5)*SIN(Q6)*COS(Q4))*U2*U3 - IYB*COS(Q4)*COS(Q5)*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3 - IZB*SIN(Q4)*COS(Q5)*(COS(Q4)*
     &COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2
      RHS(5) = KB*Q5 + G*LBO*MB*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)
     &*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1
     &)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))) + BB*U5 + IXB*U4*U6 + IXB*SIN(
     &Q5)*U1*U4 + IXB*COS(Q4)*COS(Q5)*U3*U4 + IXB*COS(Q5)*COS(Q6)*U1*U6 
     &+ IZB*SIN(Q4)*COS(Q5)*U2*U4 + IXB*SIN(Q5)*COS(Q5)*COS(Q6)*U1**2 + 
     &IXB*COS(Q4)*COS(Q6)*COS(Q5)**2*U1*U3 + IZB*SIN(Q4)*COS(Q6)*COS(Q5)
     &**2*U1*U2 + IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U6 + 
     &IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U6 + IXB*SIN(Q5)*
     &(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2 + IXB*SIN(Q5)*(SIN
     &(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3 + IXB*COS(Q4)*COS(Q5)*
     &(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3 + IZB*SIN(Q4)*COS(
     &Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2**2 + IXB*COS(Q4)*
     &COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2 + IZB*SIN(
     &Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U2*U3 - IZB*
     &U4*U6 - IZB*SIN(Q5)*U1*U4 - IXB*SIN(Q4)*COS(Q5)*U2*U4 - IZB*COS(Q4
     &)*COS(Q5)*U3*U4 - IZB*COS(Q5)*COS(Q6)*U1*U6 - IZB*SIN(Q5)*COS(Q5)*
     &COS(Q6)*U1**2 - IXB*SIN(Q4)*COS(Q6)*COS(Q5)**2*U1*U2 - IZB*COS(Q4)
     &*COS(Q6)*COS(Q5)**2*U1*U3 - IZB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*C
     &OS(Q6))*U2*U6 - IZB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U
     &6 - IZB*SIN(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2 - 
     &IZB*SIN(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3 - IXB*
     &SIN(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2**2 - 
     &IZB*COS(Q4)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U
     &3 - IXB*SIN(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*
     &U2*U3 - IZB*COS(Q4)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q
     &6))*U3**2 - IYB*(U4*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(
     &Q5)*U3)+U6*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)
     &*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)) - LBO*
     &MB*(PXpp*(SIN(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*COS(Q2)*COS(Q3)+SIN(Q3)*
     &SIN(Q4)*COS(Q2)*COS(Q5))+PZpp*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN
     &(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SI
     &N(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)))+PYpp*(SIN(Q5)*(SIN(Q3)*COS
     &(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-SIN(Q1)*COS(Q2)*COS(Q4)*COS(Q5)-SIN(
     &Q4)*COS(Q5)*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))+LA*COS(Q4)*
     &COS(Q5)*U1*U3-LA*SIN(Q4)*COS(Q5)*U1*U2-LA*SIN(Q5)*(U2**2+U3**2)-LB
     &O*((SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)*(U4+COS(Q
     &5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4
     &)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)+SIN(Q5)*SIN(Q6)*U1*Q5p-COS(
     &Q5)*COS(Q6)*U1*Q6p-U2*(SIN(Q4)*COS(Q6)*Q4p+SIN(Q6)*COS(Q4)*Q6p+SIN
     &(Q4)*SIN(Q5)*COS(Q6)*Q6p+SIN(Q4)*SIN(Q6)*COS(Q5)*Q5p+SIN(Q5)*SIN(Q
     &6)*COS(Q4)*Q4p)-U3*(SIN(Q4)*SIN(Q6)*Q6p+SIN(Q4)*SIN(Q5)*SIN(Q6)*Q4
     &p-COS(Q4)*COS(Q6)*Q4p-SIN(Q5)*COS(Q4)*COS(Q6)*Q6p-SIN(Q6)*COS(Q4)*
     &COS(Q5)*Q5p)))
      RHS(6) = KB*Q6 + G*LBO*MB*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2
     &)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6
     &)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))) + BB*U6 + IYB*U4*U5 + IXB*SIN(Q6)*CO
     &S(Q5)*U1*U4 + IYB*COS(Q5)*COS(Q6)*U1*U5 + IXB*SIN(Q6)*COS(Q6)*COS(
     &Q5)**2*U1**2 + IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4
     & + IYB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U5 + IYB*(SIN(
     &Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*U5 + IYB*(COS(Q4)*COS(Q6)-
     &SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U4 + IXB*SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(
     &Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U1*U2 + IYB*COS(Q5)*COS(Q6)*(SIN(Q4)*
     &COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U1*U3 + IXB*SIN(Q6)*COS(Q5)*(SIN(
     &Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U1*U3 + IYB*COS(Q5)*COS(Q6)*(
     &COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2 + IYB*(SIN(Q4)*COS(
     &Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(
     &Q6))*U2*U3 + IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q4
     &)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3**2 + IYB*(SIN(Q6)*COS(Q4)+SI
     &N(Q4)*SIN(Q5)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U
     &2**2 + IYB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*U3 + IZB*(U5*(U4+COS(Q5)*COS(Q6)*U
     &1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SI
     &N(Q5)*COS(Q4)*COS(Q6))*U3)+U4*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(
     &Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*S
     &IN(Q6))*U2)) - IXB*U4*U5 - IXB*COS(Q5)*COS(Q6)*U1*U5 - IYB*SIN(Q6)
     &*COS(Q5)*U1*U4 - IYB*SIN(Q6)*COS(Q6)*COS(Q5)**2*U1**2 - IXB*(SIN(Q
     &4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*U4 - IXB*(SIN(Q6)*COS(Q4)+S
     &IN(Q4)*SIN(Q5)*COS(Q6))*U2*U5 - IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q
     &4)*COS(Q6))*U3*U5 - IXB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*
     &U2*U4 - IXB*COS(Q5)*COS(Q6)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q
     &4))*U1*U3 - IYB*SIN(Q6)*COS(Q5)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*C
     &OS(Q6))*U1*U2 - IXB*COS(Q5)*COS(Q6)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q
     &5)*SIN(Q6))*U1*U2 - IYB*SIN(Q6)*COS(Q5)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*C
     &OS(Q4)*COS(Q6))*U1*U3 - IXB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q
     &4))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2*U3 - IXB*(SIN(Q4)
     &*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)
     &*COS(Q6))*U3**2 - IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(C
     &OS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2**2 - IXB*(SIN(Q4)*SIN(Q
     &6)-SIN(Q5)*COS(Q4)*COS(Q6))*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q
     &6))*U2*U3 - LBO*MB*(PYpp*(SIN(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)
     &*SIN(Q6)*COS(Q4))+SIN(Q6)*COS(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)
     &*COS(Q3))-(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*(COS(Q4)*COS(Q
     &6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))+PZpp*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3
     &)-SIN(Q2)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5
     &)*SIN(Q6)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(
     &Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-PXpp*(SIN(Q2)*(SIN(Q4)*COS(Q
     &6)+SIN(Q5)*SIN(Q6)*COS(Q4))-SIN(Q6)*COS(Q2)*COS(Q3)*COS(Q5)-SIN(Q3
     &)*COS(Q2)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))-LA*SIN(Q6)*CO
     &S(Q5)*(U2**2+U3**2)-LA*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U
     &1*U3-LA*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U1*U2-LBO*(COS(Q
     &5)*U1*Q5p+SIN(Q4)*SIN(Q5)*U2*Q5p-(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*C
     &OS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4
     &)*COS(Q6))*U3)*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN
     &(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)-SIN
     &(Q4)*COS(Q5)*U3*Q4p-SIN(Q5)*COS(Q4)*U3*Q5p-COS(Q4)*COS(Q5)*U2*Q4p)
     &)
      CALL SOLVE(6,COEF,RHS,VARp)

C**   Update variables after uncoupling equations
      U1p = VARp(1)
      U2p = VARp(2)
      U3p = VARp(3)
      U4p = VARp(4)
      U5p = VARp(5)
      U6p = VARp(6)

C**   Update derivative array prior to integration step
      VARp(1) = Q1p
      VARp(2) = Q2p
      VARp(3) = Q3p
      VARp(4) = Q4p
      VARp(5) = Q5p
      VARp(6) = Q6p
      VARp(7) = U1p
      VARp(8) = U2p
      VARp(9) = U3p
      VARp(10) = U4p
      VARp(11) = U5p
      VARp(12) = U6p

      RETURN
      END


C**********************************************************************
      SUBROUTINE       IO(T)
      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          ILOOP
      COMMON/CONSTNTS/ BA,BB,EQX,EQY,EQZ,G,IXA,IXB,IYA,IYB,IZA,IZB,KA,KB
     &,LA,LAO,LB,LBO,MA,MB
      COMMON/SPECFIED/ PX,PY,PZ,PXp,PYp,PZp,PXpp,PYpp,PZpp
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,U1,U2,U3,U4,U5,U6
      COMMON/ALGBRAIC/ Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,U1p,U2p,U3p,U4p,U5p,U6p,A
     &MOMX,AMOMY,AMOMZ,KE,P1X,P1Y,P1Z,P2X,P2Y,P2Z,P3X,P3Y,P3Z,PE,TE
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(6,6),RHS(6)

C**   Evaluate output quantities
      KE = 0.5D0*IXA*U1**2 + 0.5D0*IYA*U2**2 + 0.5D0*IZA*U3**2 + 0.5D0*I
     &ZB*SIN(Q4)*COS(Q5)*U2*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*CO
     &S(Q5)*U3) + 0.5D0*IXB*U4*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+S
     &IN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6
     &))*U3) + 0.5D0*IXB*COS(Q5)*COS(Q6)*U1*(U4+COS(Q5)*COS(Q6)*U1+(SIN(
     &Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*C
     &OS(Q4)*COS(Q6))*U3) + 0.5D0*IYB*SIN(Q6)*COS(Q5)*U1*(SIN(Q6)*COS(Q5
     &)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(
     &Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2) + 0.5D0*IXB*(SIN(Q6)*COS(Q4)+SIN(
     &Q4)*SIN(Q5)*COS(Q6))*U2*(U4+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SI
     &N(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6)
     &)*U3) + 0.5D0*IXB*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3*(U4
     &+COS(Q5)*COS(Q6)*U1+(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(
     &SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3) - 0.5D0*IZB*U6*(SIN(Q
     &4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3) - 0.5D0*IZB*SIN(Q5
     &)*U1*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3) - 0.5D0
     &*IZB*COS(Q4)*COS(Q5)*U3*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*
     &COS(Q5)*U3) - 0.5D0*IYB*U5*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)
     &+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(
     &Q6))*U2) - 0.5D0*IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3*
     &(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U
     &3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2) - 0.5D0*IYB*(COS(Q
     &4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2*(SIN(Q6)*COS(Q5)*U1-U5-(SIN
     &(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*
     &SIN(Q5)*SIN(Q6))*U2) - 0.5D0*MA*(2*LAO*PXp*SIN(Q2)*U2+2*LAO*PXp*SI
     &N(Q3)*COS(Q2)*U3+2*LAO*PZp*COS(Q1)*COS(Q2)*U2-PXp**2-PYp**2-PZp**2
     &-LAO**2*U2**2-LAO**2*U3**2-2*LAO*PYp*SIN(Q1)*COS(Q2)*U2-2*LAO*PZp*
     &(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*U3-2*LAO*PYp*(COS(Q1)*CO
     &S(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*U3) - 0.5D0*MB*(2*LA*PXp*SIN(Q2)*U2
     &+2*LA*PXp*SIN(Q3)*COS(Q2)*U3+2*LA*PZp*COS(Q1)*COS(Q2)*U2+2*LA*LBO*
     &(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U3*(SIN(Q4)*COS(Q5)*U2-U
     &6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)+2*LA*LBO*SIN(Q4)*COS(Q5)*U3*(SIN(
     &Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(CO
     &S(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)+2*LA*LBO*COS(Q4)*COS(Q5
     &)*U2*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q
     &4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)+2*LBO*PXp*(SI
     &N(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-SIN(Q6)*COS(Q2)*CO
     &S(Q3)*COS(Q5)-SIN(Q3)*COS(Q2)*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN
     &(Q6)))*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-PXp**
     &2-PYp**2-PZp**2-LA**2*U2**2-LA**2*U3**2-2*LA*PYp*SIN(Q1)*COS(Q2)*U
     &2-2*LA*PZp*(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*U3-2*LA*PYp*(
     &COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*U3-LBO**2*(SIN(Q4)*COS(Q5
     &)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)**2-2*LA*LBO*(SIN(Q4)*COS(Q6
     &)+SIN(Q5)*SIN(Q6)*COS(Q4))*U2*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-CO
     &S(Q4)*COS(Q5)*U3)-LBO**2*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+S
     &IN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6
     &))*U2)**2-2*LBO*PXp*(SIN(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*COS(Q2)*COS(Q
     &3)+SIN(Q3)*SIN(Q4)*COS(Q2)*COS(Q5))*(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4
     &)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN
     &(Q5)*SIN(Q6))*U2)-2*LBO*PYp*(SIN(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))+SIN(Q6)*COS(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(
     &Q2)*COS(Q3))-(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*(COS(Q4)*CO
     &S(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-
     &COS(Q4)*COS(Q5)*U3)-2*LBO*PZp*(COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN
     &(Q5)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SI
     &N(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1)))*(SIN(Q6)*COS(Q5)*U1-U5-(SI
     &N(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q4)
     &*SIN(Q5)*SIN(Q6))*U2)-2*LBO*PYp*(SIN(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*
     &SIN(Q2)*COS(Q3))-SIN(Q1)*COS(Q2)*COS(Q4)*COS(Q5)-SIN(Q4)*COS(Q5)*(
     &COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))*(SIN(Q6)*COS(Q5)*U1-U5-(
     &SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)-SIN(Q
     &4)*SIN(Q5)*SIN(Q6))*U2)-2*LBO*PZp*(SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3
     &)-SIN(Q2)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5
     &)*SIN(Q6)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(
     &Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q
     &5)*U1-COS(Q4)*COS(Q5)*U3))
      PE = -G*((MA+MB)*(LAO+LBO+PZ)+(LA*MB+LAO*MA)*(SIN(Q1)*SIN(Q3)-SIN(
     &Q2)*COS(Q1)*COS(Q3))+LBO*MB*(COS(Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(
     &Q5)*COS(Q4)*COS(Q6))+COS(Q5)*COS(Q6)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(
     &Q1)*COS(Q3))+(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(SIN(Q6)*CO
     &S(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))))
      TE = PE + KE
      AMOMX = LAO*MA*(PZp*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-PYp*
     &(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))) + MB*(LA*PZp*(SIN(Q3)*C
     &OS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-LA*PYp*(SIN(Q1)*SIN(Q3)-SIN(Q2)*CO
     &S(Q1)*COS(Q3))-LBO*PYp*(COS(Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*C
     &OS(Q4)*COS(Q6))+COS(Q5)*COS(Q6)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*C
     &OS(Q3))+(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(SIN(Q6)*COS(Q4)
     &+SIN(Q4)*SIN(Q5)*COS(Q6)))-LBO*PZp*(SIN(Q1)*COS(Q2)*(SIN(Q4)*SIN(Q
     &6)-SIN(Q5)*COS(Q4)*COS(Q6))-COS(Q5)*COS(Q6)*(SIN(Q3)*COS(Q1)+SIN(Q
     &1)*SIN(Q2)*COS(Q3))-(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(COS
     &(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))) + SIN(Q2)*(IZA+MA*LAO**2+L
     &A*MB*(LA+LBO*COS(Q5)*COS(Q6)))*U3 + COS(Q2)*COS(Q3)*(IXA*U1-LA*LBO
     &*MB*((SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)
     &-SIN(Q5)*COS(Q4)*COS(Q6))*U3)) + (SIN(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*
     &COS(Q2)*COS(Q3)+SIN(Q3)*SIN(Q4)*COS(Q2)*COS(Q5))*(IZB*U6+IZB*SIN(Q
     &5)*U1+IZB*COS(Q4)*COS(Q5)*U3-IZB*SIN(Q4)*COS(Q5)*U2-LBO*MB*(LBO+LA
     &*COS(Q5)*COS(Q6))*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5
     &)*U3)) + (SIN(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))-SIN(Q6
     &)*COS(Q2)*COS(Q3)*COS(Q5)-SIN(Q3)*COS(Q2)*(COS(Q4)*COS(Q6)-SIN(Q4)
     &*SIN(Q5)*SIN(Q6)))*(IYB*U5+IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*CO
     &S(Q4))*U3+IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2-IYB*SIN
     &(Q6)*COS(Q5)*U1-LBO*MB*(LBO+LA*COS(Q5)*COS(Q6))*(SIN(Q6)*COS(Q5)*U
     &1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS(Q6)
     &-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)) + (COS(Q2)*COS(Q3)*COS(Q5)*COS(Q6)+
     &SIN(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))-SIN(Q3)*COS(Q2)*
     &(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6)))*(IXB*U4+IXB*COS(Q5)*COS
     &(Q6)*U1+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+IXB*(SIN(
     &Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3+LA*LBO*MB*(SIN(Q5)*(SIN(Q4
     &)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-SIN(Q6)*COS(Q5)*(SI
     &N(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(
     &COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2))) - SIN(Q3)*COS(Q2)*(
     &IYA+MA*LAO**2+LA*MB*(LA+LBO*COS(Q5)*COS(Q6)))*U2
      AMOMY = (COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*(IYA+MA*LAO**2+L
     &A*MB*(LA+LBO*COS(Q5)*COS(Q6)))*U2 + (SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q
     &2)*COS(Q3))*(IXA*U1-LA*LBO*MB*((SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*CO
     &S(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3)) + (SIN(Q5
     &)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-SIN(Q1)*COS(Q2)*COS(Q4
     &)*COS(Q5)-SIN(Q4)*COS(Q5)*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)
     &))*(IZB*U6+IZB*SIN(Q5)*U1+IZB*COS(Q4)*COS(Q5)*U3-IZB*SIN(Q4)*COS(Q
     &5)*U2-LBO*MB*(LBO+LA*COS(Q5)*COS(Q6))*(SIN(Q4)*COS(Q5)*U2-U6-SIN(Q
     &5)*U1-COS(Q4)*COS(Q5)*U3)) - LAO*MA*(PZp*COS(Q2)*COS(Q3)-PXp*(SIN(
     &Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))) - MB*(LA*PZp*COS(Q2)*COS(Q3)
     &+LBO*PZp*(COS(Q2)*COS(Q3)*COS(Q5)*COS(Q6)+SIN(Q2)*(SIN(Q4)*SIN(Q6)
     &-SIN(Q5)*COS(Q4)*COS(Q6))-SIN(Q3)*COS(Q2)*(SIN(Q6)*COS(Q4)+SIN(Q4)
     &*SIN(Q5)*COS(Q6)))-LA*PXp*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3)
     &)-LBO*PXp*(COS(Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6
     &))+COS(Q5)*COS(Q6)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))+(SIN(
     &Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(
     &Q5)*COS(Q6)))) - SIN(Q1)*COS(Q2)*(IZA+MA*LAO**2+LA*MB*(LA+LBO*COS(
     &Q5)*COS(Q6)))*U3 - (SIN(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q
     &6)*COS(Q4))+SIN(Q6)*COS(Q5)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q
     &3))-(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3))*(COS(Q4)*COS(Q6)-SIN
     &(Q4)*SIN(Q5)*SIN(Q6)))*(IYB*U5+IYB*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6
     &)*COS(Q4))*U3+IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2-IYB
     &*SIN(Q6)*COS(Q5)*U1-LBO*MB*(LBO+LA*COS(Q5)*COS(Q6))*(SIN(Q6)*COS(Q
     &5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(COS(Q4)*COS
     &(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)) - (SIN(Q1)*COS(Q2)*(SIN(Q4)*SIN
     &(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))-COS(Q5)*COS(Q6)*(SIN(Q3)*COS(Q1)+SIN
     &(Q1)*SIN(Q2)*COS(Q3))-(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(C
     &OS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))*(IXB*U4+IXB*COS(Q5)*COS(Q
     &6)*U1+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+IXB*(SIN(Q4
     &)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3+LA*LBO*MB*(SIN(Q5)*(SIN(Q4)*
     &COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-SIN(Q6)*COS(Q5)*(SIN(
     &Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(CO
     &S(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2)))
      AMOMZ = LAO*MA*(PYp*COS(Q2)*COS(Q3)-PXp*(SIN(Q3)*COS(Q1)+SIN(Q1)*S
     &IN(Q2)*COS(Q3))) + COS(Q1)*COS(Q2)*(IZA+MA*LAO**2+LA*MB*(LA+LBO*CO
     &S(Q5)*COS(Q6)))*U3 + (SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(IY
     &A+MA*LAO**2+LA*MB*(LA+LBO*COS(Q5)*COS(Q6)))*U2 + (SIN(Q1)*SIN(Q3)-
     &SIN(Q2)*COS(Q1)*COS(Q3))*(IXA*U1-LA*LBO*MB*((SIN(Q6)*COS(Q4)+SIN(Q
     &4)*SIN(Q5)*COS(Q6))*U2+(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U
     &3)) + (COS(Q1)*COS(Q2)*COS(Q4)*COS(Q5)+SIN(Q5)*(SIN(Q1)*SIN(Q3)-SI
     &N(Q2)*COS(Q1)*COS(Q3))-SIN(Q4)*COS(Q5)*(SIN(Q1)*COS(Q3)+SIN(Q2)*SI
     &N(Q3)*COS(Q1)))*(IZB*U6+IZB*SIN(Q5)*U1+IZB*COS(Q4)*COS(Q5)*U3-IZB*
     &SIN(Q4)*COS(Q5)*U2-LBO*MB*(LBO+LA*COS(Q5)*COS(Q6))*(SIN(Q4)*COS(Q5
     &)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)) + (COS(Q1)*COS(Q2)*(SIN(Q4
     &)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))+COS(Q5)*COS(Q6)*(SIN(Q1)*SIN(Q3
     &)-SIN(Q2)*COS(Q1)*COS(Q3))+(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1
     &))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6)))*(IXB*U4+IXB*COS(Q5)*
     &COS(Q6)*U1+IXB*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*U2+IXB*(S
     &IN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))*U3+LA*LBO*MB*(SIN(Q5)*(SIN
     &(Q4)*COS(Q5)*U2-U6-SIN(Q5)*U1-COS(Q4)*COS(Q5)*U3)-SIN(Q6)*COS(Q5)*
     &(SIN(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U
     &3-(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2))) - MB*(LA*PXp*(SI
     &N(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-LA*PYp*COS(Q2)*COS(Q3)-LBO*
     &PYp*(COS(Q2)*COS(Q3)*COS(Q5)*COS(Q6)+SIN(Q2)*(SIN(Q4)*SIN(Q6)-SIN(
     &Q5)*COS(Q4)*COS(Q6))-SIN(Q3)*COS(Q2)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(
     &Q5)*COS(Q6)))-LBO*PXp*(SIN(Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*CO
     &S(Q4)*COS(Q6))-COS(Q5)*COS(Q6)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*CO
     &S(Q3))-(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6))*(COS(Q1)*COS(Q3)-
     &SIN(Q1)*SIN(Q2)*SIN(Q3)))) - (SIN(Q6)*COS(Q5)*(SIN(Q1)*SIN(Q3)-SIN
     &(Q2)*COS(Q1)*COS(Q3))-COS(Q1)*COS(Q2)*(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN
     &(Q6)*COS(Q4))-(SIN(Q1)*COS(Q3)+SIN(Q2)*SIN(Q3)*COS(Q1))*(COS(Q4)*C
     &OS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6)))*(IYB*U5+IYB*(SIN(Q4)*COS(Q6)+SIN(
     &Q5)*SIN(Q6)*COS(Q4))*U3+IYB*(COS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q
     &6))*U2-IYB*SIN(Q6)*COS(Q5)*U1-LBO*MB*(LBO+LA*COS(Q5)*COS(Q6))*(SIN
     &(Q6)*COS(Q5)*U1-U5-(SIN(Q4)*COS(Q6)+SIN(Q5)*SIN(Q6)*COS(Q4))*U3-(C
     &OS(Q4)*COS(Q6)-SIN(Q4)*SIN(Q5)*SIN(Q6))*U2))
      P1X = PX
      P1Y = PY
      P1Z = PZ
      P2X = PX + LA*COS(Q2)*COS(Q3)
      P2Y = PY + LA*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))
      P2Z = PZ + LA*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))
      P3X = PX + LA*COS(Q2)*COS(Q3) + LB*(COS(Q2)*COS(Q3)*COS(Q5)*COS(Q6
     &)+SIN(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))-SIN(Q3)*COS(Q2
     &)*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6)))
      P3Y = PY + LA*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3)) - LB*(SIN(
     &Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))-COS(Q5)*COS(
     &Q6)*(SIN(Q3)*COS(Q1)+SIN(Q1)*SIN(Q2)*COS(Q3))-(SIN(Q6)*COS(Q4)+SIN
     &(Q4)*SIN(Q5)*COS(Q6))*(COS(Q1)*COS(Q3)-SIN(Q1)*SIN(Q2)*SIN(Q3)))
      P3Z = PZ + LA*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3)) + LB*(COS(
     &Q1)*COS(Q2)*(SIN(Q4)*SIN(Q6)-SIN(Q5)*COS(Q4)*COS(Q6))+COS(Q5)*COS(
     &Q6)*(SIN(Q1)*SIN(Q3)-SIN(Q2)*COS(Q1)*COS(Q3))+(SIN(Q1)*COS(Q3)+SIN
     &(Q2)*SIN(Q3)*COS(Q1))*(SIN(Q6)*COS(Q4)+SIN(Q4)*SIN(Q5)*COS(Q6)))

C**   Write output to screen and to output file(s)
      WRITE(*, 6020) T,P1X,P1Y,P1Z,P2X,P2Y,P2Z,P3X,P3Y,P3Z
      WRITE(21,6020) T,P1X,P1Y,P1Z,P2X,P2Y,P2Z,P3X,P3Y,P3Z
      WRITE(22,6020) T,KE,PE,TE,AMOMX,AMOMY,AMOMZ

6020  FORMAT( 99(1X, 1PE14.6E3) )

      RETURN
      END


